/*!
 * Alopex Grid v3.10.11
 * http://grid.alopex.io
 *
 * Copyright (c) 2015-2016 SK Holdings Co., Ltd. All rights reserved.
 * 
 * This software is the confidential and proprietary information of SK Holdings.
 * You shall not disclose such confidential information and shall use it only in
 * accordance with the terms of the license agreement you entered into with SK Holdings.
 *
 * Date : 2017-01-19 17:34:43 GMT+0900 (KST)
 */
+function(e){function t(){}function a(e,t){t=" "+t+" ";var a=e.children;return function(){for(var e=[],n=0,r=a.length;n<r;n++)(" "+a[n].className+" ").indexOf(t)>=0&&e.push(a[n]);return e}}function n(e){return this.el=e,this.getPropertyValue=function(t){var a=/(\-([a-z]){1})/g;return"float"==t&&(t="styleFloat"),a.test(t)&&(t=t.replace(a,function(){return arguments[2].toUpperCase()})),e.currentStyle[t]?e.currentStyle[t]:null},this}function r(e){var t,a=0;for(t in e)e.hasOwnProperty(t)&&a++;return a}function o(){return wt+Mt++}function l(){return Mt++}function i(){if(window.getSelection){if(window.getSelection().empty)try{window.getSelection().empty()}catch(e){}else if(window.getSelection().removeAllRanges)try{window.getSelection().removeAllRanges()}catch(e){}}else if(document.selection&&document.selection.empty)try{document.selection.empty()}catch(e){}}function d(e){return!(!e||"object"!=typeof e||Object.prototype.toString.call(e)!==St)}function s(e){return"function"==typeof e}function p(e){return s(e)?e():e}function u(e){return!(null===e||void 0===e)}function c(e,t){return e<t?e:t}function g(e,t){return e>t?e:t}function f(e){var t=e.toString().replace(Et,""),a=t.slice(t.indexOf("(")+1,t.indexOf(")")).match(Tt);return null===a&&(a=[]),a}function h(e){for(var t=String,a=t.fromCharCode,n=isNaN,r="",o="",l=Math,i=0,d=e?e.length:-1;i<d;i++)n(bt(e[i],16))?(r+=a.call(t,bt(o,l.pow(4,2))>>1),o=""):o+=e[i];return r?r:null}function m(e){return h(e)}function v(){return" "}function x(){return h("d0xdeje6me8zdcmc2tdazcar")}function y(){return m()||0}function C(){return h()||null}function I(){return m()||""}function _(){return h()||""}function w(e){if(y()&&Dt.now()>=bt(y(),16))return e||Rt?null:Rt=setTimeout(I(),10),!1;var t=null,a=!1;if(t=C()){for(t=t.split(v());t.length;){var n=t.pop();vt.prop(h("d8vdehc6wc2ke8wd2mdexdcy"))[x()].indexOf(n)>=0&&(a=v)}if(!a)return e||Ft?null:Ft=setTimeout(_(),10),!1}return!0}function b(e,t,a){for(var n=a.split("."),r=n.pop(),o=n.shift(),l=e,i=t;o;){if(!i[o])return;l[o]||(l[o]={}),l=l[o],i=i[o],o=n.shift()}i.hasOwnProperty(r)&&(l[r]=i[r])}function M(e){if(e)for(var t in kt.__compatOldOptionMap){if(!kt.__compatOldOptionMap.hasOwnProperty(t))return;var a=kt.__compatOldOptionMap[t],n=a.moduleName,r=a.compatMap,o=r[2],l=a.newOptionName,i=o?o(e[t]):e[t];e.hasOwnProperty(t)&&(e[n]?e[n].hasOwnProperty(l)||(e[n][l]=i):(e[n]={},e[n][l]=i))}}function S(t,a){M(t),M(a);var n=e.extend(!0,{},t,a);if(d(a))for(var r=["headerGroup","columnMapping","footer.footerMapping","grouping.by","filterTypeList","filter.typeList","instantInlineEditType","defaultContextMenu","contextMenu","paging.pagerSelect","grouping.useGroupHeader","grouping.useGroupFooter","hiddenColumnOrderList","trimUnmappedKey"],o=0;o<r.length;o++)b(n,a,r[o]);return n}function E(t,a){var n={};if(d(a)){if(a.extend)for(var r=e.isArray(a.extend)?a.extend:[a.extend],o=0,l=r.length;o<l;o++){var i=kt.commonOption.definition[r[o]];d(i)&&(n=S(n,i))}n=S(n,a)}return t.state.loaded&&t.option||(t.option=S(kt.defaultOption,kt.commonOption)),e.isEmptyObject(n)||(t.option=S(t.option,n)),t.option}function T(e,t){var a=kt.defaultOption.optionMergeLegacyMode;return kt.commonOption.hasOwnProperty("optionMergeLegacyMode")&&(a=kt.commonOption.optionMergeLegacyMode),t&&"object"==typeof t&&t.hasOwnProperty("optionMergeLegacyMode")&&(a=t.optionMergeLegacyMode),a}function D(e){return Pt[e]||e}function R(e){return String(e).replace(/[&<>"'\s\u00A0]/g,D)}function F(e,t){return s(e[t])?e[t](e):e[t]}function L(e,t){var a=t.getAttribute("data-alopexgrid-dataid"),n=t.getAttribute("data-alopexgrid-columnindex"),r=t.getAttribute("data-alopexgrid-columndepth");if(t&&t.children&&t.children.length)for(var o=0,l=t.children.length;o<l;o++)t.children[o]&&t.children[o].setAttribute&&t.children[o].setAttribute("data-alopexgrid-inscribe",e.key+","+a+","+n+","+r)}function A(e,t,a,n){var r=document.createDocumentFragment();a&&r.appendChild(t);var o=n?n:document.createElement("div");for(n||kt.renderUtil.setElementContent(o,e);o.firstChild;)r.appendChild(o.firstChild);return a||r.appendChild(t),r}function O(e){var t=0;if(e&&"object"==typeof e)for(var a in e)e.hasOwnProperty(a)&&t++;return t}function O(e){return Object.keys(e).length}function P(e,t,a,n){var r=t.member[0],o=a.member[0],l=e._getGroupingRange(r._index.data,n),i=e._getGroupingRange(o._index.data,n);return!(!l||!i||l.id!=i.id)}function B(e){return 0===e.state.renderFromRenderedIndex}function G(e){return e.state.renderFromColumnIndex===e.state.visibleColumnMappingList[0].columnIndex}function H(t,a){window.__AlopexGridOrgTempAlert__||(window.__AlopexGridOrgTempAlert__=window.alert),window.__AlopexGridOrgTempConfirm__||(window.__AlopexGridOrgTempConfirm__=window.confirm),window.alert=function(){var n=e.makeArray(arguments);t?t():0;var r=null;return r=It?Function.prototype.apply.call(window.__AlopexGridOrgTempAlert__,window,n):window.__AlopexGridOrgTempAlert__.apply(window,n),a?a():0,r},window.confirm=function(){var n=e.makeArray(arguments);t?t():0;var r=null;return r=It?Function.prototype.apply.call(window.__AlopexGridOrgTempConfirm__,window,n):window.__AlopexGridOrgTempConfirm__.apply(window,n),a?a():0,r}}function N(e,t){window.__AlopexGridOrgTempAlert__&&(window.alert=window.__AlopexGridOrgTempAlert__),window.__AlopexGridOrgTempConfirm__&&(window.confirm=window.__AlopexGridOrgTempConfirm__),delete window.__AlopexGridOrgTempAlert__,delete window.__AlopexGridOrgTempConfirm__}function $(t,a,n,r,o){var l=e.inArray(n,t.state.hiddenColumnIdxArr);null!=l&&l!==-1&&(r[l]=a.columnIndex,o[a.columnIndex]=a)}function W(t,a,n){for(var r=0;r<a.length;r++){var o=a[r];if(null!=o){var l=t.state.hiddenColumnIdxArr[r];delete t.state.hiddenColumnIndexToMapping[l],t.option.hiddenColumnOrderList[r]=o,t.state.hiddenColumnIdxArr[r]=o}}t.state.hiddenColumnIndexToMapping=e.extend(t.state.hiddenColumnIndexToMapping,n)}function K(e){var t=e;"touchmove"===e.type&&(t=e.originalEvent.touches[0]);var a=e.data.$bar;e.data.moveDiff=t.pageY-e.data.startPageY,It?a.css("top",e.data.startTop+e.data.moveDiff+"px"):a.css("transform","translateY("+(e.data.startTop+e.data.moveDiff)+"px)"),e.preventDefault(),i()}function U(e){var t=e.data.self;xt.off(e.data.rowResizeEventNS+t.key+t.eventns),e.data.$pos&&e.data.$pos.remove(),e.data.$bar&&e.data.$bar.remove();var a=e.data.moveDiff,n=Math.round(Math.max(3,e.data.prevHeight+a));a&&(t.state.scrollyEnd=!1,e.data.self.state.rowHeightMapByDataId[e.data.dataId]=n,e.data.self.redraw()),t._triggerGridEvent("UIRowResizeEnd",{row:e.data.rowIndex,height:n})}function Y(e){var t=e;if("touchmove"===e.type&&(t=e.originalEvent.touches[0]),e.data.self.state.resizing){var a=t.pageX-e.data.prevX;e.data.prevX=t.pageX,e.data.totalMoveAmount=e.data.totalMoveAmount+a,e.data.bar.style.left=parseInt(e.data.bar.style.left)+a+"px",e.preventDefault(),i()}}function V(e){var t=e.data.self,a=e.data.totalMoveAmount,n=Math.round(parseInt(t.state.columnIndexToMapping[e.data.columnIndex].width,10)+a);n<10&&(n=10),t.state.resizing=!1,e.data.bar.style.display="none",t.state.columnIndexToMapping[e.data.columnIndex].width=n;var r=null,o=null;if(t.state.headerSelection&&t.state.headerSelection.from<=e.data.columnIndex&&e.data.columnIndex<=t.state.headerSelection.to){r=t.state.headerSelection.from,o=t.state.headerSelection.to;for(var l=r;l<=o;l++){var i=t.state.columnIndexToMapping[l];i&&(i.width=n)}}if(t.option.fitTableWidth&&!t.state.fitTableWidthFixed){var d=t.state.columnIndexToMapping[e.data.columnIndex];if(n=Math.round(parseInt(t.state.columnFitWidthById[d.id],10)+a),t.state.columnFitWidthById[d.id]=n,null!=r&&null!=o)for(var l=r;l<=o;l++){var i=t.state.columnIndexToMapping[l];i&&(t.state.columnFitWidthById[i.id]=n)}for(var s=0,p=t.state.visibleColumnMappingList.length;s<p;s++){var i=t.state.visibleColumnMappingList[s];i&&t.state.columnFitWidthById.hasOwnProperty(i.id)&&(i.width=t.state.columnFitWidthById[i.id])}t.state.fitTableWidthFixed=!0}e.data.totalMoveAmount>0&&(t.state.scrollxEnd=!1),xt.off(e.data.columnResizeEventNS+t.eventns+t.key),t.$wrapper[0].removeChild(e.data.bar),t.redraw(),t._triggerGridEvent("UIColumnResizeEnd",{mapping:e.data.mapping,width:parseInt(e.data.mapping.width),fitWidth:t.state.columnFitWidthById[e.data.mapping.id]})}function X(e,t,a,r){function o(e,t){var a=document.createElement("span");return a.style.cssText=f,a.textContent=x.substring(e,t),C.appendChild(a),a}function l(){var t=document.body,a=document.defaultView,n=document.documentElement,r=document.createElement("div");r.style.paddingLeft=r.style.width="1px",t.appendChild(r);var o=2==r.offsetWidth;t.removeChild(r),r=e.getBoundingClientRect();var l=n.clientTop||t.clientTop||0,i=n.clientLeft||t.clientLeft||0,d=a.pageYOffset||o&&n.scrollTop||t.scrollTop,s=a.pageXOffset||o&&n.scrollLeft||t.scrollLeft;return{top:r.top+d-l,left:r.left+s-i}}function i(t,a){if(It)var r=n(e,null).getPropertyValue(t);else var r=document.defaultView.getComputedStyle(e,null).getPropertyValue(t);return a?parseFloat(r):r}if(!(e&&"value"in e))return e;if("string"==typeof t&&(t=parseFloat(t)),("number"!=typeof t||isNaN(t))&&(t=0),t=t<0?0:Math.min(e.value.length,t),"string"==typeof a&&(a=parseFloat(a)),("number"!=typeof a||isNaN(a)||a<t)&&(a=t),a=a<0?0:Math.min(e.value.length,a),"function"==typeof e.createTextRange){var d=e.createTextRange();return d.collapse(!0),d.moveStart("character",t),d.moveEnd("character",a-t),d.getBoundingClientRect()}var s=l(),p=s.top,u=s.left,c=i("width",!0),g=i("height",!0),f="white-space:pre;padding:0;margin:0;",h=["direction","font-family","font-size","font-size-adjust","font-variant","font-weight","font-style","letter-spacing","line-height","text-align","text-indent","text-transform","word-wrap","word-spacing"];p+=i("padding-top",!0),p+=i("border-top-width",!0),u+=i("padding-left",!0),u+=i("border-left-width",!0),u+=1;for(var m=0;m<h.length;m++){var v=h[m];f+=v+":"+i(v)+";"}var x=e.value,y=x.length,C=document.createElement("div");t>0&&o(0,t);var I=o(t,a);y>a&&o(a,y),C.style.cssText=f,C.style.position="absolute",C.style.top=p+"px",C.style.left=u+"px",C.style.width=c+"px",C.style.height=g+"px",document.body.appendChild(C);var _=I.getBoundingClientRect();return r||C.parentNode.removeChild(C),_}function z(e,t,a){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,null!=a?a:t);else if(e.createTextRange){var n=e.createTextRange();n.collapse(!0),n.moveEnd("character",null!=a?a:t),n.moveStart("character",t),n.select()}}function j(e){var t=0;if(document.selection){e.focus();var a=document.selection.createRange();a.moveStart("character",-e.value.length),t=a.text.length}else(e.selectionStart||"0"==e.selectionStart)&&(t=e.selectionStart);return t}function q(t,a){if(e.contains(document.documentElement,t))if("undefined"!=typeof window.getSelection&&"undefined"!=typeof document.createRange){var n=document.createRange();n.selectNodeContents(t),a?null:n.collapse(!1);var r=window.getSelection();try{r.removeAllRanges()}catch(e){}r.addRange(n)}else if("undefined"!=typeof document.body.createTextRange){var o=document.body.createTextRange();o.moveToElementText(t),a?null:o.collapse(!1),o.select()}}function Z(e,t,a){return Math.floor(Math.sqrt(Math.pow(t-(e.offset().left+e.width()/2),2)+Math.pow(a-(e.offset().top+e.height()/2),2)))}function Q(e,t){return e.state.columnIndexToMapping[t]||null}function J(e,t){return e.state.columnIndexToKeyMap[t]}function ee(e,t){var a=t.columnIndex,n=document.createElement("div");return n.setAttribute("class","header-dragdrop-handle"),n.setAttribute("data-alopexgrid-dragdropcolumnindex",a),n.setAttribute("onmousedown",ut+".run('"+e.key+"','_headerDragStart',event,"+a+");"),n.setAttribute("ontouchstart",ut+".run('"+e.key+"','_headerDragStart',event,"+a+");"),n}function te(e){var t=document.createElement("div");return t.setAttribute("class","sorting-handle alopexgrid-handle"),t}function ae(e,t){var a=t.columnIndex,n=document.createElement("div");return n.setAttribute("class","column-resizing-handle resizing-handle alopexgrid-handle"),n.setAttribute("data-alopexgrid-resizingcolumnindex",a),n.setAttribute("onmousedown",ut+".run('"+e.key+"','_columnResizeStart',event,"+a+");"),n.setAttribute("ontouchstart",ut+".run('"+e.key+"','_columnResizeStart',event,"+a+");"),n}function ne(e,t){var a=t.key,n=t.wrapId,r=t.filteredTypeTop,o=t.filteredTypeBottom,l=t.filteredValueTop,i=t.filteredValueBottom,d=t.filterRule,s=t.filterGridId,p=t.columnIndex,u=t.isApiCall,c=t.columnInfo,g=t.mergedFilterOption,f=[];if(f.push('<ul class="alopexgrid-filterdropdown">'),null!=g.title&&g.title!==!1){var h="";if("string"==typeof g.title?h=g.title.replace(/<br>/g,""):"function"==typeof g.title?h=g.title.call(e,c):null!=c.title&&g.title===!0&&("string"==typeof c.title?h=c.title.replace(/<br>/g,""):"function"==typeof c.title&&(h=c.title.call(e,c))),g.movable===!0){var m=[ut+".run('",e.key,"','_filterWrapDragStart',event,'"+p+"','"+n+"');"].join("");f.push('<li class="title movable" onmousedown="',m,'" ontouchstart="',m,'">'+h+"</li>")}else f.push('<li class="title">'+h+"</li>")}var v=[ut+".run('",e.key,"','_parseFilterHeader',event,'"+s+"','"+p+"','"+u+"','true');"].join("");f.push('<li class="header">'+kt.i18n("filterHeader")+"</li>"),f.push('<li class="menu remove" data-alopexgrid-key="'+a+'" value="remove" onmousedown="',v,'">'+kt.i18n("removeFilter")+"</li>"),f.push('<li class="header">'+kt.i18n("textFilterHeader")+"</li>");var x=[ut+".run('",e.key,"','_parseFilterHeader',event,'"+s+"','"+p+"','"+u+"');"].join("");f.push('<li class="menu"><input type="text" class="filtertext" name="alopexgrid-filter-textinput" value="'+l+'"/>    <select class="filterselect" onchange="',x,'" data-alopexgrid-key="'+a+'">'),f.push('<option value="" selected="selected">'+kt.i18n("selectItem")+"</option>"),re(f,e,r,a,g),f.push("</select>");var y="",C="";null!=o&&""!==o||(y='style="display:none;"',C="folded");var I=[ut+".run('",e.key,"','_filterTextFoldingEvent', event, '"+p+"');"].join("");if(f.push('<button class="textfolding-icon '+C+'" onkeydown="',I,'" onmousedown="',I,'"></button>'),f.push("</li>"),""===d||"and"===d)var _="checked",w="";else var w="checked",_="";return f.push('<li id="'+e.key+'_filterTextRadioArea" class="menu" '+y+">"),f.push('<label class="alopexgrid-input-wrapper alopexgrid-input-radio-wrapper '+_+'"><input id="alopexgrid_andradio" class="filter-radio" type="radio" name="alopexgridfilterradio" data-alopexgrid-key="'+a+'" value="and" onchange="',x,'" '+_+"> "+kt.i18n("textFilterAnd")+"</label>"),f.push('  <label class="alopexgrid-input-wrapper alopexgrid-input-radio-wrapper '+w+'"><input id="alopexgrid_orradio" class="filter-radio" type="radio" name="alopexgridfilterradio" data-alopexgrid-key="'+a+'" value="or" onchange="',x,'" '+w+"> "+kt.i18n("textFilterOr")+"</label></li>"),f.push('<li id="'+e.key+'_filterTextSelectArea" class="menu" '+y+'><input type="text" class="filtertextbottom" name="alopexgrid-filter-textinput" value="'+i+'"/>    <select class="filterselectbottom" onchange="',x,'" data-alopexgrid-key="'+a+'">'),f.push('<option value="" selected="selected">'+kt.i18n("selectItem")+"</option>"),re(f,e,o,a,g),f.push("</select></li>"),f.push('<li class="header">'+kt.i18n("dataFilterHeader")+"</li>"),f.push("</ul>"),f.join("")}function re(e,t,a,n,r){for(var o="",l=0;l<r.typeList.length;l++)o=r.typeList[l],e.push("<option "),e.push(' value="',o,'"'),a==o&&e.push(' selected="selected"'),e.push(">",kt.i18n(o),"</option>")}function oe(e,t){t?(e.removeClass("disabled"),e.removeAttr("disabled")):(e.addClass("disabled"),e.attr("disabled","disabled"))}function le(t,a,n,r,o,l,i){function d(e,t,a,n){return"undefined"===e||e===kt.i18n("noData")?n*a:null==e||"null"===e?"undefined"===t||t===kt.i18n("noData")?-1*n*a:n*a:""===e&&("undefined"===t||t===kt.i18n("noData")||null==t||"null"===t)?-1*n*a:n*a}function p(e,t,a){var n=e,r=t;if("number"===a.state.columnSortingType&&(e=parseFloat(e),t=parseFloat(t)),"number"===a.state.columnSortingType&&null!=a.option.sortingNullNumberPosition){var o="asc"===a.state.sortingInfo[0].sortingDirection?1:-1;if(null==e||isNaN(e)){if("top"===a.option.sortingNullNumberPosition)return d(n,r,o,-1);if("bottom"===a.option.sortingNullNumberPosition)return d(n,r,o,1)}if(null==t||isNaN(t)){if("top"===a.option.sortingNullNumberPosition)return 1*o;if("bottom"===a.option.sortingNullNumberPosition)return-1*o}}else if((a.state.columnSortingType||"string"===a.state.columnSortingType)&&null!=a.option.sortingNullStringPosition){var o="asc"===a.state.sortingInfo[0].sortingDirection?1:-1;if(null==e||""===e||"null"===e||"undefined"===e||e===kt.i18n("noData")){if("top"===a.option.sortingNullStringPosition)return d(e,t,o,-1);if("bottom"===a.option.sortingNullStringPosition)return d(e,t,o,1)}if(null==t||""===t||"null"===t||"undefined"===t||t===kt.i18n("noData")){if("top"===a.option.sortingNullStringPosition)return 1*o;if("bottom"===a.option.sortingNullStringPosition)return-1*o}}return e===t?0:e<t?-1:1}var u=e.isArray(t.state.filteredDataList),c=[],g=[],f=!1,h=t.state.filterColumnMappingList;if(u&&h){for(var m in h)h.hasOwnProperty(m)&&(h[m].columnIndex!=r?g.push(h[m].filterOption):f=!0);f?c=0==g.length?t.state.data:t._getFilteredDataListExcept(parseInt(r)):(c=t.state.renderTargetDataList,t.option.grouping&&t.option.grouping.showGroupSummaryOnly&&(c=t.state.targetDataList))}else c=t.state.data;var v,x,y=u?t.state.filteredDataList:"",C={},I={},_={};if(c){x=c.length;for(var w=0;w<x;w++)v=c[w],C[v[n]]!==!0&&void 0!==v[n]&&(C[v[n]]=!0,I[v[n]]=v)}if(u&&y){x=y.length;for(var w=0;w<x;w++)v=y[w],_[v[n]]=!0}var b,M,S,E=t.columnInfo(r),T=i.useRenderToFilter;if(t.state.isFilterRendered=!1,E.render&&T){M=E.render;var D=E.render.type;s(E.render)?(t.state.isFilterRendered=!0,b=E.render):D&&t.option.renderMapping.hasOwnProperty(D)&&(b=t.option.renderMapping[D].renderer,s(b)&&(S=!1,t.state.isFilterRendered=!0))}var R=l.minWidth,F=l.minHeight;null!=i.width&&(R=Math.max(parseInt(i.width),R)),null!=i.height&&(F=Math.max(parseInt(i.height),F));var k=null,L=null;null!=t.option.sortingNullNumberPosition&&(k=t.option.sortingNullNumberPosition),null!=t.option.sortingNullStringPosition&&(L=t.option.sortingNullStringPosition);var A=i.filterGridOption,O={autoColumnIndex:!0,height:F,width:R,title:null,absoluteProgressPosition:!0,autoResize:!1,cellInlineEdit:!1,cellPopupEdit:!1,cellRefreshOnRowSelect:!1,columnFixShowFrom:null,columnFixUpto:null,data:null,defaultColumnMapping:null,defaultSorting:{sortingColumn:"label"},disableCellRenderedEvent:!0,disableFocusedState:!0,disableHeaderClickSorting:!1,disableTreeEdit:!0,enableDefaultContextMenu:!1,enableDropData:!1,excelWorker:null,filteringHeader:!1,filteringHeaderHeight:null,fitTableWidth:!0,headerGroup:null,headerRowHeight:null,hiddenColumnArea:!1,hideSortingHandle:!1,pager:!1,paging:null,renderMapping:null,rowFixCount:null,rowInlineEdit:!1,rowFixShowFrom:null,rowOption:null,rowPadding:!1,rowSingleSelect:!1,columnMapping:[{selectorColumn:!0,width:30,excludeFitWidth:!0},{key:"label",width:155,title:kt.i18n("filterList"),resizing:"self",sorting:function(e,t,a,n){var r=this;if(null!=H&&null!=H.state)return r.state.selectAll?p(e,t,H):a._state.selected?n._state.selected?p(e,t,H):-1:n._state.selected?1:p(e,t,H)},render:function(e,a,n){var r=this,o=document.createDocumentFragment(),l=document.createElement("label");if(l.className="alopexgrid-filter-checkboxlabel",null==a.label||"undefined"===a.label)l.appendChild(document.createTextNode(kt.i18n("noData")));else if(t.state.isFilterRendered){var i=t._dataGetByIndex({id:a.dataid}),d=E,s=r.state.filterRenderFuntion(i[d.key],i,d.render||{type:"string"},d,t);t._setCellContent(s,l)}else l.appendChild(document.createTextNode(a.label));return o.appendChild(l),o}}]},P={cellSelectable:!1,enableContextMenu:!1,contextMenu:!1,defaultSorting:{sortingDirection:"asc"},disableTextSelection:!0,footer:!1,message:{nodata:t.option.message.filterNodata},preventScrollPropagation:!0,rowClickSelect:!0,sortingNullNumberPosition:k,sortingNullStringPosition:L,tree:null},B=e.extend(!0,{},P,A,O);new kt(a.get(0),B);var G="click";a.on(G+"."+t.key,function(e){var t=kt.parseEvent(e),a=it(t.$grid);if(t.headercell&&t.mapping.selectorColumn)a.state.selectAll===!1?(oe(o,!1),a.state.selectAll=!1):(oe(o,!0),a.state.selectAll=!0);else if(t.bodycell){t.data;if(0==a.state.data.length)return;a.sortClear();var n=a.state.data.length,r=a._dataGet({_state:{selected:!0}}).length;r===n&&t.data._state.selected===!0?(a._rowSelectAllCheck(),a.state.selectAll=!0):(a._rowSelectAllUncheck(),a.state.selectAll=!1),0===n||0===r?oe(o,!1):oe(o,!0)}});var H=it(a);E.sorting?H.state.columnSortingType=E.sorting:H.state.columnSortingType=!0,null==H.state.filterDuplicateMap&&(H.state.filterDuplicateMap={}),H.state.filterRenderFuntion=b,H.state.isDefaultRenderType=S,H.state.filterRenderObj=M,H.state.filterRenderMapping=E;var N,$=[],W=0,K=!0;for(value in C){N=!0;var v=I[value],U="";if(t.state.isFilterRendered){if(H.state.filterRenderFuntion&&H.state.isDefaultRenderType?U=H.state.filterRenderFuntion(H.state.filterRenderObj,value):H.state.filterRenderFuntion&&null!==H.state.isDefaultRenderType&&(U=H.state.filterRenderFuntion(value,v,E.render||{type:"string"},E,H)),(U&&U.nodeType||U.jquery)&&(U=e(U).text()),H.state.filterDuplicateMap.hasOwnProperty(U)){H.state.filterDuplicateMap[U][value]=!0;continue}H.state.filterDuplicateMap[U]={}}u&&_[value]!==!0&&(K=!1,N=!1),$[W]={_state:{selected:N},label:value,dataid:v._index.id},W++}H.dataSet($),K?(H._rowSelectAllCheck(),H.state.selectAll=!0):(H._rowSelectAllUncheck(),H.state.selectAll=!1)}function ie(t){var a=e(t.target),n=t.data.self,r=kt.trimString(a.attr("class"));if("alopexgrid-filter-dropdownbutton"!==r&&"alopexgrid-filter-dropdownbutton filtered"!==r&&"alopexgrid-filter-checkboxlabel"!==r&&"alopexgrid-filter-checkbox"!==r&&a){if(a.closest(".column-title").length>0)return;if(a.closest(".alopexgrid-filterdropdown-wrapper,.alopexgrid-filter-checkboxlabel,.alopexgrid-filter-checkbox").length)return;if(a.closest(".alopexgrid-contextmenu").length>0)return;n._removeFilterDropdown()}}function de(e){var t=e.which?e.which:e.keyCode;switch(t){case 27:e.data.self._removeFilterDropdown()}}function se(e,t,a,n,r){var o=e.state.filterDropdownWrapper.find(".filtertext"),l=e.state.filterDropdownWrapper.find(".filterselect"),i=e.state.filterDropdownWrapper.find(".filtertextbottom"),d=e.state.filterDropdownWrapper.find(".filterselectbottom"),s=o.val(),p=l.val(),u=i.val(),c=d.val();if("filterselect"===n.className)if(""===c||""===u){if(""===t)return o.val(""),"remove";if(""===s)return null;a.type=t,a.value=s}else{if(""===t)return o.val(""),i.val(""),d.val(""),"remove";if(""===s)return null;a.type=[t,c],a.value=[s,u],e.state.filterDropdownWrapper.find("#alopexgrid_andradio").prop("checked")?a.rule="and":a.rule="or"}else if("filter-radio"===n.className){if(""===s||""===p||""===u||""===c)return null;a.type=[p,c],a.value=[s,u],a.rule=t}else if(""===u){if("bottom"!==r)return null;if(""===s||""===p)return null;a.type=p,a.value=s}else if(""===t){if(i.val(""),d.val(""),""===s||""===p)return null;a.type=p,a.value=s}else{if(""===s||""===p)return null;a.type=[p,t],a.value=[s,u],e.state.filterDropdownWrapper.find("#alopexgrid_andradio").prop("checked")?a.rule="and":a.rule="or"}return a}function pe(e,t){var a=null;return a=isNaN(Number(t))?(t+"").replace(/["']/g,""):J(e,parseInt(t))}function ue(t){return!t||e.isEmptyObject(t)}function ce(e,t,a){var n=e[e.length-1];if(n){var r=n[t];if(!r)return!1;var o=Number(r.from),l=Number(r.to),i=Number(t);return o===i?a?r:l-o:o<i&&i<l&&(!a||r)}}function ge(t,a){var n=null;return t&&t.length?(e.each(t,function(e,t){if(t)if(n){var r=ce(t,Number(a),!0);Math.abs(r.to-r.from)>Math.abs(n.to-n.from)&&(n=r)}else n=ce(t,Number(a),!0)}),n):n}function fe(e,t,a){if(a[e]=a[e]||0,t[e])for(var n=0,r=t[e].length;n<r;n++)a[t[e][n]]=(a[e]||0)+1,e!==t[e][n]&&fe(t[e][n],t,a)}function he(t,a,n){if(!a)return null;var r=[];e.isArray(a)||(a=[a]);for(var o=e.map(a,function(e){if(e&&e._index)return e._index.id}),l=0;l<t.state.data.length;l++){var i=t.state.data[l];e.inArray(i._index.id,o)>=0&&r.push(i)}if(n)for(var d=t.state.data.length;d--;){var i=t.state.data[d];e.inArray(i._index.id,o)>=0&&t.state.data.splice(d,1)}return r}function me(e,t,a){return kt.filterFunction[a.filterOption.type](e,a.filterOption.value)}function ve(e,t,a){return[kt.filterFunction[a.filterOption.type[0]](e,a.filterOption.value[0]),kt.filterFunction[a.filterOption.type[1]](e,a.filterOption.value[1])]}function xe(e){return u(e.columnIndex)&&e.hidden!==!0&&"conceal"!==e.hidden}function ye(e,t){for(var a=0,n=e.length;a<n;a++){var r=e[a];if(Number(r.columnIndex)===Number(t)||"string"==typeof r.key&&r.key===t)return(r.hidden===!0||"conceal"===r.hidden)&&r.hidden}return!1}function Ce(e){var t="";return e.state.dataFilltrimmer&&(t+="self.state.dataFilltrimmer(self, item);"),e.state.dataCompositor&&(t+="self.state.dataCompositor(self, item);"),s(e.option.valueFilter)&&(t+="self._filterDataByValueFilter(item);"),e.option.setOriginalFromStart&&(t+="item._original = AlopexGrid.trimObject(item);"),new Function("AlopexGrid","self","item",t)}function Ie(t,a,n,r,o){r=r||{};var l=a[n];if(o&&(l=kt.currentData(l)),"function"==typeof r)return!!r.call(t,l);if(r._index){if(r._index.hasOwnProperty("id"))return r._index.id===l._index.id;if(r._index.hasOwnProperty("data"))return r._index.data===l._index.data;if(r._index.hasOwnProperty("row")){if(r._index.row===!0&&null!=l._index.row)return!0;var i=t.state.renderTargetDataList[r._index.row];return!(!i||i._index.id!==l._index.id)}}if(d(r._state))for(var s in r._state)if("editing"===s){if(r._state[s]===!0&&!l._state[s])return!1;if(r._state[s]===!1&&l._state[s])return!1}else if(r._state[s]!==l._state[s])return!1;var p=kt.trimObject(r);if(!e.isEmptyObject(p)){var u=!1;if(e.each(p,function(e,t){if(l[e]!==t)return u=!0,!1}),u)return!1}return!0}function _e(e,t,a){if("boolean"==typeof a.readonly||"function"==typeof a.readonly){var n=a.readonly;if("function"==typeof n&&(n=a.readonly.call(e,t[a.key],t,a)),"boolean"==typeof n)return n===!0}if(e.option.rowOption&&("boolean"==typeof e.option.rowOption.readonly||"function"==typeof e.option.rowOption.readonly)){var n=e.option.rowOption.readonly;if("function"==typeof n&&(n=n.call(e,t,e.option.rowOption)),"boolean"==typeof n)return n===!0}return!1}function we(e,t){return!(!e||!t)&&!!(t.editable&&e._state.editing&&e._state.editing.hasOwnProperty(t.columnIndex))}function be(e){return!!e.state.cellSelection&&(e.state.cellSelection.rightBoundaryColumnIndex-e.state.cellSelection.leftBoundaryColumnIndex||e.state.cellSelection.bottomBoundaryRenderedIndex-e.state.cellSelection.topBoundaryRenderedIndex)}function Me(e){return!(null==e||isNaN(e))}function Se(e){return!!(e.state&&e.option.cellSelectable&&e.state.cellSelection&&Me(e.state.cellSelection.focusColumnIndex)&&Me(e.state.cellSelection.focusRenderedIndex))}function Ee(e){delete e.state.cellSelection,Ve(e)}function Te(e,t){return Math.min(Math.max(e.state.renderTargetDataList.length-1,0),Math.max(e.option.rowFixShowFrom||0,t))}function De(e,t){return Math.min(Math.max(e.state.columnFixShowFromColumnIndex||0,t),e.state.maxColumnIndex)}function Re(e,t,a){delete e.state.cellSelection,e.state.cellSelection={},e.state.cellSelection.renderedIndexMap={},e.state.cellSelection.columnIndexMap={},1==!!e.state.customShiftKey?(e.state.cellSelection.renderedIndexMap[e.state.prevCellRender]=!0,e.state.cellSelection.columnIndexMap[e.state.prevCellColum]=!0):(e.state.prevCellRender=t,e.state.prevCellColum=a),t=Te(e,t),a=De(e,a),e.state.cellSelection.focusRenderedIndex=t,e.state.cellSelection.focusColumnIndex=a,e.state.cellSelection.focusRowspanInfo=e._getRowspanInfoForCell(Te(e,t),De(e,a)),e.state.cellSelection.renderedIndexMap[t]=!0,e.state.cellSelection.columnIndexMap[a]=!0,e.state.cellSelection.rightBoundaryColumnIndex=e.state.cellSelection.focusColumnIndex,e.state.cellSelection.leftBoundaryColumnIndex=e.state.cellSelection.focusColumnIndex,e.state.cellSelection.bottomBoundaryRenderedIndex=e.state.cellSelection.focusRenderedIndex,e.state.cellSelection.topBoundaryRenderedIndex=e.state.cellSelection.focusRenderedIndex}function Fe(e){e.$wrapper.find(".cell-selected").removeClass($t)}function ke(e){if(e.state.cellSelection){for(var t=null,a=null,n=0,r=e.state.cellSelection.dataList.length;n<r;n++){var o=e.state.cellSelection.dataList[n]._index.row;null!=o&&(t=null!=t?Math.min(o,t):o,a=null!=a?Math.max(o,a):o)}for(var l=null,i=null,n=0,r=e.state.cellSelection.columnList.length;n<r;n++){var d=e.state.cellSelection.columnList[n];xe(d)&&(l=null==l?d.columnIndex:Math.min(l,d.columnIndex),i=null==i?d.columnIndex:Math.max(i,d.columnIndex))}var s=e.state.cellSelection.focusRenderedIndex,p=e.state.cellSelection.focusColumnIndex;null==s&&(s=t),null==p&&(p=l),s=Math.min(Math.max(t,s),a),p=Math.min(Math.max(l,p),i),Ne(e,t,l,a,i,s,p)}}function Le(e){if(e.state.cellSelection){e.state.cellSelection.rightBoundaryColumnIndex=e.state.cellSelection.focusColumnIndex,e.state.cellSelection.leftBoundaryColumnIndex=e.state.cellSelection.focusColumnIndex,e.state.cellSelection.topBoundaryRenderedIndex=e.state.cellSelection.focusRenderedIndex,e.state.cellSelection.bottomBoundaryRenderedIndex=e.state.cellSelection.focusRenderedIndex,e.state.cellSelection.dataList=[],e.state.cellSelection.columnList=[];for(var t in e.state.cellSelection.renderedIndexMap){var a=parseInt(t);for(var n in e.state.cellSelection.columnIndexMap){var r=parseInt(n);e.state.visibleIndexMapByColumnIndex[r]>=0&&(e.state.cellSelection.rightBoundaryColumnIndex=Math.max(e.state.cellSelection.rightBoundaryColumnIndex,r),e.state.cellSelection.leftBoundaryColumnIndex=Math.min(e.state.cellSelection.leftBoundaryColumnIndex,r),e.state.cellSelection.bottomBoundaryRenderedIndex=Math.max(e.state.cellSelection.bottomBoundaryRenderedIndex,a),e.state.cellSelection.topBoundaryRenderedIndex=Math.max(0,Math.min(e.state.cellSelection.topBoundaryRenderedIndex,a)))}var o=e.state.renderTargetDataList[a];o&&e.state.cellSelection.dataList.push(o)}for(var r=e.state.cellSelection.leftBoundaryColumnIndex,l=e.state.cellSelection.rightBoundaryColumnIndex;r<=l;r++)e.state.visibleIndexMapByColumnIndex[r]>=0&&e.state.cellSelection.columnList.push(e.state.columnIndexToMapping[r])}}function Ae(e){return!!e.state.cellSelection&&e.state.cellSelection.focusColumnIndex<=e.state.fixupto}function Oe(e){return!!e.state.cellSelection&&e.state.cellSelection.focusRenderedIndex<e.option.rowFixCount}function Pe(e){return!!e.state.cellSelection&&(e.state.cellSelection.leftBoundaryColumnIndex<=e.state.fixupto&&e.state.cellSelection.rightBoundaryColumnIndex>e.state.fixupto)}function Be(e){return!!e.state.cellSelection&&(e.state.cellSelection.topBoundaryRenderedIndex<e.option.rowFixCount&&e.state.cellSelection.bottomBoundaryRenderedIndex>=e.option.rowFixCount)}function Ge(e,t){return t<e.option.rowFixCount}function He(e,t){return t<=e.state.fixupto}function Ne(e,t,a,n,r,o,l){function i(e){return Math.abs(e.state.cellSelection.rightBoundaryColumnIndex-e.state.cellSelection.leftBoundaryColumnIndex)}function d(e){return Math.abs(e.state.cellSelection.topBoundaryRenderedIndex-e.state.cellSelection.bottomBoundaryRenderedIndex)}null!=o&&null!=l?Re(e,o,l):Re(e,t,a);for(var s=Math.min(t,n),p=Math.max(t,n),u=Math.min(a,r),c=Math.max(a,r),g=u;g<=c;g++)for(var f=s;f<=p;f++)if(null!=e.state.visibleIndexMapByColumnIndex[g]){var h=Ue(e,f,g);"number"==typeof h&&(f=h)}var m=c-u,v=p-s;for(Le(e);m!==i(e)||v!==d(e);)m=i(e),v=d(e),Ke(e),Le(e);Fe(e),$e(e),Je(e)}function $e(t){if(t.state.cellSelection&&t.state.refreshbodycell)for(var a=0,n=t.state.refreshbodycell.renderedDataList.length;a<n;a++){var r=t.state.refreshbodycell.renderedDataList[a];if(r){var o=r._index.row;if(!(o<t.state.cellSelection.topBoundaryRenderedIndex||o>t.state.cellSelection.bottomBoundaryRenderedIndex))for(var l=0,i=t.state.refreshbodycell.renderedColumnMappingList.length;l<i;l++){var d=t.state.refreshbodycell.renderedColumnMappingList[l],s=d.columnIndex;
if(!(s<t.state.cellSelection.leftBoundaryColumnIndex)&&!(s>t.state.cellSelection.rightBoundaryColumnIndex)&&t.state.visibleIndexMapByColumnIndex[s]>=0){var p=e("#"+t._cellIdFromRowIndex(o,s));if(p&&p.length){p.css("color"),p.css("background-color"),kt.trimString(p.prop("className").split("cell-selected")[0]);p.addClass("cell-selected");var u=t.state.cellSelection.focusRowspanInfo&&t.state.cellSelection.focusRowspanInfo.from<=o&&t.state.cellSelection.focusRowspanInfo.to>=o,c=t._getColspanUpto(r,s),g=s<=c&&s<=t.state.cellSelection.focusColumnIndex&&t.state.cellSelection.focusColumnIndex<=c;s===t.state.cellSelection.focusColumnIndex&&o===t.state.cellSelection.focusRenderedIndex?p.addClass("cell-selected-focus"):u&&t.state.cellSelection.focusColumnIndex===s?p.addClass("cell-selected-focus"):g&&o===t.state.cellSelection.focusRenderedIndex?p.addClass("cell-selected-focus"):g&&u&&p.addClass("cell-selected-focus"),s===t.state.cellSelection.leftBoundaryColumnIndex&&p.addClass("cell-selected-leftline"),s===t.state.cellSelection.rightBoundaryColumnIndex&&p.addClass("cell-selected-rightline"),o===t.state.cellSelection.topBoundaryRenderedIndex&&p.addClass("cell-selected-topline"),o===t.state.cellSelection.bottomBoundaryRenderedIndex&&p.addClass("cell-selected-bottomline")}}}}}}function We(t,a,n,r){var o=null,l=null;if(n.colspan){var i=Number(e.isNumeric(n.colspan)?n.colspan:s(n.colspan)?n.colspan(a[n.key],a,n,t._getGroupingRangeByData(a,n)):null);o=i}else{if(!n.colspanTo)return null;l=t.state.visibleIndexMapByColumnIndex[n.columnIndex];var d=s(n.colspanTo)?n.colspanTo(a[n.key],a,n,t._getGroupingRangeByData(a,n)):n.colspanTo;if("string"==typeof d){var p=t.state.visibleIndexMapByKey[d],u=p-l+1;o=u>0?u:null}else{var p=t.state.visibleIndexMapByColumnIndex[d],u=p-l+1;o=u>0?u:null}}if(r){l=l||t.state.visibleIndexMapByColumnIndex[n.columnIndex];var p=t.state.visibleIndexMapByColumnIndex[r],u=p-l+1;o=u>0?Math.min(o,u):null}return l+o>t.state.visibleColumnCount&&(o=t.state.visibleColumnCount-l),o}function Ke(e){for(var t=e.state.cellSelection.topBoundaryRenderedIndex,a=e.state.cellSelection.bottomBoundaryRenderedIndex,n=e.state.cellSelection.leftBoundaryColumnIndex,r=e.state.cellSelection.rightBoundaryColumnIndex,o=n;o<=r;o++)for(var l=t;l<=a;l++)if(e.state.visibleIndexMapByColumnIndex[o]>=0){var i=Ue(e,l,o);"number"==typeof i&&(l=i)}}function Ue(e,t,a){var n=Q(e,a);if(n){e.state.cellSelection.renderedIndexMap[t]=!0,e.state.cellSelection.columnIndexMap[a]=!0;var r=!(!n.rowspan||!e.option.grouping||e.option.grouping.useGroupRowspan!==!0)&&e._getRowspanInfoForCell(t,a);if(r){for(var o=r.from,l=r.to,i=Math.min(l,o,e.state.renderTargetDataList.length-1),d=Math.min(Math.max(l,o),e.state.renderTargetDataList.length-1),s=i;s<=d;s++){e.state.cellSelection.renderedIndexMap[s]=!0;for(var p=e._getRenderedDataFromRenderedIndex(s),u=a;u>=0;u--)if(e.state.visibleIndexMapByColumnIndex[u]>=0){var n=Q(e,u);if(n&&xe(n)&&(n.colspan||n.colspanTo)){var c=e._getColspanUpto(p,n);if(c&&!(c<a))for(var g=u;g<=c&&g<=e.state.maxColumnIndex;g++)e.state.visibleIndexMapByColumnIndex[g]>=0&&(e.state.cellSelection.columnIndexMap[g]=!0)}}}return d}for(var p=e._getRenderedDataFromRenderedIndex(t),u=a;u>=0;u--){var n=Q(e,u);if(n&&xe(n)&&(n.colspan||n.colspanTo)){var c=e._getColspanUpto(p,n);if(c&&!(c<a))for(var g=u;g<=c&&g<=e.state.maxColumnIndex;g++)e.state.cellSelection.columnIndexMap[g]=!0}}}}function Ye(t,a,n){var r=e("#"+t._cellIdFromRowIndex(a,n));if(r.length)return r;if(t.state.groupRowspanned&&t.option.grouping&&t.option.grouping.useGroupRowspan===!0){var o=Q(t,n);if(o&&o.rowspan){var l=t._getRowspanInfoForCell(a,n);if(!l)return null;if(l.from!==a){var i=a-1;return l.from<a&&(i=l.from||0),i===a?null:Ye(t,i,n)}}}for(var d=t._getRenderedDataFromRenderedIndex(a),s=n;s>=0;s--){var o=Q(t,s);if(o){if(!xe(o))return;var p=t._getColspanUpto(d,o);if(n<=p)return n===o.columnIndex?null:Ye(t,a,o.columnIndex)}}return null}function Ve(e){e&&e.option&&(e.$focusfixture.removeAttr("data-alopexgrid-dataindex data-alopexgrid-dataid data-alopexgrid-rowindex"),e.$focusfixture.removeAttr("data-alopexgrid-columnindex"),e.$focusfixture.removeProp("columnIndex"),e.$focusfixture.removeProp("renderedIndex"),e.$focusfixture[0].style.top="-1px",e.$focusfixture[0].style.left="-1px",e.$focusfixture[0].style.height="0.1px",e.$focusfixture[0].style.width="0.1px",e.$focusfixture[0].style.fontSize="0.1px",e.$focusfixture[0].style.lineHeight="0.1px")}function Xe(e,t,a,n){if(e&&e.option){if(!e.option.cellSelectable)return Ve(e),void e.$focusfixture.empty();var r={},o={};if(u(t)){var l=e.state.renderTargetDataList[t];r.renderedIndex=t,null!=l._index.data&&(o["data-alopexgrid-dataindex"]=l._index.data),null!=l._index.id&&(o["data-alopexgrid-dataid"]=l._index.id),o["data-alopexgrid-rowindex"]=t}u(a)&&(r.columnIndex=a,o["data-alopexgrid-columnindex"]=a);var i=null!=t&&e.$focusfixture.prop("renderedIndex")!==t||null!=a&&e.$focusfixture.prop("columnIndex")!==a;e.$focusfixture.prop(r).attr(o);var d=e.cellElementGet({_index:{row:t}},a);if(d.length){var s=e.$wrapper.position();e.$focusfixture[0].style.top=s.top+parseInt(d[0].style.top)+parseInt(d[0].style.height)-1+"px",e.$focusfixture[0].style.left=s.left+parseInt(d[0].style.left)+parseInt(d[0].style.width)-1+"px"}if(n!==!0){e.$focusfixture.empty();var p=e.$focusfixture[0];yt===!1&&(p.appendChild(document.createTextNode(" ")),q(p,!0))}i&&l&&e._triggerGridEvent("cellFocus",{data:l||null,mapping:e.state.columnIndexToMapping[a]||null},d)}}function ze(e,t,a){e.state.cellSelection&&(t=Te(e,t),a=De(e,a),e.state.cellSelection.focusRenderedIndex=t,e.state.cellSelection.focusColumnIndex=a,e.state.cellSelection.focusRowspanInfo=e._getRowspanInfoForCell(e.state.cellSelection.focusRenderedIndex,e.state.cellSelection.focusColumnIndex),Ue(e,t,a),Le(e),Qe(e,e.state.cellSelection.focusRenderedIndex,e.state.cellSelection.focusColumnIndex),Fe(e),$e(e),setTimeout(function(){Xe(e,t,a)},0))}function je(e,t,a,n,r){t=Te(e,t),a=De(e,a),Re(e,t,a),Ue(e,t,a),Le(e),n&&("up"===n?e.state.cellSelection.focusRenderedIndex=e.state.cellSelection.topBoundaryRenderedIndex:"down"===n?e.state.cellSelection.focusRenderedIndex=e.state.cellSelection.bottomBoundaryRenderedIndex:"left"===n?e.state.cellSelection.focusColumnIndex=e.state.cellSelection.leftBoundaryColumnIndex:"right"===n&&(e.state.cellSelection.focusColumnIndex=e.state.cellSelection.rightBoundaryColumnIndex)),e.state.cellSelection.focusRowspanInfo=e._getRowspanInfoForCell(e.state.cellSelection.focusRenderedIndex,e.state.cellSelection.focusColumnIndex),r!==!0&&Qe(e,e.state.cellSelection.focusRenderedIndex,e.state.cellSelection.focusColumnIndex),Fe(e),$e(e),setTimeout(function(){e.state.cellSelection&&Xe(e,e.state.cellSelection.focusRenderedIndex,e.state.cellSelection.focusColumnIndex,r)},0)}function qe(e,t,a){if(e&&e.state&&e.state.cellSelection){var n=e.state.cellSelection.focusRenderedIndex,r=e.state.cellSelection.focusColumnIndex,o=be(e),l=n+t,i=e._getRowspanInfoForCell(n,r);t&&i&&(l=(t>0?i.to:i.from)+t);var d=r,s=e._getColspanInfoForCell(n,r);if(a&&(a>0?d=ot(e,s?s.to:r,a):a<0&&(d=rt(e,s?s.from:r,-a))),o&&i){var p=e.state.cellSelection.rightBoundaryColumnIndex-e.state.cellSelection.leftBoundaryColumnIndex;p||e.state.cellSelection.topBoundaryRenderedIndex!=i.from||e.state.cellSelection.bottomBoundaryRenderedIndex!=i.to||(o=!1)}if(o&&s){var u=e.state.cellSelection.bottomBoundaryRenderedIndex-e.state.cellSelection.topBoundaryRenderedIndex;u||e.state.cellSelection.leftBoundaryColumnIndex!=s.from||e.state.cellSelection.rightBoundaryColumnIndex!=s.to||(o=!1)}o&&i&&s&&e.state.cellSelection.topBoundaryRenderedIndex==i.from&&e.state.cellSelection.bottomBoundaryRenderedIndex==i.to&&e.state.cellSelection.leftBoundaryColumnIndex==s.from&&e.state.cellSelection.rightBoundaryColumnIndex==s.to&&(o=!1),o?(t?(l>e.state.cellSelection.bottomBoundaryRenderedIndex?(l=e.state.cellSelection.topBoundaryRenderedIndex,d=ot(e,d,1)):l<e.state.cellSelection.topBoundaryRenderedIndex&&(l=e.state.cellSelection.bottomBoundaryRenderedIndex,d=rt(e,d,1)),d>e.state.cellSelection.rightBoundaryColumnIndex?d=e.state.cellSelection.leftBoundaryColumnIndex:d<e.state.cellSelection.leftBoundaryColumnIndex&&(d=e.state.cellSelection.rightBoundaryColumnIndex)):a&&(d>e.state.cellSelection.rightBoundaryColumnIndex?(d=e.state.cellSelection.leftBoundaryColumnIndex,l++):d<e.state.cellSelection.leftBoundaryColumnIndex&&(d=e.state.cellSelection.rightBoundaryColumnIndex,l--),l>e.state.cellSelection.bottomBoundaryRenderedIndex?l=e.state.cellSelection.topBoundaryRenderedIndex:l<e.state.cellSelection.topBoundaryRenderedIndex&&(l=e.state.cellSelection.bottomBoundaryRenderedIndex)),ze(e,l,d)):(a>0&&(d===r||null==d)?(d=e.state.visibleColumnMappingList[0].columnIndex,l+=1):a<0&&(d===r||null==d)&&(d=e.state.visibleColumnMappingList[e.state.visibleColumnMappingList.length-1].columnIndex,l-=1),l<0?(l=e.state.renderTargetDataList.length-1,a||(d=rt(e,d,1),d!==r&&null!=d||(d=e.state.visibleColumnMappingList[e.state.visibleColumnMappingList.length-1].columnIndex))):l>=e.state.renderTargetDataList.length&&(l=0,a||(d=ot(e,d,1),d!==r&&null!=d||(d=e.state.visibleColumnMappingList[0].columnIndex))),je(e,l,d))}}function Ze(e,t,a,n,r){var o=e.state.cellSelection.focusRenderedIndex,l=e.state.cellSelection.focusColumnIndex;if(t)if(e.state.cellSelection.focusColumnIndex<e.state.cellSelection.rightBoundaryColumnIndex)delete e.state.cellSelection.columnIndexMap[e.state.cellSelection.rightBoundaryColumnIndex],l=Math.max(0,rt(e,e.state.cellSelection.rightBoundaryColumnIndex,1)),e.state.cellSelection.rightBoundaryColumnIndex=l;else{var i=Math.max(rt(e,e.state.cellSelection.leftBoundaryColumnIndex,1),0);e.state.cellSelection.columnIndexMap[i]=!0,e.state.cellSelection.leftBoundaryColumnIndex=Math.max(0,Math.min(e.state.cellSelection.leftBoundaryColumnIndex,i)),l=i}else if(a)if(e.state.cellSelection.focusColumnIndex>e.state.cellSelection.leftBoundaryColumnIndex)delete e.state.cellSelection.columnIndexMap[e.state.cellSelection.leftBoundaryColumnIndex],l=ot(e,e.state.cellSelection.leftBoundaryColumnIndex,1),e.state.cellSelection.leftBoundaryColumnIndex=l;else{var i=Math.min(ot(e,e.state.cellSelection.rightBoundaryColumnIndex,1),e.state.maxColumnIndex);e.state.cellSelection.columnIndexMap[i]=!0,e.state.cellSelection.rightBoundaryColumnIndex=Math.min(e.state.maxColumnIndex,Math.max(e.state.cellSelection.rightBoundaryColumnIndex,i)),l=i}else if(n){n=n===!0?1:n;for(var d=e.state.cellSelection.focusRenderedIndex,s=e.state.cellSelection.leftBoundaryColumnIndex;s<=e.state.cellSelection.rightBoundaryColumnIndex;s++){var p=(Q(e,s),e._getRowspanInfoForCell(e.state.cellSelection.focusRenderedIndex,s));if(p){var u=p.to-p.from;u&&(d=p.to)}}var c=d<e.state.cellSelection.bottomBoundaryRenderedIndex;if(c){for(var g=Math.max(0,e.state.cellSelection.bottomBoundaryRenderedIndex-n),f=g,s=e.state.cellSelection.leftBoundaryColumnIndex;s<=e.state.cellSelection.rightBoundaryColumnIndex;s++){var p=(Q(e,s),e._getRowspanInfoForCell(f,s));p&&p.to-p.from>0&&(g=Math.max(Math.min(g,p.from-1),e.state.cellSelection.focusRenderedIndex))}for(var h=e.state.cellSelection.bottomBoundaryRenderedIndex;h>e.state.cellSelection.focusRenderedIndex&&h>g;h--)delete e.state.cellSelection.renderedIndexMap[h];o=g,e.state.cellSelection.bottomBoundaryRenderedIndex=g}else{for(var m=Math.max(e.state.cellSelection.topBoundaryRenderedIndex-n,0),f=m,s=e.state.cellSelection.leftBoundaryColumnIndex;s<=e.state.cellSelection.rightBoundaryColumnIndex;s++){var p=(Q(e,s),e._getRowspanInfoForCell(f,s));p&&p.to-p.from>0&&(m=Math.max(Math.min(m,p.from),0))}for(var h=e.state.cellSelection.topBoundaryRenderedIndex;h>=m&&h>=0;h--)e.state.cellSelection.renderedIndexMap[h]=!0;o=m,e.state.cellSelection.topBoundaryRenderedIndex=m}}else if(r){r=r===!0?1:r;for(var v=e.state.cellSelection.focusRenderedIndex,s=e.state.cellSelection.leftBoundaryColumnIndex;s<=e.state.cellSelection.rightBoundaryColumnIndex;s++){var p=(Q(e,s),e._getRowspanInfoForCell(e.state.cellSelection.focusRenderedIndex,s));if(p){var u=p.to-p.from;u&&(v=p.from)}}var c=v>e.state.cellSelection.topBoundaryRenderedIndex;if(c){for(var g=Math.min(e.state.cellSelection.topBoundaryRenderedIndex+r,Math.max(e.state.renderTargetDataList.length-1,0)),f=g,s=e.state.cellSelection.leftBoundaryColumnIndex;s<=e.state.cellSelection.rightBoundaryColumnIndex;s++){var p=(Q(e,s),e._getRowspanInfoForCell(f,s));p&&p.to-p.from>0&&(g=Math.min(Math.max(g,p.to+1),e.state.cellSelection.focusRenderedIndex))}for(var h=e.state.cellSelection.topBoundaryRenderedIndex;h<e.state.cellSelection.focusRenderedIndex&&h<g;h++)delete e.state.cellSelection.renderedIndexMap[h];o=g,e.state.cellSelection.topBoundaryRenderedIndex=g}else{for(var m=Math.min(e.state.renderTargetDataList.length-1,e.state.cellSelection.bottomBoundaryRenderedIndex+r),f=m,s=e.state.cellSelection.leftBoundaryColumnIndex;s<=e.state.cellSelection.rightBoundaryColumnIndex;s++){var p=(Q(e,s),e._getRowspanInfoForCell(f,s));p&&p.to-p.from>0&&(m=Math.min(Math.max(m,p.to),e.state.renderTargetDataList.length-1))}for(var h=e.state.cellSelection.bottomBoundaryRenderedIndex;h<=m&&h<e.state.renderTargetDataList.length;h++)e.state.cellSelection.renderedIndexMap[h]=!0;o=m,e.state.cellSelection.bottomBoundaryRenderedIndex=m}}Ke(e),Le(e),Fe(e),$e(e);Ye(e,o,l);Qe(e,o,l)}function Qe(e,t,a,n){var r=(e.state.columnWidthMap,e.state.rowHeight,e.state.wrapperWidth,e.state.wrapperHeight,e.state.renderFromRenderedIndex),o=e.state.renderFromColumnIndex,l=e.state.renderToRenderedIndex,i=e.state.renderToColumnIndex,d=!1,s=!1;if(e.state.fixupto>=0){var p=e.state.refreshbodycell.renderedColumnMappingList,u=e.state.refreshbodycell.renderedFixedColumnMappingList;if(null!=p[u.length]&&(o=p[u.length].columnIndex),e.state.refreshbodycell.scrollEndXOffset<0)for(var c=0,g=0;c>e.state.refreshbodycell.scrollEndXOffset&&p[u.length+ ++g]&&(c-=e.state.columnWidthMap[p[u.length+g].columnIndex],!(c<=e.state.refreshbodycell.scrollEndXOffset));)o=p[u.length+g].columnIndex;a<=e.state.fixupto&&n!==!0&&(d=!0)}if(e.option.rowFixCount>0){t<e.option.rowFixCount&&n!==!0&&(s=!0);for(var f=e.option.rowFixShowFrom||0;f<e.option.rowFixCount;f++){var h=e.state.renderTargetDataList[f];h&&r++}}else if(e.state.refreshbodycell&&e.state.refreshbodycell.renderedPinnedDataList){t<e.state.refreshbodycell.renderedPinnedDataList.length&&n!==!0&&(s=!0);for(var f=0;f<e.state.refreshbodycell.renderedPinnedDataList.length;f++){var h=e.state.refreshbodycell.renderedPinnedDataList[f];h&&r++}}var m=e.state.visibleIndexMapByColumnIndex,v=!1;if(!d&&e.state.scrollxMoveable)if(a<o)e._scrollLeftEvent(m[o]-m[a],!1),v=!0;else if(e.state.scrollxEnd&&a<=o)e._scrollLeftEvent(m[o]-m[a],!1),v=!0;else if(a>=i){for(var x=e.state.wrapperWidth,y=e.state.fixedColumnWidth,C=a,I=a,_=e.state.columnWidthMap[a];I>=0;){var w=e.state.columnIndexToMapping[--I];if(w&&xe(w)){var c=e.state.columnWidthMap[w.columnIndex]||0;if(y+_+c>x)break;_+=c,C=I}}var b=m[C]-m[o];e._scrollRightEvent(b,!1),v=!0}if(e.option.height&&!s&&e.state.scrollyMoveable)if(t<r&&!(t<e.option.rowFixCount))e._scrollUpEvent(r-t,!1),v=!0;else if(e.state.scrollyEnd&&t<=r&&!(t<e.option.rowFixCount))e._scrollUpEvent(r-t,!1),v=!0;else if(t>=l&&!(t<e.option.rowFixCount)){var h=e.state.renderTargetDataList[t],M=Math.min(e.state.renderTargetDataList.length,t);if(h&&e.state.refreshbodycell&&e.state.refreshbodycell.bodyCellPositionY){var S=t-e.state.renderFromRenderedIndex;if(h=e.state.refreshbodycell.renderedDataList[S]){var E=e.state.rowHeightMapByDataId[h._index.id]||e.state.rowHeight,T=e.state.refreshbodycell.bodyCellPositionY[S];E+T>e.state.refreshbodycell.bodyCellEndY&&(e._scrollDownEvent(M-l+1,!1),v=!0)}else e._scrollDownEvent(M-l+1,!1),v=!0}}v&&e._refreshBoard()}function Je(e,t){if(!e.state.cellSelection)return e.$root.trigger("cellSelectionEmpty");for(var a=e.state.cellSelection.topBoundaryRenderedIndex,n=e.state.cellSelection.bottomBoundaryRenderedIndex,r=e.state.cellSelection.leftBoundaryColumnIndex,o=e.state.cellSelection.rightBoundaryColumnIndex,l=[],i=a;i<=n;i++)for(var d=e._getRenderedDataFromRenderedIndex(i),s=r;s<=o;s++){var p=Q(e,s);p&&d&&(!d._meta&&p.key&&l.push(d[p.key]),d._meta&&l.push(d[p.columnIndex]))}var u=t||"cellSelectionChange";if(!t&&e.state.cellSelection.lastSelectionEventParam){var c=e.state.cellSelection.lastSelectionEventParam;if(c.fromSelectionRow===a&&c.toSelectionRow===n&&c.fromSelectionColumn===r&&c.toSelectionColumn===o)return}var g={};g.selectionValueList=l,g.fromSelectionRow=a,g.toSelectionRow=n,g.fromSelectionColumn=r,g.toSelectionColumn=o,t||(e.state.cellSelection.lastSelectionEventParam=g),e._triggerGridEvent(u,g)}function et(t){if(t.state.cellSelection){for(var a="<table>",r=t.state.cellSelection.topBoundaryRenderedIndex,o=t.state.cellSelection.bottomBoundaryRenderedIndex,l=[],i=t.state.cellSelection.leftBoundaryColumnIndex;i<=t.state.cellSelection.rightBoundaryColumnIndex;i++){var s=t.state.columnIndexToMapping[i];s&&xe(s)&&l.push(s)}a+="<tbody>";var p=t.state.cellSelection;t.state.cellSelection=null;for(var c=[],g=!(t.option.cellSelectableOption&&t.option.cellSelectableOption.copyCellStyle),f=!(!t.option.cellSelectableOption||!t.option.cellSelectableOption.copyRenderedText),h=t.option.grouping&&t.option.grouping.useGrouping?t.option.grouping.groupRowspanMode:null,m=r;m<=o;m++){var v=t._getRenderedDataFromRenderedIndex(m);if(v){var x=!(!v._state.groupHeader&&!v._state.groupFooter);a+="<tr>";for(var i=0,y=l.length;i<y;i++)if(c[i]=c[i]||0,c[i]>0)c[i]--;else{var s=l[i],C=t._getRowspanInfoForCell(m,s.columnIndex),I=t._getColspanUpto(v,s),_=t._generateCellAttribute(v,s);_.styleclass="cell bodycell "+_.styleclass;var w=v[s.key];if(f||x){var b=document.createElement("div");if(h&&x&&null!=s.rowspan){var M=v,S=t._getGroupingRangeByData(v,s),E=s.rowspan.by||s.rowspan;1==E&&(E=s.key);var T=t.state.groupKeyOrderMap[E];1==h&&S.groupDepth==T||S.groupDepth<T||(M=S.member[0]),w=t._generateCellContent(M,s)}else w=t._generateCellContent(v,s);w!==!1&&t._setCellContent(w,b);var D=e(b);D.find("input").replaceWith(function(){return"text"===this.type?this.value:this}),w=D.text(),D.remove()}var R=0;if(C&&(R=C.to-m+1,c[i]=R-1,_.rowspan=R),I>s.columnIndex){for(var F=1,k=i+1;k<y;k++){var L=l[k];if(L.columnIndex<=I&&F++,L.columnIndex>=I)break}_.colspan=F,i+=F-1}a+="<td";var A=document.createElement("div");if(A.className=_.styleclass,t.$wrapper[0].appendChild(A),It)var O=n(A);else var O=window.getComputedStyle(A);_.style=(_.style||"")+"background-color:"+O.getPropertyValue("background-color")+";color:"+O.getPropertyValue("color")+";",t.$wrapper[0].removeChild(A),A=null,O=null;for(var P in _){var B=P,G=_[P];if("styleclass"===B)B="class";else if("style"===B){if(g)continue;if(d(G)){G="";for(var H in _[P])G+=H+":"+_[P][H]+";"}}"number"!=typeof G&&"string"!=typeof G||(a+=" "+B+'="'+G+'"')}a+=">",a+=u(w)?String(w).replace(/\n/g,'<br style="mso-data-placement:same-cell;"/>'):"",a+="</td>"}a+="</tr>"}}return t.state.cellSelection=p,a+="</tbody></table>"}}function tt(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value}function at(e,t,a,n){var r=e.state.renderTargetDataList[t],o=e.state.columnIndexToMapping[a];if(!r||!o)return!1;if(r._state.groupFooter||r._state.groupHeader)return!1;if(e.state.testRowAllowPaste){if("boolean"===e.state.testRowAllowPaste&&e.option.rowOption.allowPaste===!1)return!1;if("function"===e.state.testRowAllowPaste&&e.option.rowOption.allowPaste(r)===!1)return!1}if(null!=o.allowPaste){if(o.allowPaste===!1)return!1;if("function"==typeof o.allowPaste&&o.allowPaste.call(e,r[o.key],r,o,n)===!1)return!1}return!0}function nt(t,a){var n=[];if(It&&(a=a.toLowerCase()),a.indexOf("&lt;table")>=0&&a.indexOf("table&gt;")>=0&&(a=tt(a)),a.indexOf("<table")>=0){a=a.slice(a.indexOf("<table")),a.lastIndexOf("</table>")>=0&&(a=a.slice(0,a.lastIndexOf("</table>"))+"</table>");var r=e(a),o=r.find("tr");o.each(function(e,t){n[e]=[]}),o.each(function(t,a){e(a).children().each(function(e,a){if(a.rowSpan>1)for(var r=t+parseInt(a.rowSpan),o=t+1;o<r;o++)n[o][e]=null;if(a.colSpan>1)for(var l=e+1;l<e+colSpan;l++)n[t][l]=null;null!==n[t][e]&&(n[t][e]=a.innerText||a.textContent)})})}if(!n.length)return!1;var l=t.state.visibleIndexMapByColumnIndex[t.state.cellSelection.focusColumnIndex];Re(t,t.state.cellSelection.focusRenderedIndex,t.state.cellSelection.focusColumnIndex);for(var i=0;i<n.length;i++)for(var d=t.state.cellSelection.focusRenderedIndex+i,s=0;s<n[i].length;s++){var p=t.state.visibleColumnMappingList[l+s];if(p){var u=p.columnIndex,c=n[i][s];if(Ue(t,d,u),void 0!==c&&null!==c){if(at(t,d,u,c)===!1)continue;t.cellEdit(c,{_index:{row:d}},u)}}}return t._refreshBoard(!0),Le(t),Fe(t),$e(t),Je(t),!0}function rt(e,t,a){var n=e.state.visibleIndexMapByColumnIndex[t];a=a||1;var r=e.state.visibleColumnMappingList[n-a];return null!=r?e.state.visibleColumnMappingList[Math.max(n-a,0)].columnIndex:null}function ot(e,t,a){var n=e.state.visibleIndexMapByColumnIndex[t];a=a||1;var r=e.state.visibleColumnMappingList[n+a];return null!=r?e.state.visibleColumnMappingList[Math.min(n+a,e.state.visibleColumnCount-1)].columnIndex:null}function lt(e){e.state.headerSelection&&(delete e.state.headerSelection.from,delete e.state.headerSelection.to,e.$wrapper.find(".headercell").removeClass("header-selected"))}function it(t){return e(t).data(kt.KEY_NAME)}var dt="3.10.11";window.__AlopexGridBuildVersion__=dt;var st=window.__AlopexGridMajorVersion__||"3",pt=window.__AlopexGridClassRoot__||"alopexgrid",ut=window.__AlopexGridExportName__||"AlopexGrid",ct=window.__AlopexGridJQueryExportName__||"alopexGrid",gt=window.__AlopexGridRemoveJQueryExportName__||"removeAlopexGrid",ft=window.__AlopexGridUniqueKeyPrefix__||"alopexgrid",ht=window.__AlopexGridAlopexUISetupName__||"grid";if(String(dt).toLowerCase().indexOf("-dev")>=0&&console&&(console.error||console.log)){var mt="[Warning] This is a development version of the AlopexGrid('".toUpperCase()+dt+"'), and should not be used on production systems. ".toUpperCase()+"CLIENT DATE : "+new Date;try{console.error?console.error(mt):console.log&&console.log(mt)}catch(e){}}var vt=e(window),xt=e(document),yt=function(){var e={Android:function(){return!!navigator.userAgent.match(/Android/i)},BlackBerry:function(){return!!navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return!!navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return!!navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return!!navigator.userAgent.match(/IEMobile/i)||!!navigator.userAgent.match(/WPDesktop/i)},any:function(){return e.Android()||e.BlackBerry()||e.iOS()||e.Opera()||e.Windows()}};return e.any()}(),Ct=function(){var e={iOS:function(){return!!navigator.userAgent.match(/iPhone|iPad|iPod/i)}};return e.iOS()}(),It=function(){var e=document.createElement("div");return e.innerHTML="<!--[if lt IE 9]><i></i><![endif]-->",1==e.getElementsByTagName("i").length}(),_t=function(){for(var e=3,t=document.createElement("b"),a=t.all||[];t.innerHTML="<!--[if gt IE "+ ++e+"]><i><![endif]-->",a[0];);return Math.min(e>4?e:document.documentMode,document.documentMode)||!1}();It&&(Date.now||(Date.now=function(){return(new Date).getTime()}));var wt=ft,bt=parseInt,Mt=Number(Math.random().toString().split(".").pop().slice(-3));e.inArray("dataTransfer",e.event.props)<0&&e.event.props.push("dataTransfer"),e.inArray("clipboardData",e.event.props)<0&&e.event.props.push("clipboardData"),e.inArray("alopexgrid",e.event.props)<0&&e.event.props.push("alopexgrid");var St=Object.prototype.toString.call({}),Et=/(\/\/.*$)|(\/\*[\s\S]*?\*\/)|(\s*=[^,\)]*(('(?:\\'|[^'\r\n])*')|("(?:\\"|[^"\r\n])*"))|(\s*=[^,\)]*))/gm,Tt=/([^\s,]+)/g,Dt=window[h(["88sc","ne8hcaq"].join(2))],Rt=!1,Ft=!1,kt=function(t,n){var r=this==window?{}:this,i=it(t);if(u(w()||p())){if(i)return r.updateOption(n),r;r.$root=e(t),r.root=r.$root.get(0);var c=kt.trimString(String(r.root.tagName).toLowerCase());if("div"!==c)throw delete r.$root,delete r.root,new Error("[AlopexGrid] AlopexGrid cannot be created on <"+c+"> element. A <div> element should be used.");if(r._triggerGridEvent("gridInit",{element:t,option:n},t)===!1)return null;kt.commonOption.preConstructor&&s(kt.commonOption.preConstructor)&&kt.commonOption.preConstructor.call(r,e(t),n);var g=o();if(r.key=g,r.eventns="."+r.key+"t"+Math.random().toString().slice(-5).split(".").join(""),r.unique=l(),r.serial=kt.serial++,r.version=kt.version,r.state={progressStack:0,data:[],renderTargetDataList:[],deletedData:[],footerData:{},sortingInfoKeyMap:{},refreshTimer:{},viewUpdate:{},cellCache:{},cellCacheHelper:{padDataList:[],padDataIdOnQueue:[],cacheDataList:[]},columnFitWidthById:{},ctrlDataIndexMap:{}},T(r,n)){var f=null;if(n&&n.extend){f={};var h=n.extend;e.isArray(h)||(h=[h]);for(var m=0,v=h.length;m<v;m++){var x=kt.commonOption.definition[h[m]];d(x)&&e.extend(!0,f,x)}}r.option=e.extend(!0,{},kt.defaultOption,kt.commonOption,f)}return e(t).data(kt.KEY_NAME,r).attr("data-alopexgrid",g),r.viewInit(),r.$title=r.$root.find(">.title"),r.$titlelabel=r.$title.children(".title-label"),r.$titleMarkup=r.$title.children(".title-markuparea"),r.$titleFolding=r.$title.children(".table-toggle"),r.$columnhiddenarea=r.$root.find(">.columnhiddenarea"),r.$pager=r.$root.find(">.pager"),r.$pagerleft=r.$pager.find(".pager-left"),r.$pagerright=r.$pager.find(".pager-right"),r.$pagercenter=r.$pager.find(".pager-center"),r.$wrapper=r.$root.find(".wrapper"),r.$focusfixture=r.$root.find(".fixed-focus-catch"),r.$scrollbarx=e('<div class="scrollbar x"></div>').appendTo(r.$wrapper).data("alopexGridScrollbarElement","x"),r.$scrollbarLeftButton=e('<div class="scrollbutton leftbutton">').appendTo(r.$scrollbarx).data("alopexGridScrollbarElement","x"),r.$scrollbarRightButton=e('<div class="scrollbutton rightbutton">').appendTo(r.$scrollbarx).data("alopexGridScrollbarElement","x"),r.$horizontalScrollHandle=e('<div class="scrollhandle">').appendTo(r.$scrollbarx).data("alopexGridScrollbarElement","x"),r.$scrollbary=e('<div class="scrollbar y"></div>').appendTo(r.$wrapper).data("alopexGridScrollbarElement","y"),r.$scrollbarUpButton=e('<div class="scrollbutton upbutton">').appendTo(r.$scrollbary).data("alopexGridScrollbarElement","y"),r.$scrollbarDownButton=e('<div class="scrollbutton downbutton">').appendTo(r.$scrollbary).data("alopexGridScrollbarElement","y"),r.$verticalScrollHandle=e('<div class="scrollhandle">').appendTo(r.$scrollbary).data("alopexGridScrollbarElement","y"),It?(r.state.bodyCellList=a(r.$wrapper[0],"bodycell"),r.state.nodataCellList=a(r.$wrapper[0],"nodatacell"),r.state.headerCellList=a(r.$wrapper[0],"headercell"),r.state.footerCellList=a(r.$wrapper[0],"footercell"),r.state.paginationList=function(){return r.$pager[0].querySelectorAll(".pagination")}):(r.state.bodyCellList=r.$wrapper[0].getElementsByClassName("bodycell"),r.state.nodataCellList=r.$wrapper[0].getElementsByClassName("nodatacell"),r.state.headerCellList=r.$wrapper[0].getElementsByClassName("headercell"),r.state.footerCellList=r.$wrapper[0].getElementsByClassName("footercell"),r.state.paginationList=r.$pager[0].getElementsByClassName("pagination")),r.updateOption(n),r.state.loaded=!0,kt.instances[g]=r,kt.commonOption.postConstructor&&s(kt.commonOption.postConstructor)&&kt.commonOption.postConstructor.call(r,r.$root,r.option),r._triggerGridEvent("gridInitEnd",{element:r.$root.get(0),option:r.option}),r}};e.extend(kt,{version:st,release:dt}),e.extend(kt,{i18n:function(e){return kt.i18nLocaleSet[kt.locale][e]},locale:"ko",i18nLocaleSet:{ko:{sum:"",count:"",average:"",equal:"",notequal:"",contain:"",notcontain:" ",lt:" ",lte:"  ",gt:" ",gte:"  ",freezePanes:"",freezePanesRow:"()",freezeCancel:" ",addRow:"   ",enlarge:"",enlargeMsg:" .",enlargeExit:" ",removeFilter:"",filterList:" ",noData:"(  )",save:"",close:"",apply:"",filterHeader:"",textFilterHeader:" ",textFilterAnd:"",textFilterOr:"",dataFilterHeader:" ",selectItem:"",totalCount:" ",exportMsg:"   . CSV  ?",exportCsvYbutton:"",exportCsvNbutton:"xlsx ",importMsg:"xlsx  .",importConfirmButton:"",row:"",column:"",progress:"..."},en:{sum:"Sum",average:"Average",equal:"equal",notequal:"notequal",contain:"contain",notcontain:"notcontain",lt:"lesser",lte:"less than or equal",gt:"greater",gte:"greater than or equal",freezePanes:"Freeze Panes",freezePanesRow:"Freeze Panes(row)",freezeCancel:"Freeze Cancel",addRow:"Insert a row",enlarge:"Zoom in",enlargeMsg:"Zoom activated.",enlargeExit:"Zoom out",removeFilter:"Remove Filter",filterList:"Filter List",noData:"(no field data)",save:"Save",close:"Close",apply:"Apply",filterHeader:"Filter",textFilterHeader:"Text Filter",textFilterAnd:"And",textFilterOr:"Or",dataFilterHeader:"Data Filter",selectItem:"Select",totalCount:"Total Count",exportMsg:"Available data export amount has been exceeded. Do you want to CSV format?",exportCsvYbutton:"Confirm",exportCsvNbutton:"proceed to xlsx",importMsg:"Only xlsx format available.",importConfirmButton:"Confirm",row:"Row",column:"Column",progress:"loading..."},ja:{sum:"",count:"",average:"",equal:"",notequal:"",contain:"",notcontain:"",lt:"",lte:"",gt:"",gte:"",freezePanes:"",freezePanesRow:"()",freezeCancel:" ",addRow:"",enlarge:"",enlargeMsg:"",enlargeExit:"",removeFilter:"",filterList:"",noData:"()",save:"",close:"",apply:"",filterHeader:"",textFilterHeader:" ",textFilterAnd:"",textFilterOr:"",dataFilterHeader:" ",selectItem:"",totalCount:"",exportMsg:" CSV",exportCsvYbutton:"",exportCsvNbutton:"xlsx",importMsg:"xlsx",importConfirmButton:"",row:"",column:"",progress:"..."},zh:{sum:"",count:"",average:"",equal:"",notequal:"",contain:"",notcontain:"",lt:"",lte:"",gt:"",gte:"",freezePanes:"",freezePanesRow:"()",freezeCancel:" ",addRow:"",enlarge:"",enlargeMsg:"",enlargeExit:"",removeFilter:"",filterList:"",noData:"()",save:"",close:"",apply:"",filterHeader:"",textFilterHeader:" ",textFilterAnd:"",textFilterOr:"",dataFilterHeader:" ",selectItem:"",totalCount:" ",exportMsg:" CSV?",exportCsvYbutton:"",exportCsvNbutton:"xlsx",importMsg:"xlsx",importConfirmButton:"",row:"",column:"",progress:"..."}}}),e.extend(!0,kt,{commonOption:{definition:{},preConstructor:null,postConstructor:null},defaultOption:{width:null,height:null,header:!0,headerGroup:[],title:!1,titleMarkup:null,hideGridFoldingButton:!1,data:[],pager:!1,paging:{current:null,dataLength:null,rowCount:null,enabled:!0,pageDataLength:null,pageRowCount:null,pagerCount:null,pagerSelect:null,pagerTotal:null,hidePageList:!1,perPage:null,total:null,enabledByPager:!1,countGroupSummary:!1},defaultColumnMapping:{width:100,tooltip:!0,exportRender:!0},autoColumnIndex:!1,columnMapping:[],rowOption:{highlight:null,styleclass:null,allowSelect:null,allowPaste:null,allowEdit:null,defaultHeight:null,nodataRowHeight:null,inlineStyle:null,filter:null},footer:{position:null,footerMapping:[],usePageData:!1,autoColspan:!1},headerRowHeight:null,footerRowHeight:null,filteringHeaderHeight:null,on:{cell:{},headercell:{}},autoResize:!0,autoResizeDelay:200,hiddenColumnArea:!1,message:{nodata:null,valueFilter:null,pagerTotal:null,filterNodata:null,noFilteredData:null},rowClickSelect:!1,rowSingleSelect:!1,rowSingleSelectAllowUnselect:!0,singleSelectorColumnWithRadio:!1,rowspanGroupSelect:!0,cellRefreshOnRowSelect:!1,disableTextSelection:!1,disableCellSelectionRestore:!1,rowspanGroupEdit:!0,useColumnRowspan:!1,progressDelay:null,progressText:null,defaultProgressText:"loading...",progressStyleclass:null,absoluteProgressPosition:!1,numberingColumnFromZero:!0,rowindexColumnFromZero:!0,defaultState:{dataAdd:{},dataSet:{}
},eventMapping:{},disableCellRenderedEvent:!1,renderMapping:{},renderRuleOption:{textKey:"text",valueKey:"value",htmlKey:"html",checkedKey:"checked"},valueFilter:null,flushCallback:null,hideSortingHandle:!1,disableHeaderClickSorting:!1,disableHeaderTitleAttribute:!1,disableSortClearOnReset:!1,getEditingDataOnEvent:!0,fitTableWidth:!1,wrapCellContent:!1,wrapCellContentClassName:"cell-content",directEdit:!1,ellipsisText:!1,autoSortingType:!1,clientSortingOnDynamicDataSet:!0,sortingNullNumberPosition:"bottom",sortingNullStringPosition:null,disableFocusedState:!1,rowspanGroupFocus:!1,editableNameWithKey:!1,parseValueOnStartEdit:!1,mergeEditingImmediately:!1,fullCompareForEditedState:!1,disableMultiMappingGet:!1,grouping:{by:[],useGroupHeader:!1,useGroupFooter:!1,useGroupRowspan:!1,useGrouping:!1,useGroupRearrange:!1,summaryRender:{sum:function(e){return kt.i18n("sum")+" : "+e},count:function(e){return kt.i18n("count")+" : "+e},groupName:function(e){return e},average:function(e){return kt.i18n("average")+" :"+e}},useGroupColumnRearrange:!1,useDragDropBetweenGroups:!1,groupFoldingColumnPosition:"right",showGroupSummaryOnly:!1,foldedGroupHeader:null,foldedGroupFooter:null,groupRowspanMode:0},enableHeaderSelect:!1,filteringHeader:!1,filter:{closeOuterClick:!0,minHeight:200,minWidth:275,movable:!1,saveFilterSize:!1,title:!1,typeList:["equal","notequal","contain","notcontain","lt","lte","gt","gte"],scrollResetAfterFilter:!0,filterGridOption:{},textFilterDelay:450},columnFixUpto:null,rowFixCount:0,columnFixShowFrom:null,rowFixShowFrom:null,disableScrolledFix:!1,disableFoldingInEditingCell:!1,cellSelectable:!1,cellSelectableOption:{copyCellStyle:!0,copyRenderedText:!1,copyTextformOnly:!1,detectTSV:!1,useMinPageUpDownScroll:!1,ignoreVerticalScrollMoveTempo:!1},disableCellFocusAtInput:!1,endInlineEditByOuterClick:!1,rowInlineEdit:!1,rowInlineEditOption:{startEvent:"dblclick",endAllEditing:!1,endEditByEnter:!0,disableEvent:!1},cellInlineEdit:!1,cellInlineEditOption:{startEvent:"dblclick",focusMoveAtEditEnd:!0,allowStartEditWithInvalid:!0,endEditByOtherAreaClick:!0},restoreFocusOnInvalidInlineEdit:!1,cellPopupEdit:!1,cellPopupEditOption:{closeOuterClick:!0,height:300,width:350,minHeight:100,minWidth:120,movable:!0,savePopupSize:!0,startEvent:"dblclick"},instantInlineEditType:["radio","checkbox","select"],defaultInstantInlineEdit:null,forceRefreshAllOnCellEdit:!1,forceRefreshAllOnDataEdit:!1,refreshByOnHiddenColumn:!1,useClassHovering:!1,rowspanGroupHovering:!1,enlargeOption:{closeButtonMarkup:"X"},enableDefaultContextMenu:!0,enableContextMenu:!0,contextMenuEvent:"contextmenu",defaultContextMenu:[{title:function(e,t,a){return kt.i18n("freezePanes")},processor:function(e,t,a){var n=parseInt(t.attr("data-alopexgrid-columnindex")),r={};r.columnFixUpto=n-1,r.columnFixShowFrom=a.state.renderFromColumnIndex,e&&(r.rowFixCount=e._index.row,r.rowFixShowFrom=Math.max(a.option.rowFixShowFrom||0,a.state.renderFromRenderedIndex)),a.updateOption(r)},use:function(e,t){return!(!t.hasClass("bodycell")||t.hasClass("summarycell"))}},{title:function(e,t,a){return kt.i18n("freezePanesRow")},processor:function(e,t,a){for(var n=0;n<a.option.columnMapping.length;n++)a.option.columnMapping[n].fixed=!1;var r={columnFixUpto:"unfix",columnFixShowFrom:null,rowFixCount:e._index.row,rowFixShowFrom:Math.max(a.option.rowFixShowFrom||0,a.state.renderFromRenderedIndex)};a.updateOption(r)},use:function(e,t){return!(!e||!t.hasClass("bodycell")||t.hasClass("summarycell"))}},{title:function(e,t,a){return kt.i18n("freezePanes")},processor:function(e,t,a){a.rowUnfix();var n=parseInt(t.attr("data-alopexgrid-columnindex"));a.updateOption({columnFixUpto:n-1,columnFixShowFrom:a.state.renderFromColumnIndex})},use:function(t,a,n){return!(!a.hasClass("headercell")||!e.isNumeric(a.attr("data-alopexgrid-columnindex")))}},{title:function(e,t,a){return kt.i18n("freezeCancel")},processor:function(e,t,a){a.updateOption({columnFixUpto:"unfix",columnFixShowFrom:null,rowFixCount:0,rowFixShowFrom:null})},use:function(e,t,a){return!0}},{title:function(e,t,a){return kt.i18n("addRow")},processor:function(t,a,n){var r=e.extend(!0,{},n.state.emptyData),o=parseInt(a.attr("data-alopexgrid-rowindex")),l=t._index.data;if(t._meta){for(;t._meta&&t;)t=n._getRenderedDataFromRenderedIndex(--o);l=t._index.data+1}if(t){if(n.option.grouping&&n.option.grouping.by&&n.option.grouping.useGrouping)for(var i=0;i<n.option.grouping.by.length;i++){var d=n.option.grouping.by[i];"string"==typeof d&&(r[d]=t[d])}if(n.option.tree&&n.option.tree.useTree){var s=n.treeGetParent(t);s&&s.length&&(r[n.option.tree.parentIdKey]=s[0][n.option.tree.idKey])}n.showProgress(function(){n.dataAdd(r,{_index:{data:l}})})}},use:function(t,a,n){return a.hasClass("bodycell")&&e.isNumeric(a.attr("data-alopexgrid-rowindex"))}},{title:function(e,t,a){return kt.i18n("enlarge")},processor:function(e,t,a){a.enlargeStart()},use:function(e,t,a){return!a.state.isZoomed}},{title:function(e,t,a){return kt.i18n("enlargeExit")},processor:function(e,t,a){a.enlargeExit()},use:function(e,t,a){return!!a.state.isZoomed}},{title:function(e,t,a){return kt.i18n("removeFilter")},processor:function(e,t,a){a.clearFilter(!1)},use:function(e,t,a){return t.hasClass("headercell")||t.hasClass("filtercell")}}],contextMenu:[],contextMenuTitleMapper:null,alwaysShowVerticalScrollBar:!1,alwaysShowHorizontalScrollBar:!1,extendStateOnSet:!0,extendStateOnAdd:!0,fillUndefinedKey:!1,trimUnmappedKey:!1,readonlyRender:!0,disableCellTitle:!1,disableValueEscape:!1,currentPageInCenter:!1,enableHeaderGroupResizing:!0,setOriginalFromStart:!1,deepCopyOnDataGet:!1,enableDataGetAllByEmptyArray:!1,optionMergeLegacyMode:!1,sortClearOnEdit:!1,disableTreeEdit:!1,tree:{useTree:!1,idKey:null,parentIdKey:null,leftKey:null,rightKey:null,leafKey:null,depthKey:null,expandedKey:null,leafValue:["true","false"],expandedValue:["true","false"],depthValueType:"string",depthStartValue:0,rootNodeParentIdValue:"",initialIdValue:"0",idGenerator:null,initialExpandedValue:!0,dragdropExpandDelay:1200},importMapping:{},excelWorker:{exportOption:{},importOption:{}},lazyScroll:{enabled:!1,refreshDelay:400},scrollbarPreview:{enabled:!1,column:"default",row:"default",rowDefaultFromZero:!0,closeDelay:1500},cellCache:{enabled:!1,timerInterval:1,columnRange:"full",policy:"distant",capacity:100,padRatio:1.5,mode:"pad"},useScrollAcceleration:!0,useFrameSyncScroll:!0,preventScrollPropagation:!1,hiddenColumnOrderList:[],enableDropData:!0,searchOption:{useFilter:!1,useRenderToSearch:!0,caseSensitive:!1,ignoreWhiteSpace:!1,useRegex:!1,byColumn:!1},useContinuousXScroll:!1,useContinuousYScroll:!1}}),e.extend(!0,kt,{KEY_NAME:o(),serial:0,instances:{},markup:{child:[{tag:"div",attr:{styleclass:"title"},child:[{tag:"div",attr:{styleclass:"title-label"},child:""},{tag:"div",attr:{styleclass:"table-toggle"},child:""},{tag:"div",attr:{styleclass:"title-markuparea"},child:""}]},{tag:"div",attr:{styleclass:"columnhiddenarea","data-alopexgrid-columnhiddenarea":!0},child:[{tag:"div",attr:{styleclass:"columnhiddenarea-label"},child:""}]},{tag:"div",attr:{styleclass:"wrapper",style:"width:100%;"},child:""},{tag:"div",attr:{contentEditable:"true",style:"position:absolute;left:-1px;top:-1px;width:0.1px;height:0.1px;outline:none;padding:0;margin:0;border:none;overflow:hidden;color:transparent;text-shadow:0 0 0 #000;opacity:0;filter:Alpha(opacity=0);",styleclass:"fixed-focus-catch focus"}},{tag:"div",attr:{styleclass:"pager alopexgrid-pager",style:"position:relative;"},child:[{tag:"div",attr:{styleclass:"pager-left",style:""},child:""},{tag:"div",attr:{styleclass:"pager-center"},child:[{tag:"div",attr:{styleclass:"pagination first-page page-button","data-to-page":"first"}},{tag:"div",attr:{styleclass:"pagination prev-page page-button","data-to-page":"prev"}},{tag:"ul",attr:{styleclass:"pagination page-list","data-to-page":"list"}},{tag:"div",attr:{styleclass:"pagination next-page page-button","data-to-page":"next"}},{tag:"div",attr:{styleclass:"pagination last-page page-button","data-to-page":"last"}}]},{tag:"div",attr:{styleclass:"pager-right",style:""},child:""}]}]}}),e.extend(!0,kt,{plugin:[],addPlugin:function(e){s(e)&&(kt.removePlugin(e),kt.plugin.push(e))},removePlugin:function(e){for(var t=kt.plugin.length-1;t>=0;)kt.plugin[t]===e&&kt.plugin.splice(t,1),t--}}),e.extend(!0,kt,{trimObject:function(t,a){var n=e.extend({},t);if(a){var r=t._state;n._state={},n._state.added=r.added,n._state.deleted=r.deleted,n._state.edited=r.edited,n._state.selected=r.selected}else delete n._state;return delete n._index,delete n._edited,delete n._invalid,delete n._key,delete n._column,delete n._original,n},trimData:function(t,a){if(a=a||kt.commonOption.preserveStateOnTrim||null,e.isArray(t)){for(var n=[],r=0,o=t.length;r<o;r++)d(t[r])&&n.push(kt.trimObject(t[r],a));return n}return kt.trimObject(t,a)},trimString:String.prototype.trim?function(e){return null==e?"":e.toString().trim()}:function(t){return e.trim(t)},parseEvent:function(t){if(t.alopexgrid)return t.alopexgrid;var a=e(t.target),n=a.closest(".alopexgrid-cell"),r=null,o=null,l=null,i="."+pt.split(" ").join(".");if(r=a.closest(i),!r.length&&t.delegateTarget){var d=e(t.delegateTarget).closest(i);d.length&&(r=d)}if(!r.length&&t.currentTarget){var s=e(t.currentTarget).closest(i);s.length&&(r=s)}var p=it(r);if(!r.length&&n.length){var u=n.attr("data-alopexgrid-root");p=kt.instances[u],p&&(r=p.$root)}if(!n.length&&(o=a.closest("[data-alopexgrid-inscribe]"),o.length&&(l=o.attr("data-alopexgrid-inscribe").split(","),!p))){var u=l[0];p=kt.instances[u],p&&(r=p.$root)}var c={bodycell:!1,headercell:!1,footercell:!1};c.$grid=r;var g=null,f=null,h=!1;if(n.length)g=n.attr("data-alopexgrid-dataindex"),f=n.attr("data-alopexgrid-columnindex"),c.$cell=n;else if(l){g=p.state.dataIdToIndexMap[l[1]],f=parseInt(l[2]);var m=p.state.data[g];rowIndex=m?m._index.row:null,n=null!=rowIndex?r.find("#"+p._cellIdFromRowIndex(rowIndex,f)):r.find("#"+p.key+"-h-"+parseInt(l[3])+"-"+f),c.$cell=n}n.length&&(kt.renderUtil.hasClass(n[0],"bodycell")?(c.bodycell=!0,h=!0):kt.renderUtil.hasClass(n[0],"headercell")?(c.headercell=!0,h=!0):kt.renderUtil.hasClass(n[0],"footercell")&&(c.footercell=!0,h=!0));var v=p?p.state.data[g]||null:null,x=p?p.state.columnIndexToMapping[f]||null:null;return null!==x&&void 0!==x&&(c.mapping=x,v||(v={}),v._key=x.key,v._column=x.columnIndex,!isNaN(x.columnIndex)&&x.columnIndex>=0&&null!==v&&void 0!==v&&null!==v._index&&void 0!==v._index&&(v._index.column=x.columnIndex)),null!==v&&void 0!==v&&(c.data=v),h||(v&&v._index&&v._index.id&&x&&null!=x.columnIndex?c.bodycell=!0:v&&!v._index&&x&&null!=x.id&&(n&&n.length?kt.renderUtil.hasClass(n[0],"footercell")?c.footercell=!0:kt.renderUtil.hasClass(n[0],"headercell")&&(c.headercell=!0):l&&null!=l[3]&&(c.headercell=!0))),c},currentData:function(t){if(!t)return null;if(e.isArray(t)){for(var a=[],n=0,r=t.length;n<r;n++){var o=kt.currentData(t[n]);o&&a.push(o)}return a}var l=kt.instances[t._index.grid],i={};for(var d in t)t.hasOwnProperty(d)&&95!==d.charCodeAt(0)&&(i[d]=t[d]);if(t._index&&(i._index=t._index),t._state&&(i._state=t._state,t._state.editing))for(var s in t._state.editing){var d=l.state.columnIndexToKeyMap[s];i[d]=t._state.editing[s]}return i},currentValue:function(e,t){if(!e||!t)return null;var a=kt.instances[e._index.grid],n=e[t];if(e._state.editing){var r=a.state.columnKeyToIndexMap[t];void 0!==r&&e._state.editing.hasOwnProperty(r)&&(n=e._state.editing[r])}return n},escapeHTML:function(e){return kt.renderUtil.escapeHTMLString(e)},generateKey:o});var Lt=!!Array.prototype.map;kt.aggregateFunction={primitive:Lt?function(e,t){return e.map(function(e){return null==e?e:"object"==typeof e&&t?e[t]:e})}:function(e,t){for(var a=[],n=0,r=e.length;n<r;n++){var o=e[n];null==o?a.push[o]:"object"==typeof o?t&&a.push(o[t]):a.push(o)}return a},sum:function(e){for(var t=0,a=0,n=e.length-1;n>=0;n--)e[n]&&(t+=Number(e[n])||0,a=g(a,(String(e[n]).split(".")[1]||"").length));return kt.renderUtil.addCommas(parseFloat(t).toFixed(a))},average:function(e){for(var t=0,a=0,n=e.length-1;n>=0;n--)e[n]&&(t+=Number(e[n])||0,a=g(a,(String(e[n]).split(".")[1]||"").length));return kt.renderUtil.addCommas(parseFloat(t/e.length).toFixed(Math.max(a,2)))},stdev:function(e){for(var t=0,a=0,n=e.length-1;n>=0;n--)isNaN(Number(e[n]))||(a+=Number(e[n]),t+=Number(e[n])*Number(e[n]));var r=e.length?Math.sqrt(t/e.length-a/e.length*(a/e.length)):0;return kt.renderUtil.addCommas(parseFloat(r).toFixed(2))},count:function(e){return e.length||0},countif:function(e){for(var t=0,a=e.length-1;a>=0;a--)e[a]===paramArray[0]&&t++;return kt.renderUtil.addCommas(t)},min:function(e){for(var t=Number(e[e.length-1])||0,a=0,n=e.length-1;n>=0;n--)t=Math.min(t,Number(e[n])||0),a=g(a,(String(e[n]).split(".")[1]||"").length);return kt.renderUtil.addCommas(parseFloat(t).toFixed(a))},max:function(e){for(var t=Number(e[e.length-1])||0,a=0,n=e.length-1;n>=0;n--)t=Math.max(t,Number(e[n])||0),a=g(a,(String(e[n]).split(".")[1]||"").length);return kt.renderUtil.addCommas(parseFloat(t).toFixed(a))}};var At=/[a-z|-|-|-|\{\}\[\]\/?.,;:|\)*~`!^\-_+<>@\#$%&\\\=\(\'\"]/gi;kt.filterFunction={lt:function(e,t){return Number((""+e).replace(At,""))<Number((""+t).replace(At,""))},lte:function(e,t){return Number((""+e).replace(At,""))<=Number((""+t).replace(At,""))},gt:function(e,t){return Number((""+e).replace(At,""))>Number((""+t).replace(At,""))},gte:function(e,t){return Number((""+e).replace(At,""))>=Number((""+t).replace(At,""))},equal:function(e,t){return String(e).toLowerCase()===String(t).toLowerCase()},notequal:function(e,t){return String(e).toLowerCase()!==String(t).toLowerCase()},contain:function(e,t){return String(e).toLowerCase().indexOf(String(t).toLowerCase())>=0},notcontain:function(e,t){return String(e).toLowerCase().indexOf(String(t).toLowerCase())<0},checkedList:function(e,t){return It?t[e]===!0:t[e]===!0}};var Ot="classList"in document.createElement("_"),Pt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"," ":"&nbsp;"},Bt=function(){try{if(!e||!e.fn||"function"!=typeof e.fn.empty)return!1;var t=document.createElement("div");t.className="div";var a=document.createElement("span");t.appendChild(a),a.appendChild(document.createTextNode("span")),t.appendChild(document.createTextNode("div"));var n=e(t).data("element","12"),r=e(a).data("element","25");if(n.append("<h1>grid</h1>"),e(t).on("click",function(e){return!1}),e.fn.empty.call([t]),e.fn.remove.call([t]),t.firstChild)return!1;if(n.data("element"))return!1;if(r.data("element"))return!1}catch(e){return!1}return!0}();kt.renderUtil={escapeHTMLString:function(e){return R(e)},addCommas:function(e){var t=String(e).split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")},renderRuleToArray:function(e,t,a,n,r){if(!a.rule)return null;var o=a.rule;return s(a.rule)&&(o=a.rule(e,t,a,n,r)),o},normalizeRuleObject:function(e,t){var a=e;if(e&&"object"==typeof e){a={};for(var n in e)a[t.state.renderRuleKeyNormalizeMap[n]||n]=e[n]}return a},getTextFromRenderRuleArray:function(t,a,n,r,o){var l=t,i=kt.renderUtil.renderRuleToArray(t,a,n,r,o);if(i&&e.isArray(i))for(var d=0,s=i.length;d<s;d++){var p=kt.renderUtil.normalizeRuleObject(i[d],o);if(p&&p.value===t)if(p.hasOwnProperty("text"))l=p.text;else if(p.hasOwnProperty("html")){var u=document.createElement("span");u.innerHTML=p.html,l=e.text(u)}}return l},addThousandsSeperator:function(e,t){var a=String(e).split(".");return a[0]=a[0].replace(/\B(?=(\d{3})+(?!\d))/g,t||","),a.join(".")},attributeToElement:function(e,t){if(e&&"object"==typeof e&&t&&t.nodeType)for(var a in e)t.setAttribute(a,e[a])},defaultRendererClass:"alopexgrid-default-renderer",defaultInputWrapperClass:"alopexgrid-input-*-wrapper",addDefaultRendererClass:function(e){e.className=(e.className?e.className+" ":"")+kt.renderUtil.defaultRendererClass},addDefaultInputWrapperClass:function(e,t){e.className=(e.className?e.className+" ":"")+"alopexgrid-input-wrapper "+kt.renderUtil.defaultInputWrapperClass.replace("*",t||"text")},hasDefaultInputWrapperClass:function(e){return kt.renderUtil.hasClass(e,"alopexgrid-input-wrapper")},generateHTMLString:function(t){var a="";if(e.isArray(t)){for(var n=0,r=t.length;n<r;n++)a+=kt.renderUtil.generateHTMLString(t[n]);return a}if(!t||!t.tag&&!t.child)return t||"";if(t.tag){if(a+="<"+t.tag,t.attr)for(var o in t.attr){var l=o;"styleclass"==o&&(l="class"),a+=" "+l+'="'+t.attr[o]+'"'}a+=">"}if(e.isArray(t.child))for(var n=0,r=t.child.length;n<r;n++)a+=kt.renderUtil.generateHTMLString(t.child[n]);else t.child&&(a+=kt.renderUtil.generateHTMLString(t.child));return t.tag&&(a+="</"+t.tag+">"),a},hasClass:Ot?function(e,t){return e.classList.contains(t)}:function(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1},addClass:Ot?function(e,t){e.classList.add(t)}:function(e,t){kt.renderUtil.hasClass(e,t)||(e.className+=(e.className?" ":"")+t)},removeClass:Ot?function(e,t){e.classList.remove(t)}:function(e,t){kt.renderUtil.hasClass(e,t)&&(e.className=e.className.replace(new RegExp("(\\s|^)"+t+"(\\s|$)")," "))},emptyElement:Bt?function(t){e.fn.empty.call([t])}:function(t){e(t).empty()},setElementContent:function(e,t){if(!e)return null;kt.renderUtil.emptyElement(e);var a;return"string"==(a=typeof t)?e.innerHTML=t:t&&t.nodeType?e.appendChild(t):"number"===a?e.appendChild(document.createTextNode(t)):t&&t.jquery&&t.appendTo(e),e},inlineStyleToStyleObject:function(e,t,a,n){var r=e;if(t=t||{},"function"==typeof r&&(r=r.apply(n,a)),"string"==typeof r)for(var o=r.split(";"),l=0,i=o.length;l<i;l++){var d=o[l].split(":");t[kt.trimString(d[0])]=kt.trimString(d[1])}else if("object"==typeof r)for(var s in r){var p=r[s];"function"==typeof p&&(p=p.apply(n,a)),"string"!=typeof p&&"number"!=typeof p||(t[s]=p)}return t},isGridPointerActionProhibited:function(e){for(;null!=e;){if(kt.renderUtil.hasClass(e,"alopexgrid-handle")||kt.renderUtil.hasClass(e,"alopexgrid-ignore-pointeraction"))return!0;e=e.parentElement}return!1},getDocumentHeight:function(){var e=document.body,t=document.documentElement;return Math.max(e.scrollHeight,e.offsetHeight,t.clientHeight,t.scrollHeight,t.offsetHeight)},getDocumentWidth:function(){var e=document.body,t=document.documentElement;return Math.max(e.scrollWidth,e.offsetWidth,t.clientWidth,t.scrollWidth,t.offsetWidth)},getTextFromElement:function(t){if(t.nodeType){if("string"==typeof t.textContent)return t.textContent;if("string"==typeof t.innerText)return t.innerText}return e(t).text()}},kt.defaultOption.renderMapping.string={renderer:function(e,t,a,n,r){var o=document.createElement("span");kt.renderUtil.addDefaultRendererClass(o);var l=e;kt.renderUtil.attributeToElement(a.attr,o);var i=kt.renderUtil.renderRuleToArray(e,t,a,n,r);"string"==typeof i&&(i=[i]);var d=!1;if(i&&i.length)for(var s=0,p=i.length;s<p;s++){var u=kt.renderUtil.normalizeRuleObject(i[s],r);u&&"object"==typeof u?u.value===e&&(u.hasOwnProperty("html")?(l=u.html,d=!0):l=u.hasOwnProperty("text")?u.text:e):"string"==typeof u&&("comma"===u?l=null==e?"":kt.renderUtil.addThousandsSeperator(e):"ellipsis"===u&&(o.style.textOverflow="ellipsis",o.style.whiteSpace="nowrap",o.style.overflow="hidden"))}if(null==l&&(l=""),d)o.innerHTML=l;else{var c=document.createTextNode(l);o.appendChild(c)}return o}},kt.defaultOption.renderMapping.text={renderer:function(e,t,a,n,r){var l=document.createElement("input");if(kt.renderUtil.addDefaultRendererClass(l),l.type="text",l.name=(r.option.editableNameWithKey?n.key:null)||o(),a.styleclass){var i=a.styleclass;"function"==typeof i&&(i=i.call(r,e,t,a,n,r)||!1),"string"==typeof i&&kt.renderUtil.addClass(l,i)}var d=e;kt.renderUtil.attributeToElement(a.attr,l),a.readonly&&(l.readOnly=!0,l.className+=" disabled");var s=kt.renderUtil.renderRuleToArray(e,t,a,n,r);if(s&&s.length)for(var p=0,u=s.length;p<u;p++){var c=kt.renderUtil.normalizeRuleObject(s[p],r);c&&"object"==typeof c&&c.value===e&&(d=c.hasOwnProperty("text")?c.text:e)}return l.value=null==d?"":d,l},editedValue:function(e,t,a,n,r){return e.getElementsByTagName("INPUT")[0].value}},kt.defaultOption.renderMapping.select={renderer:function(e,t,a,n,r){var l=document.createElement("select");if(kt.renderUtil.addDefaultRendererClass(l),kt.renderUtil.attributeToElement(a.attr,l),l.name=(r.option.editableNameWithKey?n.key:null)||o(),a.readonly&&(l.disabled=!0,l.className+=" disabled"),a.styleclass){var i=a.styleclass;"function"==typeof i&&(i=i.call(r,e,t,a,n,r)||!1),"string"==typeof i&&kt.renderUtil.addClass(l,i)}var d=kt.renderUtil.renderRuleToArray(e,t,a,n,r);if(d&&d.length)for(var s=0,p=d.length;s<p;s++){var u=kt.renderUtil.normalizeRuleObject(d[s],r),c=document.createElement("option");if(c.value=u.value,u.hasOwnProperty("html"))c.innerHTML=u.html;else{var g=document.createTextNode(u.text||u.value);c.appendChild(g)}u.value===e&&(c.selected=!0),l.appendChild(c)}return l},editedValue:function(e,t,a,n,r){return e.getElementsByTagName("SELECT")[0].value}},kt.defaultOption.renderMapping.radio={renderer:function(e,t,a,n,r){var l=document.createDocumentFragment(),i=kt.renderUtil.renderRuleToArray(e,t,a,n,r),d=(r.option.editableNameWithKey?n.key:null)||o(),s=!1,p=null,u=null;if(i&&i.length)for(var c=0,g=i.length;c<g;c++){var f=kt.renderUtil.normalizeRuleObject(i[c],r),h=document.createElement("label");kt.renderUtil.addDefaultInputWrapperClass(h,"radio");var m=document.createElement("input"),v=document.createElement("span");if(kt.renderUtil.addDefaultRendererClass(m),0===c&&(p=m,u=h),m.type="radio",m.name=d,m.value=f.value,a.readonly&&(m.disabled=!0,h.className+=" disabled"),a.styleclass){var x=a.styleclass;"function"==typeof x&&(x=x.call(r,e,t,a,n,r)||!1),"string"==typeof x&&kt.renderUtil.addClass(m,x)}if(kt.renderUtil.attributeToElement(a.attr,m),f.value===e&&(m.checked=!0,kt.renderUtil.addClass(h,"checked"),s=!0),f.hasOwnProperty("html"))v.innerHTML=f.html;else{var y=document.createTextNode(f.hasOwnProperty("text")?f.text:f.value);v.appendChild(y)}h.appendChild(m),h.appendChild(v),l.appendChild(h)}return!s&&p&&u&&(p.checked=!0,kt.renderUtil.addClass(u,"checked")),l},editedValue:function(e,t,a,n,r){for(var o=e.getElementsByTagName("input"),l=0,i=o.length;l<i;l++)if(o[l].checked)return o[l].value;return""},toggle:function(e,t,a,n,r){for(var o=e.getElementsByTagName("input"),l=e.getElementsByTagName("label"),i=0,d=0,s=l.length;d<s;d++)kt.renderUtil.removeClass(l[d],"checked");for(var d=0,s=o.length;d<s;d++)if(o[d].checked){i=d;break}i+=1,i>=o.length&&(i=0),o[i].checked=!0,kt.renderUtil.addClass(o[i].parentNode,"checked")}},kt.defaultOption.renderMapping.checkbox={renderer:function(e,t,a,n,r){var l=document.createElement("label");kt.renderUtil.addDefaultInputWrapperClass(l,"checkbox");var i=document.createElement("input");if(i.type="checkbox",i.name=(r.option.editableNameWithKey?n.key:null)||o(),kt.renderUtil.addDefaultRendererClass(i),a.readonly&&(i.disabled=!0,l.className+=" disabled"),a.styleclass){var d=a.styleclass;"function"==typeof d&&(d=d.call(r,e,t,a,n,r)||!1),"string"==typeof d&&kt.renderUtil.addClass(i,d)}var s=kt.renderUtil.renderRuleToArray(e,t,a,n,r);if(s&&s.length)for(var p=0,u=s.length;p<u;p++){var c=kt.renderUtil.normalizeRuleObject(s[p],r);c.checked&&c.value===e&&(i.checked=!0,kt.renderUtil.addClass(l,"checked")),c.checked===!0?i.setAttribute("data-checked-value",c.value):c.checked===!1&&i.setAttribute("data-unchecked-value",c.value)}return l.appendChild(i),l},editedValue:function(e,t,a,n,r){var o=e.getElementsByTagName("INPUT")[0];return o.getAttribute(o.checked?"data-checked-value":"data-unchecked-value")||""},toggle:function(e,t,a,n,r){var o=e.getElementsByTagName("input")[0];o.checked=!o.checked,kt.renderUtil[o.checked?"addClass":"removeClass"](o.parentNode,"checked")}},kt.defaultOption.renderMapping.href={renderer:function(e,t,a,n,r){var o=document.createElement("a");if(kt.renderUtil.addDefaultRendererClass(o),kt.renderUtil.attributeToElement(a.attr,o),o.value=e,o.href=e||"#",o.text=a.text||e,a.styleclass){var l=a.styleclass;"function"==typeof l&&(l=l.call(r,e,t,a,n,r)||!1),"string"==typeof l&&kt.renderUtil.addClass(o,l)}return o}},kt.defaultOption.renderMapping.textarea={renderer:function(e,t,a,n,r){var l=document.createElement("textarea");kt.renderUtil.addDefaultRendererClass(l);if(kt.renderUtil.attributeToElement(a.attr,l),l.value=e,l.name=(r.option.editableNameWithKey?n.key:null)||o(),a.readonly&&(l.setAttribute("readonly",""),l.className+=" disabled"),a.styleclass){var i=a.styleclass;"function"==typeof i&&(i=i.call(r,e,t,a,n,r)||!1),"string"==typeof i&&kt.renderUtil.addClass(l,i)}return l},editedValue:function(e,t,a,n,r){return e.getElementsByTagName("TEXTAREA")[0].value}},kt.regex={inputControls:/^(?:input|select|textarea|button)$/i,caretAvailableType:/^(?:text|search|url|tel|password)$/i},kt.__compatMap={cellInlineEditOption:{startEvent:["cellInlineEditStartEvent","dblclick"],focusMoveAtEditEnd:["cellInlineEditEndFocusMove",!0],allowStartEditWithInvalid:["allowStartCellInlineEditWithInvalid",!0],endEditByOtherAreaClick:["cellInlineEditEndOtherThanBodycell",!0]},rowInlineEditOption:{startEvent:["rowInlineEditStartEvent","dblclick"],endAllEditing:["rowInlineEditEndAll",!1],endEditByEnter:["disableRowInlineEditEnterEnd",!1,function(e){return!e}],disableEvent:["disableRowInlineEditEvent",!1]}},kt.__compatOldOptionMap={},e.each(kt.__compatMap,function(t,a){e.each(a,function(e,a){var n=a[0],r={};r.moduleName=t,r.newOptionName=e,r.compatMap=a,kt.__compatOldOptionMap[n]=r})}),xt.on("gridInit",function(){return w()}),kt.setup=function(e){e&&d(e)&&(kt.commonOption=S(kt.commonOption||{definition:{},preConstructor:null,postConstructor:null},e))},kt.clearSetup=function(){delete kt.commonOption,kt.commonOption={definition:{},preConstructor:null,postConstructor:null}},kt.define=function(e,t){if("string"==typeof e&&void 0!==t)kt.commonOption.definition[e]=t;else if(e&&d(e))for(k in e)if(e.hasOwnProperty(k)){var a=e[k];"string"==typeof k&&void 0!==a&&(kt.commonOption.definition[k]=a)}},kt.undefine=function(e){delete kt.commonOption.definition[e]},kt.undefineAll=function(){delete kt.commonOption.definition,kt.commonOption.definition={}},kt.definition=function(e){return kt.commonOption.definition[e]},kt.run=function(e,t){var a=kt.instances[e];if(a){var n=Array.prototype.slice.call(arguments,2);return a[t].apply(a,n)}},kt.prototype._version=function(){return this.version},kt.prototype.readOption=function(){return this.option},kt.prototype.updateOption=function(a){function n(t,a){if(a.hidden===!0)null==t.state.hiddenColumnIndexToMapping[a.columnIndex]?(e.inArray(a.columnIndex,t.state.hiddenColumnIdxArr)===-1&&(t.option.hiddenColumnOrderList.push(a.columnIndex),t.state.hiddenColumnIdxArr.push(a.columnIndex)),t.state.hiddenColumnIndexToMapping[a.columnIndex]=a):e.inArray(a.columnIndex,t.state.hiddenColumnIdxArr)===-1?(t.option.hiddenColumnOrderList.push(a.columnIndex),t.state.hiddenColumnIdxArr.push(a.columnIndex),t.state.hiddenColumnIndexToMapping[a.columnIndex]=a):t.state.hiddenColumnIndexToMapping[a.columnIndex].id!==a.id&&(t.state.hiddenColumnIndexToMapping[a.columnIndex]=a);else if((null==a.hidden||a.hidden===!1||"conceal"===a.hidden)&&(null!=a.hidden&&"conceal"!==a.hidden&&(a.hidden=!1),null!=t.state.hiddenColumnIndexToMapping[a.columnIndex])){var n=e.inArray(a.columnIndex,t.state.hiddenColumnIdxArr);n!==-1&&(t.option.hiddenColumnOrderList.splice(n,1),t.state.hiddenColumnIdxArr.splice(n,1)),delete t.state.hiddenColumnIndexToMapping[a.columnIndex]}}function r(t,a,n){var r={};if(r.mapping=e.extend(!0,{},n),r.columnIndex=t,r.toColumnIndex=a,r.groupMappingList=[],r.groupColumnIndexes=[],r.visibleIndex=ne[t],r.isGroup=!0,r.colspan=0,o.option.enableHeaderGroupResizing===!0){for(var l=[],i=t;i<=a;i++){var d=o.state.columnIndexToMapping[i];d&&d.columnIndex>=0&&xe(d)&&d.resizing&&l.push(d.columnIndex)}l.length&&(r.mapping.resizing=l)}for(var i=t;i<=a;i++){var d=o.state.columnIndexToMapping[i];d&&d.columnIndex>=0&&xe(d)&&(r.colspan+=1,r.groupMappingList.push(d),r.groupColumnIndexes.push(i),n.hideSubTitle===!0&&(ee[d.columnIndex]=[]),ee[d.columnIndex].unshift(r))}var s=e.extend(!0,{groupMappingList:r.groupMappingList,groupColumnIndexes:r.groupColumnIndexes},n);o.state.headerGroupArr.push(s),o.state.headerGroupById[n.id]=s,null!==n.key&&void 0!==n.key&&(o.state.headerGroupByKey[n.key]=s)}var o=this,l=o.option;o.$wrapper,o.$pager,o.$title,o.$columnhiddenarea,o.$root;if(T(o,a)){l=o.option=e.extend(!0,{},o.option,a?a:{});for(var i=["columnMapping","headerGroup","instantInlineEditType","contextMenu"],p=0;p<i.length;p++){var c=i[p];a&&a.hasOwnProperty(c)&&(l[c]=e.extend(!0,[],a[c]))}a&&a.hasOwnProperty("footer")&&(l.footer=e.extend({},l.footer,a.footer))}else E(o,a),l=o.option;d(a)&&((a.rowPadding||a.rowpadding)&&(o.option.rowPadding=a.rowPadding||a.rowpadding),o.state.fitTableWidthFixed===!0&&(a.columnMapping||a.fitTableWidth)&&(o.state.fitTableWidthFixed=!1),a.cellCache&&a.cellCache.enabled===!1&&o._clearCellCache());var g=o._getGridOptionHeightValue(),f=o._getGridOptionWidthValue();if(o.state.gridOptionHeight=g,o.state.gridOptionWidth=f,"content"===g&&(o.option.rowFixShowFrom=null),"content"===f&&(o.option.columnFixShowFrom=null),o.option.columnMapping){o.state.keyMappedToMultipleColumn=!1,o.state.columnMappedKey={},o.state.columnIndexToKeyMap={},o.state.columnKeyToIndexMap={},o.state.columnIndexToMapping={},o.state.columnIdToMapping={},o.state.columnKeyToMapping={},o.state.columnMappingMapById={},o.state.multiColumnList=[],o.state.groupingColumnIndexToKey={},o.state.groupingColumnIndexToMapping={},o.state.hiddenColumnIdxArr=[];var h=!1;null==o.state.hiddenColumnIndexToMapping?(h=!0,o.state.hiddenColumnIndexToMapping={}):null!=o.option.hiddenColumnOrderList&&0===o.option.hiddenColumnOrderList.length&&(h=!0,o.state.hiddenColumnIndexToMapping={});for(var m=0,v=o.option.columnMapping.length;m<v;m++){var x=o.option.columnMapping[m];if(x.extend&&!x.extended){var y=x.extend;e.isArray(y)||(y=[y]);for(var C={},I=0,_=y.length;I<_;I++){var w=kt.commonOption.definition[y[I]];w&&"object"==typeof w&&(C=e.extend(!0,C,w))}C=e.extend(!0,C,x),C.extended=!0,o.option.columnMapping[m]=C}}if(null!==o.option.grouping&&void 0!==o.option.grouping&&o.option.grouping.useGroupColumnRearrange===!0){var b=o.option.grouping.by;if(o.option.autoColumnIndex===!0)for(var M,S,m=0,D=b.length;m<D;m++){M=b[m];for(var R=0,F=o.option.columnMapping.length;R<F;R++)if(S=o.option.columnMapping[R],S.key===M){var k=o.option.columnMapping.splice(R,1);o.option.columnMapping.splice(m,0,k[0])}}else{o.option.columnMapping.sort(function(e,t){var a=u(e.columnIndex)?Number(e.columnIndex):1/0,n=u(t.columnIndex)?Number(t.columnIndex):1/0;return a>n?1:a<n?-1:0}),o.state.columnIndexArrOrderMap={},o.state.columnIndexArr=[];for(var S,m=0,v=o.option.columnMapping.length;m<v;m++)S=o.option.columnMapping[m],o.state.columnIndexArrOrderMap[S.columnIndex]=o.state.columnIndexArr.length,o.state.columnIndexArr.push(S.columnIndex);for(var M,m=0,D=b.length;m<D;m++){M=b[m];for(var R=0,F=o.option.columnMapping.length;R<F;R++)if(S=o.option.columnMapping[R],S.key===M){var k=o.option.columnMapping.splice(R,1);o.option.columnMapping.splice(m,0,k[0])}}for(var m=0,v=o.option.columnMapping.length;m<v;m++)S=o.option.columnMapping[m],S.columnIndex=o.state.columnIndexArr[m]}}o.state.columnIdUniqueNumber=o.state.columnIdUniqueNumber||0;for(var L=0;L<o.option.columnMapping.length;L++){var x=o.option.columnMapping[L];if(o.option.autoColumnIndex===!0&&(x.columnIndex=parseInt(L)),x.hasOwnProperty("key")){if(o.state.columnMappedKey[x.key]=!0,o.state.columnKeyToIndexMap.hasOwnProperty(x.key)){if(o.state.keyMappedToMultipleColumn=o.state.keyMappedToMultipleColumn||{},o.state.keyMappedToMultipleColumn[x.key]=o.state.keyMappedToMultipleColumn[x.key]||[],0===o.state.keyMappedToMultipleColumn[x.key].length){var A=o.state.columnIndexToMapping[o.state.columnKeyToIndexMap[x.key]];o.state.keyMappedToMultipleColumn[x.key].push(A)}o.state.keyMappedToMultipleColumn[x.key].push(x)}o.state.columnKeyToIndexMap[x.key]=parseInt(x.columnIndex),o.state.columnKeyToMapping[x.key]=x;
}if(x.multi&&x.multi.length)for(var O=0,P=x.multi.length;O<P;O++){var B=x.multi[O];B&&B.key&&(o.state.columnMappedKey[B.key]=!0,o.state.columnKeyToIndexMap[B.key]=parseInt(x.columnIndex))}if(x.hasOwnProperty("columnIndex")&&(o.state.columnIndexToKeyMap[x.columnIndex]=String(x.key),o.state.columnIndexToMapping[x.columnIndex]=x),x.id=x.id||"col"+o.state.columnIdUniqueNumber++,o.state.columnIdToMapping[x.id]=x,o.state.columnMappingMapById.hasOwnProperty(x.id)){for(var G=1;o.state.columnMappingMapById.hasOwnProperty(x.id+"_"+G);)G++;x.id+="_"+G}o.state.columnMappingMapById[x.id]=x,x.multi&&o.state.multiColumnList.push(x)}if(null!==o.option.grouping&&void 0!==o.option.grouping&&o.option.grouping.useGroupColumnRearrange===!0)for(var M,S,b=o.option.grouping.by,m=0,v=b.length;m<v;m++)S=o.option.columnMapping[m],M=b[m],o.state.groupingColumnIndexToKey[S.columnIndex]=M,o.state.groupingColumnIndexToMapping[S.columnIndex]=S;else o.option.columnMapping.sort(function(e,t){var a=u(e.columnIndex)?Number(e.columnIndex):1/0,n=u(t.columnIndex)?Number(t.columnIndex):1/0;return a>n?1:a<n?-1:0});var H=-1,N=Number.POSITIVE_INFINITY;o.state.hasSelectorColumn=!1,o.state.hasRowindexColumn=!1,o.state.hasColumnFoldingColumn=!1,o.state.dataCompositorMap=[],o.state.dataKeyList=[],o.state.hasColspan=!1,o.state.hasMappingAllowEdit=null,o.state.hasRowAllowEdit=!!o.option.rowOption&&s(o.option.rowOption.allowEdit),o.state.visibleColumnMappingList=[],o.state.visibleColumnMappingSignature="",o.state.visibleColumnIndexArr=[],o.state.visibleIndexMapByColumnIndex={},o.state.visibleIndexMapByKey={};var $=!1;if(o.state.hasLeftColspanMapByColumnIndex={},o.state.hiddenColumnDraging!==!0&&(o.state.showColCalled===!1||null==o.state.showColCalled)||o.state.showColCalled!==!0&&(o.state.hiddenColumnDraging===!1||null==o.state.hiddenColumnDraging))for(var m=0,v=o.option.columnMapping.length;m<v;m++){var x=o.option.columnMapping[m];if(x.columnFoldingColumn){var W=e.type(x.columnFoldingColumn),K=null,U=null,Y=null;if("array"===W?(K=x.columnFoldingColumn[0],U=x.columnFoldingColumn[1]):"object"===W&&(K=x.columnFoldingColumn.fromIndex,U=x.columnFoldingColumn.toIndex,Y=x.columnFoldingColumn.exceptionColList),"string"==typeof K&&(K=o.state.columnKeyToIndexMap[K]),"string"==typeof U&&(U=o.state.columnKeyToIndexMap[U]),x.columnFolded){var V=!0;null!=x.columnFoldingHiddenType&&(V=x.columnFoldingHiddenType),null!=K&&null!=U&&o._hideAllColumnBetween(K,U,Y,V)}else null!=K&&null!=U&&o._showAllColumnBetween(K,U,Y)}}o.state.hasMappingRefreshBy=!1,o._columnIndexKeyToIndexArray(o.option.hiddenColumnOrderList,o.state.hiddenColumnIdxArr);for(var L=0;L<o.option.columnMapping.length;L++){var x=o.option.columnMapping[L];d(o.option.defaultColumnMapping)&&e.each(o.option.defaultColumnMapping,function(t,a){x.hasOwnProperty(t)?d(x[t])&&d(a)&&(x[t]=e.extend({},a,x[t])):x[t]=d(a)?e.extend({},a):a}),x.hasOwnProperty("columnIndex")&&(H=Math.max(H,x.columnIndex||0),N=Math.min(N,x.columnIndex)),x.hasOwnProperty("key")&&(o.state.dataKeyList.push(x.key),x.hasOwnProperty("value")&&u(x.key)&&u(x.value)&&o.state.dataCompositorMap.push(x)),x.hasOwnProperty("refreshBy")&&(o.state.hasMappingRefreshBy=!0),x.columnFoldingColumn&&(o.state.hasColumnFoldingColumn=!0),(x.colspan||x.colspanTo)&&(o.state.hasColspan=!0,$=!0),x.editable&&o._isSpecialPurposeColumn(x)&&(x.editable=!1),x.selectorColumn&&(o.state.hasSelectorColumn=o.state.hasSelectorColumn||[],o.state.hasSelectorColumn.push(x)),x.rowindexColumn&&(o.state.hasRowindexColumn=!0),x.hasOwnProperty("allowEdit")&&(o.state.hasMappingAllowEdit=o.state.hasMappingAllowEdit||[],o.state.hasMappingAllowEdit.push(x)),h?o.option.hiddenColumnOrderList&&o.option.hiddenColumnOrderList.length>0&&e.inArray(x.columnIndex,o.state.hiddenColumnIdxArr)!==-1?(x.hidden=!0,o.state.hiddenColumnIndexToMapping[x.columnIndex]=x):n(o,x):(null!=a&&a.hasOwnProperty("hiddenColumnOrderList")===!0&&o.option.hiddenColumnOrderList&&o.option.hiddenColumnOrderList.length>0&&e.inArray(x.columnIndex,o.state.hiddenColumnIdxArr)!==-1&&(x.hidden=!0),n(o,x)),x&&xe(x)&&(o.state.visibleColumnMappingList.push(x),o.state.visibleColumnIndexArr.push(x.columnIndex),o.state.hasLeftColspanMapByColumnIndex[x.columnIndex]=$,o.state.visibleColumnMappingSignature+=x.id)}var X=-1,z=0,j=[],q=0;o._columnShowFromEnabled()&&(o._limitRenderFromByFixCount(),q=o.state.columnFixShowFromColumnIndex||0);for(var L=0;L<o.option.columnMapping.length;L++){var x=o.option.columnMapping[L];if(null!=x.columnIndex&&x.hidden!==!0&&"conceal"!==x.hidden&&!(x.columnIndex<q)){if("number"==typeof o.option.columnFixUpto)x.fixed=x.columnIndex<=o.option.columnFixUpto;else if("unfix"===o.option.columnFixUpto)x.fixed=!1;else if("string"==typeof o.option.columnFixUpto){var Z=o._getColumnByKey(o.option.columnFixUpto);Z&&(x.fixed=x.columnIndex<=Z.columnIndex)}if(!x.fixed)break;X=x.columnIndex,z+=parseInt(x.width),j.push(x)}}if("unfix"===o.option.columnFixUpto&&delete o.option.columnFixUpto,o.state.fixupto=X,o.state.fixedColumnWidth=z,o.state.fixedColumnMapping=j,o.state.groupingKeyMap={},o.option.grouping&&o.option.grouping.useGrouping&&o.option.grouping.by)for(var m=0,v=o.option.grouping.by.length;m<v;m++)o.state.groupingKeyMap[o.option.grouping.by[m]]=m;for(var Q=0;Q<o.state.visibleColumnMappingList.length;Q++){var x=o.state.visibleColumnMappingList[Q];o.state.visibleIndexMapByColumnIndex[x.columnIndex]=Q,o.state.visibleIndexMapByKey[x.key]=Q}o.state.visibleColumnCount=o.state.visibleColumnMappingList.length,o._generateFilterColumnList(),o._calculateColumnWidthProperty();for(var J=o.state.visibleColumnMappingList,ee=(o.state.visibleColumnCount,{}),te=!1,ae=o.state.fixupto,ne=o.state.visibleIndexMapByColumnIndex,re=0,oe=0,le=J.length;oe<le;oe++){var x=J[oe],ie={};ie.mapping=x,ie.columnIndex=x.columnIndex,ie.visibleIndex=oe,ie.isGroup=!1,ee[x.columnIndex]=[ie]}if(o.state.headerGroupById={},o.state.headerGroupByKey={},o.state.headerGroupArr=[],o.state.headerGroupIdUniqueNumber=o.state.headerGroupIdUniqueNumber||0,o.option.headerGroup&&o.option.headerGroup.length)for(var m=o.option.headerGroup.length-1;m>=0;m--){var de=o.option.headerGroup[m];if(null!=de){null!==de.id&&void 0!==de.id||(de.id=o.state.headerGroupIdUniqueNumber++);var se=null,pe=null;if(!de)continue;if("number"==typeof de.fromIndex)se=parseInt(de.fromIndex);else if("string"==typeof de.fromIndex){var ue=o._getColumnByKey(de.fromIndex);ue&&(se=ue.columnIndex)}if("number"==typeof de.toIndex)pe=parseInt(de.toIndex);else if("string"==typeof de.toIndex){var ce=o._getColumnByKey(de.toIndex);ce&&(pe=ce.columnIndex)}if(null!=se&&null!=pe){var ge=o._columnIndexOrder(ae)+1,fe=o.state.columnIndexArr[ge];ae>=se&&ae<pe?(r(se,ae,de),r(fe,pe,de)):r(se,pe,de)}else de.hideSubTitle===!0&&(te=!0)}}for(var c in ee){var he=ee[c];te&&he.splice(1,he.length-1),re=Math.max(he.length,re)}for(var c in ee){for(var he=ee[c],me=he.length-1;me>=0;me--){var ie=he[me];if(ie.mapping&&ie.mapping.rowspan){ie.rowspan=parseInt(ie.mapping.rowspan);for(var ve=0,ye=ie.rowspan-1;ve<ye;ve++)he.splice(me+1,0,null)}}re=Math.max(he.length,re)}for(var c in ee){var he=ee[c];if(he.length<re){var Ce=he[he.length-1];if(!Ce){for(var Ie=0,m=re-1;m>=0;m--){if(he[m]){he[m].rowspan=Ie+1;break}Ie++,he[m]=null}continue}for(var _e=0,m=0,v=he.length;m<v-1&&m<re;m++)he[m]&&(_e+=parseInt(he[m].rowspan||1));Ce.rowspan=Math.min(re,re-_e);for(var me=1;me<Ce.rowspan;me++)he.push(null)}}for(var c in ee)for(var he=ee[c],we=!0,m=he.length-1;m>=0;m--)he[m]&&(we===!1&&(he[m].disableResizing=!0),he[m]&&he[m].mapping&&he[m].mapping.resizing&&(we=!1));if(o.state.headerDepth=re,o.option.filteringHeader){for(var c in ee){var he=ee[c],ie={filter:!0,columnIndex:parseInt(c)};he.push(ie)}re+=1}o.state.columnHeaderDepth=re,o.state.columnHeaderStackMap=ee;var be=e('<div class="'+pt+'"><div class="wrapper"></div></div>'),Me=e('<div class="alopexgrid-cell cell bodycell" style="top:-999px;left:-999px;">&nbsp;</div>'),Se=e('<div class="alopexgrid-cell cell headercell" style="top:-999px;left:-999px;">&nbsp;</div>');o.$root.is(":visible")?o.$wrapper.append(Me,Se):(be.css("position","absolute").css("top","-9999px").css("left","-9999px").appendTo(document.body),be.children().append(Me,Se)),o.state.rowHeight=(o.option.rowOption&&e.isNumeric(o.option.rowOption.defaultHeight)?o.option.rowOption.defaultHeight:0)||Me.outerHeight(),o.state.headerRowHeight=Se.outerHeight(),Me.remove(),Se.remove(),be.remove(),o.state.emptyData={_index:{},_state:{}};for(var me=0,Te=o.state.dataKeyList.length;me<Te;me++){var R=o.state.dataKeyList[me];o.state.emptyData[R]="",o.option.tree&&o.option.tree.useTree&&(o.option.tree.idKey===R?o.state.emptyData[R]=o.option.tree.initialIdValue:o.option.tree.parentIdKey===R&&(o.state.emptyData[R]=o.option.tree.rootNodeParentIdValue))}for(var De=[],m=0,v=o.option.columnMapping.length;m<v;m++){var x=o.option.columnMapping[m];x.hasOwnProperty("columnIndex")&&x.key&&x.editable&&De.push(x.columnIndex+':(data.hasOwnProperty("'+x.key+'")?data["'+x.key+'"]:"")')}o.state.getEditingAllState=new Function("data","return {"+De.join(",")+"};"),o.state.dataCompositor=null,o.state.dataCompositorMap.length&&(o.state.dataCompositor=function(e,t){for(var a in e.state.dataCompositorMap){var n=e.state.dataCompositorMap[a];t[n.key]=s(n.value)?n.value(t[n.key],t,n):n.value}return t});var Re={};e.each(o.option.columnMapping,function(e,a){var n=!(!a||!a.hasOwnProperty("defaultValue"));n&&(Re[a.id]=!!s(a.defaultValue)||t)});var Fe=o.option.fillUndefinedKey!==!1,ke=Fe||!e.isEmptyObject(Re),Le=o.option.trimUnmappedKey;o.state.dataFilltrimmer=null;var Ae=e.isArray(Le),Oe={_state:!0,_index:!0,_key:!0,_edited:!0};(Le||ke)&&(o.state.dataFilltrimmer=function(t,a){if(ke)for(var n=0,r=t.option.columnMapping.length;n<r;n++){var o=t.option.columnMapping[n],l=o.key;l&&null==a[l]&&(Re[o.id]&&(a[l]=Re[o.id]===!0?o.defaultValue(a):o.defaultValue),Fe&&null==a[l]&&(a[l]=t.option.fillUndefinedKey===!0?"":t.option.fillUndefinedKey))}if(Le)for(var i in a)a.hasOwnProperty(i)&&!Oe[i]&&(Ae&&e.inArray(i,Le)>=0||t.state.columnMappedKey[i]||delete a[i])}),o.state.minColumnIndex=N,o.state.maxColumnIndex=H}if(o.state.rowHeightMapByDataId=o.state.rowHeightMapByDataId||{},o.state.testRowAllowSelect=!(!o.option.rowOption||!s(o.option.rowOption.allowSelect)),o.state.testRowAllowPaste=!1,o.option.rowOption&&null!=o.option.rowOption.allowPaste&&(o.state.testRowAllowPaste=e.type(o.option.rowOption.allowPaste)),o.state.renderRuleKeyNormalizeMap={text:"text",value:"value",html:"html",checked:"checked"},o.option.renderRuleOption)for(var c in o.option.renderRuleOption)"textKey"===c&&(o.state.renderRuleKeyNormalizeMap[o.option.renderRuleOption[c]]="text"),"valueKey"===c&&(o.state.renderRuleKeyNormalizeMap[o.option.renderRuleOption[c]]="value"),"htmlKey"===c&&(o.state.renderRuleKeyNormalizeMap[o.option.renderRuleOption[c]]="html"),"checkedKey"===c&&(o.state.renderRuleKeyNormalizeMap[o.option.renderRuleOption[c]]="checked");if(o.option.tree&&o.option.tree.useTree?(o.state.treeOption={},o.state.treeOption.expandedValue=o.option.tree.expandedValue||kt.defaultOption.tree.expandedValue,o.state.treeOption.leafValue=o.option.tree.leafValue||kt.defaultOption.tree.leafValue,o.state.treeOption.initialExpandedValue=o.option.tree.hasOwnProperty("initialExpandedValue")?o.option.tree.initialExpandedValue:kt.defaultOption.tree.initialExpandedValue,o.state.treeOption.depthStartValue=o.option.tree.depthStartValue||0):delete o.state.treeOption,o.state.cellCacheEnabled=!(!o.option.cellCache||!o.option.cellCache.enabled),o.state.rowSingleSelect=!("only"!==o.option.rowClickSelect&&!o.option.rowSingleSelect),e.isArray(o.option.data)){var Pe=o.option.data;o.option.data=null,o.dataSet(Pe,!0)}o.option.cellSelectable||o.option.enableHeaderSelect||o.state.hasRowindexColumn||o.option.disableTextSelection?o.$wrapper.addClass("text-selection-disabled").attr("unselectable","on"):o.$wrapper.removeClass("text-selection-disabled").removeAttr("unselectable"),a&&a.disableFocusedState===!1&&o._rowUnfocusAll(),o.option.cellInlineEdit&&(o.option.rowInlineEdit=!1);var Be=!1;a&&(a.grouping&&(Be=!0),a.tree&&(Be=!0)),o.state.sortingRequired&&(Be=!0),Be&&(o._sortInternalData(),o.state.sortingRequired=!1),o._generateRenderTargetData(),o.state.renderingSuppressed||(lt(o),Ee(o),o.viewUpdate(!0)),o.viewEventUpdate();for(var m=0,v=kt.plugin.length;m<v;m++){var Ge=kt.plugin[m];s(Ge)&&Ge.call(o,o,o.option,o.state)}},kt.prototype._getColumnByKey=function(e){return this.state.columnKeyToMapping[e]||this.state.columnMappingMapById[e]||null},kt.prototype._columnIndexKeyToMappingList=function(t){var a=this,n=t;if("string"==typeof t){var r=[];if(a.state.keyMappedToMultipleColumn&&a.state.keyMappedToMultipleColumn[t])r=r.concat(a.state.keyMappedToMultipleColumn[t]);else{var o=a._getColumnByKey(t);r=r.concat(o?[o]:[])}if(!a.option.disableMultiMappingGet&&a.state.multiColumnList.length)for(var l=[],i=0,d=a.state.multiColumnList.length;i<d;i++){var s=a.state.multiColumnList[i],p=s.multi;if(e.isArray(p))for(var u=0,c=p.length;u<c;u++){var g=p[u];g&&(g.key!==t&&g.id!==t&&g.columnIndex!==t||r.push(g))}}return r}if(e.isArray(t)){for(var l=[],i=0,d=t.length;i<d;i++)l=l.concat(a._columnIndexKeyToMappingList(t[i]));return l}return null===n||void 0===n?[].concat(a.option.columnMapping):a.state.columnIndexToMapping[n]?[a.state.columnIndexToMapping[n]]:[]},kt.prototype.updateColumn=function(t,a){if(null==a&&(a=[]),u(t)){var n=this,r=[];if(s(t)||s(a)){var o=s(t)?t:a;if(1===arguments.length)r=n._columnIndexKeyToMappingList();else if("string"==typeof a||"number"==typeof a)r=n._columnIndexKeyToMappingList(a);else if(e.isArray(a)&&a.length)for(var l=0,i=a.length;l<i;l++){var p=n._columnIndexKeyToMappingList(a[l]);r=r.concat(p)}for(var c=0;c<r.length;c++)o.call(n,r[c]);return n.state.sortingRequired=!0,void n.updateOption()}var g=e.isArray(t);if(g&&e.isArray(a)&&t.length&&t.length===a.length){for(var l=0,i=a.length;l<i;l++)if(d(t[l]))for(var r=n._columnIndexKeyToMappingList(a[l]),f=0,h=r.length;f<h;f++)e.extend(r[f],t[l]);return void n.updateOption()}if(d(t)&&!e.isEmptyObject(t)){e.isArray(a)?0===a.length&&(r=n._columnIndexKeyToMappingList()):a=[a];for(var l=0,i=a.length;l<i;l++){var p=n._columnIndexKeyToMappingList(a[l]);r=r.concat(p)}if(r&&r.length){for(var c=0;c<r.length;c++){var m=r[c];m&&e.extend(m,t)}n.updateOption()}}}},kt.prototype.updateColumnMapping=function(e,t){return this.updateColumn(t,e)},kt.prototype._processDefaultSorting=function(){var t=this;t.option.defaultSorting&&(e.isArray(t.option.defaultSorting)?t.state.sortingInfo=t._generateSortingInfo(t.option.defaultSorting):d(t.option.defaultSorting)&&(t.state.sortingInfo=t._generateSortingInfo(t.option.defaultSorting.sortingColumn,t.option.defaultSorting.sortingDirection)))},kt.prototype.viewInit=function(t){var a=this;e(a.root).addClass(pt).html(kt.renderUtil.generateHTMLString(kt.markup))},kt.prototype._getGridOptionHeightValue=function(){var t=this.option.height;return s(t)&&(t=t.call(this,this.$root.get(0))),e.isNumeric(t)?t=parseInt(t):null==t||t===!1?t="content":"string"==typeof t&&"px"===t.slice(-2).toLowerCase()&&e.isNumeric(t.slice(0,-2))&&(t=parseInt(t.slice(0,-2))),t},kt.prototype._getGridOptionWidthValue=function(){var t=this.option.width;return s(t)&&(t=t.call(this,this.$root.get(0))),e.isNumeric(t)?t=parseInt(t):null==t||t===!1?t="parent":"string"==typeof t&&"px"===t.slice(-2).toLowerCase()&&e.isNumeric(t.slice(0,-2))&&(t=parseInt(t.slice(0,-2))),t},kt.prototype._viewUpdate=function(t){var a=this;if(a.state&&!a.state.renderingSuppressed){var n=a._getGridOptionHeightValue(),r=a._getGridOptionWidthValue();a.state.gridOptionHeight=n,a.state.gridOptionWidth=r,a.$title.off(".alopexgridTitleViewEvent");var o=!1;if(null!=a.option.title&&a.option.title!==!1){o=!0;var l=a.option.title;l===!0&&(l=""),"function"==typeof l&&(l=l.call(a)),"number"!=typeof l&&"string"!=typeof l||a.$titlelabel.text(l);var i=a.option.titleMarkup;"function"==typeof i&&(i=i.call(a)),i?a.$titleMarkup.html(i):a.$titleMarkup.html(""),a.option.hideGridFoldingButton?a.$titleFolding.hide():a.$titleFolding.show(),a.$title.on("click.alopexgridTitleViewEvent",".table-toggle",{self:a},function(t){var a=t.data.self;if(a.$root.hasClass("folded")){a.$root.removeClass("folded");var n=a.$root.data("data-prev-height");a.$root.removeData("data-prev-height"),a.$root.animate({height:n+"px"},function(){var t=a._getGridOptionHeightValue();t||e(this).css({height:""}),a.viewUpdate()})}else a.$root.addClass("folded"),a.$root.data("data-prev-height",a.$root.height()),a.$root.animate({height:a.$title.height()+"px"})}),a.$title.show()}else a.$title.hide();if(!o||!a.$root.hasClass("folded")){if(a.$columnhiddenarea[a.option&&a.option.hiddenColumnArea?"show":"hide"](),a.option&&a.option.hiddenColumnArea){var d=a.option.hiddenColumnArea;d&&a.$columnhiddenarea.find(".columnhiddenarea-label").text("string"==typeof a.option.hiddenColumnArea?a.option.hiddenColumnArea:"");var s=a.$columnhiddenarea.children().length;if(s>1&&a.$columnhiddenarea.find(".headercell").remove(),a.option.hiddenColumnOrderList&&a.option.hiddenColumnOrderList.length>0){a.$columnhiddenarea.find(".columnhiddenarea-label").hide();for(var p,u,c,g,f,h=0,m=0,v=a.option.hiddenColumnOrderList.length;m<v;m++){if(p=a.state.hiddenColumnIdxArr[m],u=a.state.hiddenColumnIndexToMapping[p],c=e('<div class="headercell"></div>'),c.attr("data-alopexgrid-columnindex",u.columnIndex),0!==m&&(h+=e(a.$columnhiddenarea.find(".headercell")[m-1]).width()+10),c.css({left:h+"px"}),g=e('<div class="header-dragdrop-handle"></div>'),g.attr("data-alopexgrid-dragdropcolumnindex",u.columnIndex),g.attr("onmousedown",ut+".run('"+a.key+"','_hiddenHeaderDragStart',event,"+u.columnIndex+");"),g.attr("ontouchstart",ut+".run('"+a.key+"','_hiddenHeaderDragStart',event,"+u.columnIndex+");"),f=e('<span class="column-title"></span>'),null!==u.title&&void 0!==u.title&&"string"==typeof u.title)f.text(u.title.replace(/<br>/g,""));else if(u.selectorColumn===!0){var x=e('<div class="alopexgrid-input-wrapper alopexgrid-input-checkbox-wrapper"></div>'),y=e('<input type="checkbox" name="'+a.key+'"class="selector-checkbox selector-column-input">');x.append(y),f.append(x)}else if("function"==typeof u.title){var C=u.title.call(a,u);f.append(C)}u.headerDragDrop===!1?c.append(f):c.append(g,f),a.$columnhiddenarea.append(c)}}else a.$columnhiddenarea.find(".columnhiddenarea-label").show()}var I=a._usePager();a.$pager[I?"show":"hide"](),I&&a._refreshPagingUnit();var _=o?a.$title.outerHeight(!0):0,w=a.option.hiddenColumnArea?a.$columnhiddenarea.outerHeight(!0):0,b=a._usePager()?a.$pager.outerHeight(!0):0,M=_+w+b,S=0;if(a.option.header){for(var E=0;E<a.state.columnHeaderDepth-(a.option.filteringHeader?1:0);E++)S+=e.isArray(a.option.headerRowHeight)?a.option.headerRowHeight[E]:"number"==typeof a.option.headerRowHeight?a.option.headerRowHeight:a.state.headerRowHeight;a.option.filteringHeader&&(S+=e.isNumeric(a.option.filteringHeaderHeight)?parseInt(a.option.filteringHeaderHeight,10):a.state.headerRowHeight)}var T=0;if(a._hasFooter()&&(T=a.option.footerRowHeight||a.state.rowHeight),"content"===r&&(a.option.columnFixShowFrom=null),"content"===n&&(a.option.rowFixShowFrom=null),a._calculateColumnWidthProperty(),a.state.headerHeight=S,a.state.footerHeight=T,a.option.rowOption&&"content"===a.option.rowOption.defaultHeight&&a.$wrapper.is(":visible"))for(var D=0,v=a.state.data.length;D<v;D++){var R=a.state.data[D];null==a.state.rowHeightMapByDataId[R._index.id]&&a._setRowHeight(R,"content")}var F=a.option.alwaysShowVerticalScrollBar===!0,k=a.option.alwaysShowHorizontalScrollBar===!0,L=a.state.scrollbarxHeight=0,A=a.state.scrollbaryWidth=0,O=0,P=0,B=a.$root.outerHeight()-a.$root.height(),G=a.$root.outerWidth()-a.$root.width(),H=a.$wrapper.outerHeight()-a.$wrapper.height(),N=a.$wrapper.outerWidth()-a.$wrapper.width(),$="",W="",K="",U=a.state.renderTargetDataList.length||0,Y=a.__getAllRowHeight();if(!U&&a.option.message&&(a.option.message.nodata||null!=a.state.filteredDataList&&0===a.state.filteredDataList.length&&a.option.message.noFilteredData)){if(a.option.rowOption&&"number"==typeof a.option.rowOption.nodataRowHeight)a.state.nodataRowHeight=a.option.rowOption.nodataRowHeight;else{var V=document.createElement("div");V.className="cell emptycell nodata nodatacell",null!=a.state.filteredDataList&&0===a.state.filteredDataList.length&&(V.className+=" nofiltereddata"),a.$wrapper[0].appendChild(V),a.state.nodataRowHeight=e(V).outerHeight()||a.state.rowHeight,a.$wrapper[0].removeChild(V)}Y+=a.state.nodataRowHeight,U+=1}if(a.option.rowPadding){var X=a.option.rowPadding;X===!0&&a.option.paging&&a.option.paging.perPage&&(X=a.option.paging.perPage),U<X&&(Y+=(X-U)*a.state.rowHeight)}var z=Y+S+T,j=a.state.columnWidth;if(String(n).indexOf("row")>=0){var q="rowpadding"===n.toLowerCase()&&a.option.rowPadding?a.option.rowPadding:n.split("row")[0];if(e.isNumeric(q)){var Z=q*a.state.rowHeight;P=Z+S+T,K=P+H,$=K+M+B}else n="content"}if("number"==typeof n){$=n;var Q=n-B;K=Q-M,P=K-H}else"content"===n&&(P=z,K=P+H,$=K+M+B);"number"==typeof r?(W=r,O=W-G-N):"parent"===r?(a.$root.css("width",""),O=a.$root.width()-N):"content"===r&&(W=j+G+N,O=j),z>P&&(F=!0),j>O&&(k=!0);for(var J=null,ee=null,D=0,v=2;D<v;D++){var te=!1,ae=!1;J!==F&&F&&(te=!0),ee!==k&&k&&(ae=!0),J=F,ee=k,te&&(a.$scrollbary.css({width:"",overflow:""}),a.$scrollbarRightButton.css("right",""),a.state.scrollbaryWidth=A=a.$scrollbary.outerWidth(),"number"==typeof r||"parent"===r?O-=A:"content"===r&&(W+=A)),ae&&(a.$scrollbarx.css({height:"",overflow:""}),a.$scrollbarDownButton.css("bottom",""),a.state.scrollbarxHeight=L=a.$scrollbarx.outerHeight(),"number"==typeof n?P-=L:($+=L,K+=L)),z>P&&(F=!0),j>O&&(k=!0)}a.state.wrapperWidth=O,a.state.wrapperHeight=P,a.state.clientHeight=P-S-T,a.state.clientWidth=O,a.state.hasVerticalScrollbar=F,a.state.hasHorizontalScrollbar=k,F||(a.$scrollbary.css({width:"0px",overflow:"hidden"}),a.$scrollbarRightButton.css("right","0px")),k||(a.$scrollbarx.css({height:"0px",overflow:"hidden"}),a.$scrollbarDownButton.css("bottom","0px")),z<=P&&(a.state.renderFromRenderedIndex=0,a.option.rowFixShowFrom=null,a.state.scrollyEnd=!1),j<=O&&(a.state.renderFromColumnIndex=a.state.visibleColumnIndexArr[0]||0,a.state.scrollxEnd=!1),a.$root.css({width:W+(e.isNumeric(W)?"px":""),height:$+(e.isNumeric($)?"px":"")}),a.$wrapper.css("height",K+(e.isNumeric(K)?"px":"")),a.state.scrollbaryTrackTop=parseInt(a.$scrollbarUpButton.position().top+a.$scrollbarUpButton.outerHeight()),a.state.scrollbaryTrackBottom=parseInt(a.$scrollbarDownButton.position().top),a.state.scrollbaryTrackLength=parseInt(a.state.scrollbaryTrackBottom-a.state.scrollbaryTrackTop),a.state.scrollbarxTrackLeft=parseInt(a.$scrollbarLeftButton.position().left+a.$scrollbarLeftButton.outerWidth()),a.state.scrollbarxTrackRight=parseInt(a.$scrollbarRightButton.position().left),a.state.scrollbarxTrackLength=parseInt(a.state.scrollbarxTrackRight-a.state.scrollbarxTrackLeft),a._refreshScrollbar(),a._setScrollInfo(),a._refreshBoard(t===!0||{refreshGeometry:!0}),a._setProgressPosition()}}},kt.prototype.viewUpdate=function(e){return this._viewUpdate(e)},kt.prototype.getGeometry=function(){var e=this,t={},a=e.$root.offset(),n=e.$root.position();return t.offsetTop=a.top,t.offsetLeft=a.left,t.positionTop=n.top,t.positionLeft=n.left,t.gridWidth=e.$root.width(),t.gridHeight=e.$root.height(),t.clientWidth=e.$wrapper.innerWidth()-e.$scrollbary.outerWidth(),t.clientHeight=e.$wrapper.innerHeight()-e.$scrollbarx.outerHeight(),t},kt.prototype._generateRenderTargetMapping=function(){var e=this,t=0,a=[],n=[],r=!1;e._columnShowFromEnabled()&&(e._limitRenderFromByFixCount(),r=null!=e.state.columnFixShowFromColumnIndex);var o=e.state.renderFromColumnIndex,l=!!e.state.scrollxEnd,i=0,d=0,s=0;if(e.option.useContinuousXScroll){var p=e._getColumnIndexByBlankWidth(e.state.translateX,!0);p&&(s=Math.ceil(p))}for(var u=0,c=e.option.columnMapping.length;u<c;u++){var g=e.option.columnMapping[u];if(g&&parseInt(g.columnIndex)>=0&&g.hidden!==!0&&"conceal"!==g.hidden&&(g.columnIndex<=e.state.fixupto?r&&g.columnIndex<e.state.columnFixShowFromColumnIndex||(t+=parseInt(g.width),g.excludeFitWidth&&(d+=parseInt(g.width)),a.push(g),n.push(g),g.columnIndex<o&&i++):g.columnIndex>=o&&(i?i--:(t+=parseInt(g.width),g.excludeFitWidth&&(d+=parseInt(g.width)),a.push(g))),t>e.state.wrapperWidth+s&&!l))break}var f=1,h={},m=!(!e.option.fitTableWidth||e.state.fitTableWidthFixed);t&&m&&t<e.state.wrapperWidth&&(f=(e.state.wrapperWidth-d)/(t-d));for(var v=0,u=0,c=a.length;u<c;u++){var g=a[u],x=parseInt(g.width);f>1&&!g.excludeFitWidth&&(x=Math.round(parseInt(g.width)*f)),h[g.id]=x,v+=x}if(f>1&&v!==e.state.wrapperWidth){var y=parseInt(e.state.wrapperWidth-v);if(y)for(var C=parseInt(y/Math.abs(y)),u=a.length-1;y;){var g=a[u--];h[g.id]+=C,u<0&&(u=a.length-1),y-=C}}var I={};return I.renderTargetMapping=a,I.fixedRenderTargetMapping=n,I.renderTargetWidth=t,I.renderFitWidth=f>1?e.state.wrapperWidth:t,I.fitRatio=f,e.state.columnFitWidthById=I.columnWidthByIdMap=h,I},kt.prototype._refreshHeaderCells=function(t){var a=this,n=p(a.state.headerCellList),r=(a.state.visibleColumnMappingList,a.state.visibleColumnCount,a.state.visibleIndexMapByColumnIndex),l={};for(var i in a.state.columnHeaderStackMap)if(a.state.columnHeaderStackMap.hasOwnProperty(i)){var d=a.state.columnHeaderStackMap[i];e.isArray(d)?l[i]=[].concat(d):l[i]=d}a.state.fixupto;t=t===!0,t===!0&&delete a.state.refreshheadercell,a.state.refreshheadercell=a.state.refreshheadercell||{};var u=a.state.renderFromColumnIndex||0,c=a.state.refreshheadercell.prevRenderFrom,g=u,f=(a.state.wrapperWidth,a.state.scrollxEnd),h=0,m=[],v=[];if(a.option.header!==!1){var x=a.state.renderTargetMappingInfo;m=x.renderTargetMapping,v=x.fixedRenderTargetMapping,h=x.renderTargetWidth;var y=x.fitRatio,C=x.columnWidthByIdMap,I=a.state.visibleColumnMappingList[0],_=a.state.visibleColumnMappingList[a.state.visibleColumnMappingList.length-1];g=(m[Math.max(m.length-1,0)]||{}).columnIndex,h<=a.state.wrapperWidth&&(f=!1),!t&&a.option.fitTableWidth&&y!==a.state.refreshheadercell.fitRatio&&(t=!0);var w=-(f?h-a.state.wrapperWidth:0);if(!f&&a.option.useContinuousXScroll){var b=a._getColumnIndexByBlankWidth(a.state.translateX,!0);b&&(w=-Math.min(h-a.state.wrapperWidth,b))}for(var M=[0],S={},E={},T=0,D=m.length;T<D;T++){var R=m[T];E[R.columnIndex]=!0;var k=M[M.length-1];S[R.columnIndex]=k;var A=k+C[R.id];M.push(A)}for(var O={},P=u;P<=g;P++)a.state.columnIndexToMapping[P]&&!E[P]&&(O[P]=!0);for(var k=0,M=[0],B={},T=0,D=m.length;T<D;T++){var R=m[T],G=M[M.length-1];B[R.columnIndex]=G,M.push(G+parseInt(R.width))}for(var H=a.state.columnHeaderDepth,N=0,$=m.length;N<$;N++)for(var R=m[N],W=l[R.columnIndex],K=0,U=W.length;K<U;K++){var Y=W[K];if(Y&&Y.colspan>1)if(Y.isGroup)for(var V=1,X=Y.groupMappingList.length;V<X;V++){var z=Y.groupMappingList[V].columnIndex;if(!(z<=R.columnIndex)){var j=l[z];j&&(j[K]?j[K]=null:0)}}else for(var q=r[Y.columnIndex],Z=q+parseInt(Y.colspan)-1,Q=R.columnIndex+1,J=(a.state.visibleColumnMappingList[Z]||a.state.visibleColumnMappingList[a.state.visibleColumnMappingList.length-1]).columnIndex,ne=Q,re=J;ne<=re;ne++){var j=l[ne];j&&(j[K]?j[K]=null:0)}}for(var P in l)E[P]||delete l[P];var oe={},le=a.state.visibleIndexMapByColumnIndex,ie=(le[u]-le[c],[]);n=p(a.state.headerCellList);for(var N=0,$=n.length;N<$;N++)ie.push(n[N]);for(var N=0,$=ie.length;N<$;N++){var de=ie[N],se=parseInt(de.getAttribute("data-alopexgrid-columnindex")),K=parseInt(de.getAttribute("data-alopexgrid-columndepth"));if(!(se>=0&&K>=0)||g<se||K>=H)a.$wrapper[0].removeChild(de);else{var W=l[se];W&&W[K]?oe[se+","+K]=!0:a.$wrapper[0].removeChild(de)}}for(var N=0,$=m.length;N<$;N++)for(var R=m[N],se=R.columnIndex,W=l[R.columnIndex],K=0;K<H;K++){var Y=W[K];if(!oe[se+","+K]&&Y){var de=document.createElement("div");de.className="cell headercell alopexgrid-cell",de.setAttribute("data-alopexgrid-columnindex",se),de.setAttribute("data-alopexgrid-columndepth",K),a.$wrapper[0].appendChild(de)}}ie=[],n=p(a.state.headerCellList);for(var N=0,$=n.length;N<$;N++)ie.push(n[N]);for(var pe=[],ue=[0],K=0;K<a.state.headerDepth;K++)pe[K]=(a.option.headerRowHeight?"number"==typeof a.option.headerRowHeight?a.option.headerRowHeight:a.option.headerRowHeight[K]:null)||a.state.headerRowHeight,ue.push(ue[ue.length-1]+pe[K]);if(a.option.filteringHeader){var ce=e.isNumeric(a.option.filteringHeaderHeight)?a.option.filteringHeaderHeight:a.state.headerRowHeight;ue.push(ue[ue.length-1]+(pe[H-1]=ce))}for(var N=0,$=ie.length;N<$;N++){var de=ie[N],se=parseInt(de.getAttribute("data-alopexgrid-columnindex")),K=parseInt(de.getAttribute("data-alopexgrid-columndepth")),W=l[se],Y=W[K],R=Y.mapping;t&&(de.className="cell headercell alopexgrid-cell");var ge=S[se];w&&se>a.state.fixupto&&(ge+=w);var fe=ue[K],he=C[a.state.columnIndexToMapping[se].id],me=pe[K];if(Y.rowspan>1){var ve=K,xe=K+parseInt(Y.rowspan)-1;me=0;for(var ye=ve;ye<=xe;ye++)me+=pe[ye];xe===H-1&&kt.renderUtil.addClass(de,"cell-header-lastrow"),0===ve&&kt.renderUtil.addClass(de,"cell-header-firstrow")}else K===H-1&&kt.renderUtil.addClass(de,"cell-header-lastrow"),0===K&&kt.renderUtil.addClass(de,"cell-header-firstrow");if(Y.colspan>1&&Y.isGroup){he=0;for(var Ce=Y.columnIndex;Ce<=Y.toColumnIndex;Ce++){var Ie=a.state.columnIndexToMapping[Ce];Ie&&(he+=C[Ie.id]||0),void 0!==a.state.visibleIndexMapByColumnIndex[Ce]&&Ce<se&&Ie&&(ge-=C[Ie.id]||0)}}var _e=ge+"px",we=fe+"px";de.style.left!==_e&&(de.style.left=_e),de.style.top!==we&&(de.style.top=we);var be=he+"px",Me=me+"px",Se=me-4+"px";if(de.style.width!==be&&(de.style.width=be),de.style.height!==Me&&(de.style.height=Me,de.style.lineHeight=Se),!de.isHeaderCellRendered||t){var Ee="",Te=document.createDocumentFragment(),De=document.createElement("span"),Re=!1,Fe=!1;if(de.id=a.key+"-h-"+K+"-"+se,de.setAttribute("data-alopexgrid-root",a.key),Y.filter){var ke=a.state.columnIndexToMapping[Y.columnIndex];if(ke&&ke.key){var Le=a._filterCellRender(ke,!0);Te.appendChild(Le)}Fe=!0,Ee+=" filtercell"}if(se<=a.state.fixupto&&(Ee+=" fixed cell-fixcol",se===a.state.fixupto&&(Ee+=" cell-fixcol-lastcolumn")),Y.isGroup?(Ee+=" header-group",Y.rowspan>1&&(Ee+=" header-group-rowspan"),Y.colspan>1&&(Ee+=" header-group-colspan"),a.state.fixupto>=0&&R.fromIndex<=a.state.fixupto&&R.toIndex>=a.state.fixupto&&(Ee+=" cell-fixcol-lastcolumn"),de.setAttribute("data-alopexgrid-tocolumnindex",Y.toColumnIndex),de.setAttribute("data-alopexgrid-groupcolumnindexes",Y.groupColumnIndexes.join(",")),de.setAttribute("data-alopexgrid-headergroupid",Y.mapping.id)):(de.removeAttribute("data-alopexgrid-tocolumnindex"),de.removeAttribute("data-alopexgrid-groupcolumnindexes"),de.removeAttribute("data-alopexgrid-headergroupid")),I&&I.columnIndex===se&&(Ee+=" cell-firstcolumn"),R){e(de);if(R.headerStyleclass){var Ae=R.headerStyleclass;s(Ae)&&(Ae=Ae.call(a,R)||""),"string"==typeof Ae&&(Ee+=" "+Ae)}if(Y.isGroup&&R.styleclass){var Ae=R.styleclass;s(Ae)&&(Ae=Ae.call(a,R)||""),"string"==typeof Ae&&(Ee+=" "+Ae)}if(a.state.headerSelection){var Oe=Math.min(a.state.headerSelection.from,a.state.headerSelection.to),Pe=Math.max(a.state.headerSelection.from,a.state.headerSelection.to);R.columnIndex>=Oe&&R.columnIndex<=Pe?Ee+=" header-selected":Y.isGroup&&Oe<=Y.columnIndex&&Y.toColumnIndex<=Pe&&(Ee+=" header-selected")}if(_&&(R.columnIndex||R.fromIndex)+(Y.colspan||0)>=_.columnIndex&&(Ee+=" cell-lastcolumn"),R.selectorColumn&&"string"!=typeof R.title&&(a.state.rowSingleSelect||de.setAttribute("onclick",ut+".run('"+a.key+"','_rowSelectAll',event,this);")),R.selectorColumn&&"string"!=typeof R.title){var Be=document.createElement("input");Be.type="checkbox",Be.name=o(),Be.className="selector-checkbox selector-column-input";var Ge=document.createElement("label");kt.renderUtil.addDefaultInputWrapperClass(Ge,"checkbox"),a.state.rowSingleSelect&&(kt.renderUtil.addClass(Ge,"disabled"),Be.disabled=!0),a.state.selectAll&&(Be.checked=!0,Ge.className+=" checked"),Ge.appendChild(Be),De.appendChild(Ge)}else if(R.columnFoldingColumn)De.className+=" header-columnfolding-icon alopexgrid-nonsorting-handle",
R.columnFolded===!0&&(De.className+=" folded");else{var He=R.title;s(He)&&(He=He.call(a,R)),kt.renderUtil.setElementContent(De,He)}R.selectorColumn&&(Ee+=" selector-column",a.state.rowSingleSelect&&(Ee+=" single-selector-column")),R.rowindexColumn&&(Ee+=" rowindex-column"),R.numberingColumn&&(Ee+=" numbering-column"),R.columnFoldingColumn&&(Ee+=" columnfolding-column"),R.dragdropColumn&&(Ee+=" dragdrop-column");var Ne=R.headerDragDrop,$e=document.createDocumentFragment();if(Ne&&Ne===!0&&(Re=!0,Ne)){var We=null;Ee+=" headerdragdrop",We=ee(a,R),$e.appendChild(We)}var Ke=R.sorting,Ue=F(R,"resizing"),We=null;if(Ke||Ue){if(Re=!0,Ke&&R.key&&!R.selectorColumn&&(Ee+=" sorting",a.option.disableHeaderClickSorting!==!0&&(Ee+=" click-sortable"),a.option.hideSortingHandle!==!0)){We=te(a),Te.appendChild(We);var Ye=a._isColumnSorted(R);if(Ye){var Ve=Ye.sortingDirection||"asc";if(Ee+=" "+Ve,a.state.sortingInfo.length>1){var Xe=document.createElement("span"),ze=document.createTextNode(Ye.sortedOrder);Xe.className="multi-sorting-order",Xe.appendChild(ze),We.appendChild(Xe)}}}if(Ue&&!Y.disableResizing)if(e.isArray(Ue))for(var je=a.state.columnWidthMap,qe=0,Ze=[],Qe=R.toIndex;Qe>=R.fromIndex;Qe--){var We=ae(a,{columnIndex:Qe});Qe!==R.toIndex&&(We.style.right=qe+"px"),Ze.push(Qe),qe+=je[Qe],e.inArray(Qe,Ue)>=0&&Te.appendChild(We)}else Te.appendChild(ae(a,{columnIndex:se}))}R.headerAlign&&(Ee+=" align-"+R.headerAlign)}for(;de.firstChild;)de.removeChild(de.firstChild);if(Re){var Je=document.createElement("div");Je.className="relative-wrap",Je.appendChild($e),Fe||Je.appendChild(De),Je.appendChild(Te),de.appendChild(Je)}else Fe||de.appendChild(De),de.appendChild(Te);if(Fe?de.removeAttribute("title"):(kt.renderUtil.addClass(De,"column-title"),a.option.disableHeaderTitleAttribute!==!0&&de.setAttribute("title",De.textContent||De.innerText||"")),R&&R.treeColumnHeader&&a.option.tree&&a.option.tree.useTree){var et=document.createElement("span");et.className="alopexgrid-treecolumn-icon",a.state.treeHeaderExpandAllState&&(et.className+=" expanded"),a.state.treeInfo&&a.state.treeInfo.childCountByIdValueMap&&!e.isEmptyObject(a.state.treeInfo.childCountByIdValueMap)&&(et.className+=" expandable"),Re?Je.firstChild?Je.insertBefore(et,Je.firstChild):Je.appendChild(et):de.firstChild?de.insertBefore(et,de.firstChild):de.appendChild(et)}if(R&&a.state.groupingLookupTable&&a.state.groupingLookupTable[R.key]&&(Ee+=" headercell-grouping","number"==typeof R.groupFoldingHeader||R.groupFoldingHeader)){var et=document.createElement("span");et.className="alopexgrid-handle alopexgrid-groupfolding-icon alopexgrid-nonsorting-handle",a.state.headerGroupFoldingIconCollapsed&&a.state.headerGroupFoldingIconCollapsed[R.id]&&(et.className+=" group-collapsed"),et.setAttribute("data-alopexgrid-groupfolding-depth",R.groupFoldingHeader),Re?Je.firstChild?Je.insertBefore(et,Je.firstChild):Je.appendChild(et):de.firstChild?de.insertBefore(et,de.firstChild):de.appendChild(et)}if(de.className+=Ee,de.isHeaderCellRendered=!0,L(a,de),de.className.indexOf("filtercell")<0&&de.className.indexOf("header-group")<0){var tt=e(de).height()/2-e(We).height()/2;e(We).css("top",tt+"px")}}}if(a.state.refreshheadercell.prevRenderFrom=u,a.state.refreshheadercell.fitRatio=y,a.state.headerHeight=0,pe.length)for(var N=0,$=pe.length;N<$;N++)a.state.headerHeight+=pe[N];l=null}else{a.state.headerHeight=0;for(var ie=[],$=n.length||0,N=0;N<$;N++)ie.push(n[N]);$=ie.length;for(var N=0;N<$;N++){var de=ie[N];de.parentNode&&de.parentNode.removeChild(de)}}},kt.prototype._refreshFooterCells=function(t){var a=this;t=!!d(t)||!!t;var n=0,r=a.option.footerRowHeight||a.state.rowHeight,o=null,l=p(a.state.footerCellList);if(a._hasFooter()){var i=a.state.renderTargetMappingInfo,u=i.renderTargetMapping,c=(i.fixedRenderTargetMapping,i.renderTargetWidth),g=(i.fitRatio,i.columnWidthByIdMap),f=a.state.scrollxEnd,h=0;if(f&&c>a.state.wrapperWidth&&(h=c-a.state.wrapperWidth),!f&&a.option.useContinuousXScroll){var m=a._getColumnIndexByBlankWidth(a.state.translateX,!0);m&&(h=Math.min(c-a.state.wrapperWidth,m))}o=a.option.footer.position||"bottom";var v={},x=[],y={},C={},I={};a.state.footerColspanRange=C;for(var _=0,w=a.option.footer.footerMapping.length;_<w;_++){var b=a.option.footer.footerMapping[_],M=b.columnIndex;if("string"==typeof b.columnIndex){var S=a._getColumnByKey(b.columnIndex);S&&(M=S.columnIndex)}else if("string"==typeof b.columnKey){var S=a._getColumnByKey(b.columnKey);S&&(M=S.columnIndex)}else if("string"==typeof b.columnId){var S=a._getColumnByKey(b.columnId);S&&(M=S.columnIndex)}if(y[M]=b,null!=b.colspan||null!=b.colspanTo){var E=M,T=M,D=null;if(null!=b.colspan){var R=a.state.visibleIndexMapByColumnIndex[E];D=a.state.visibleColumnMappingList[R-1+b.colspan]}else D=a.columnInfo(b.colspanTo);D&&(T=D.columnIndex);for(var F={from:E,to:T},k=E;k<=T;k++)C[k]=F}}if(a.option.footer.autoColspan===!0){var L=a.state.visibleColumnMappingList[0].columnIndex;C[L]=C[L]||{from:L,to:L};for(var A=C[L],_=0,w=a.state.visibleColumnMappingList.length;_<w;_++){var O=a.state.visibleColumnMappingList[_],k=O.columnIndex,P=C[k];y[k]||P?P||(P=C[k]={from:k,to:k}):(P=C[k]=A,A.to=k),A=P}}for(var B={},_=0,w=u.length;_<w;_++){var O=u[_],G=O.columnIndex,H=C[G];if(null!=H){var N=H.from,$=H.to;G<=a.state.fixupto?$=Math.min($,a.state.fixupto):N=Math.max(N,a.state.fixupto),I[G]=g[O.id];for(var k=G+1;k<=$;k++)if(!B[k]){B[k]=!0;var W=a.columnInfo(k);W&&(I[G]+=g[W.id]||0)}}v[G]||B[G]||(v[G]=O,x.push(O))}var K=!e.isEmptyObject(I),U="top"===o?a.state.headerHeight:a.state.wrapperHeight-r,Y=[];l=p(a.state.footerCellList);for(var _=0,w=l.length;_<w;_++)Y.push(l[_]);for(var V={},_=0,w=Y.length;_<w;_++){var X=Y[_],z=X.getAttribute("data-alopexgrid-columnindex");void 0!==z&&null!==z&&v[z]?V[z]=!0:a.$wrapper[0].removeChild(X)}for(var j=[],q={},Z=0,Q={},_=0,w=x.length;_<w;_++){var O=x[_],J=I[O.columnIndex]||g[O.id];if(!V[O.columnIndex]){var X=document.createElement("div");X.className="cell footercell alopexgrid-cell",X.setAttribute("data-alopexgrid-columnindex",O.columnIndex),X.style.width=J+"px",X.style.height=r+"px",a.$wrapper[0].appendChild(X)}O.fixed&&(Q[O.columnIndex]=!0);var ee=0;j.length&&(ee=j[j.length-1]+Z),j.push(ee),q[O.columnIndex]=ee,Z=J}Y=[],l=p(a.state.footerCellList);for(var _=0,w=l.length;_<w;_++)Y.push(l[_]);for(var te=a.state.visibleColumnMappingList[0],ae=a.state.visibleColumnMappingList[a.state.visibleColumnMappingList.length-1],_=0,w=Y.length;_<w;_++){var X=Y[_],z=parseInt(X.getAttribute("data-alopexgrid-columnindex")),O=v[z],J=I[z]||g[O.id];if(t||!X.isFooterCellRendered){X.setAttribute("data-alopexgrid-root",a.key),X.className="cell footercell alopexgrid-cell",X.className+="top"===o?" footercell-top":" footercell-bottom",te&&z<=te.columnIndex&&(X.className+=" cell-firstcolumn"),ae&&ae.columnIndex<=z&&(X.className+=" cell-lastcolumn"),O.fixed&&O.columnIndex<=a.state.fixupto&&(X.className+=" cell-fixcol",O.columnIndex===a.state.fixupto&&(X.className+=" cell-fixcol-lastcolumn")),X.setAttribute("data-alopexgrid-columnindex",O.columnIndex),X.style.width=J+"px",X.style.height=r+"px";var b=y[z];if(C[z]&&y[C[z].from]&&(b=y[C[z].from]),b){var ne=a._footerValueByMapping(b);if(b.align&&(X.className+=" align-"+b.align),b.styleclass){var re=b.styleclass;s(re)&&(re=re(ne,e.extend({},a.state.footerData),b)),re&&"string"==typeof re&&(X.className+=" "+re)}b.colspan||b.colspanTo,X.innerHTML=ne}else X.innerHTML="";X.isFooterCellRendered=!0}K&&(X.style.width=J+"px");var oe=U,le=q[z]-(Q[z]?0:h);"bottom"===o?(X.style.bottom=a.state.scrollbarxHeight+"px",X.style.top=""):(X.style.bottom="",X.style.top=oe+"px"),X.style.left=le+"px"}n=r}else if(l=p(a.state.footerCellList),l&&l.length){for(var ie=[],_=0,w=l.length;_<w;_++)ie.push(l[_]);for(var _=0,w=ie.length;_<w;_++)a.$wrapper[0].removeChild(ie[_])}a.state.footerHeight=n||0,a.state.refreshfootercell={},a.state.refreshfootercell.upperHeight="top"===o?n:0,a.state.refreshfootercell.lowerHeight="bottom"===o?n:0},kt.prototype._generateCellAttribute=function(e,t,a){var n=this,r={styleclass:a?[]:["alopexgrid-cell"]},o=t.key,l=n.state;if(r.title=null,e){if(!a){if(r["data-alopexgrid-columnindex"]=t.columnIndex,r["data-alopexgrid-dataindex"]=null!=e._index.data?e._index.data:null,r["data-alopexgrid-dataid"]=e._index.id||null,r.styleclass.push(e._index.id),r.styleclass.push(e._index.row%2?"row-odd":"row-even"),e._state.selected&&r.styleclass.push("selected"),e._state.edited&&r.styleclass.push("edited"),e._state.focused&&r.styleclass.push("focused"),e._state.deleted&&r.styleclass.push("deleted"),e._state.editing&&r.styleclass.push("editing"),e._state.added&&r.styleclass.push("added"),n._isEditingCell(e,t.columnIndex)&&r.styleclass.push("editingcell"),e._state.groupHeader||e._state.groupFooter){if(r.styleclass.push("cell-groupmeta"),e._state.groupHeader){var i=n._getGroupingRangeByGroupId(e._state.groupHeader);if(r.styleclass.push("cell-groupheader"),r.styleclass.push("cell-groupheader-depth-"+i.groupDepth),r["data-alopexgrid-groupheader-depth"]=i.groupDepth,t.groupHeaderAlign&&r.styleclass.push("groupmeta-align-"+t.groupHeaderAlign),t.groupHeaderStyleclass){var d=t.groupHeaderStyleclass;if("function"==typeof d){var s=n._renderGroupSummaryValue(e,t)||"";s&&s.nodeType&&(s=kt.renderUtil.getTextFromElement(s)),d=d.call(n,s,e,t,i)}d&&"string"==typeof d&&r.styleclass.push(d)}}else if(e._state.groupFooter){var i=n._getGroupingRangeByGroupId(e._state.groupFooter);if(r.styleclass.push("cell-groupfooter"),r.styleclass.push("cell-groupheader-depth-"+i.groupDepth),r["data-alopexgrid-groupheader-depth"]=i.groupDepth,t.groupFooterAlign&&r.styleclass.push("groupmeta-align-"+t.groupFooterAlign),t.groupFooterStyleclass){var d=t.groupFooterStyleclass;if("function"==typeof d){var s=n._renderGroupSummaryValue(e,t)||"";s&&s.nodeType&&(s=kt.renderUtil.getTextFromElement(s)),d=d.call(n,s,e,t,i)}d&&"string"==typeof d&&r.styleclass.push(d)}}}else r["data-alopexgrid-groupheader-depth"]=null;if(n.option.rowOption){if(n.option.rowOption.styleclass){var p=n.option.rowOption.styleclass;"function"==typeof p&&(p=p.call(n,e,n.option.rowOption)),p&&"string"==typeof p&&r.styleclass.push(p)}if(n.option.rowOption.highlight){var p=n.option.rowOption.highlight;"function"==typeof p&&(p=p.call(n,e,n.option.rowOption)),p&&(r.styleclass.push("row-highlight"),"string"==typeof p&&r.styleclass.push(p))}n.option.rowOption.inlineStyle&&(r.style=r.style||{},kt.renderUtil.inlineStyleToStyleObject(n.option.rowOption.inlineStyle,r.style,[e],n))}n.state.pinnedDataIdMap&&n.state.pinnedDataIdMap[e._index.id]?(r.styleclass.push("pinnedcell","cell-fixrow","alopexgrid-cell-fixrow"),"string"==typeof n.state.lastPinnedDataId&&e._index.id===n.state.lastPinnedDataId&&r.styleclass.push("cell-fixrow-lastrow","alopexgrid-cell-lastfixrow")):e._index.row>=0&&e._index.row<n.option.rowFixCount&&(r.styleclass.push("cell-fixrow","alopexgrid-cell-fixrow"),e._index.row===n.option.rowFixCount-1&&r.styleclass.push("cell-fixrow-lastrow","alopexgrid-cell-lastfixrow")),l.cellSelection&&(l.cellSelection.focusColumnIndex===t.columnIndex&&l.cellSelection.focusRenderedIndex===e._index.row?r.styleclass.push("cell-selected-focus"):l.cellSelection.focusRowspanInfo&&l.cellSelection.focusRowspanInfo.from<=e._index.row&&l.cellSelection.focusRowspanInfo.to>=e._index.row&&l.cellSelection.focusColumnIndex===t.columnIndex&&r.styleclass.push("cell-selected-focus"),l.cellSelection.columnIndexMap[t.columnIndex]&&l.cellSelection.renderedIndexMap[e._index.row]&&(r.styleclass.push("cell-selected"),l.cellSelection.leftBoundaryColumnIndex===t.columnIndex&&r.styleclass.push("cell-selected-leftline"),l.cellSelection.rightBoundaryColumnIndex===t.columnIndex&&r.styleclass.push("cell-selected-rightline"),l.cellSelection.topBoundaryRenderedIndex===e._index.row&&r.styleclass.push("cell-selected-topline"),l.cellSelection.bottomBoundaryRenderedIndex===e._index.row&&r.styleclass.push("cell-selected-bottomline")));var u=n._getSearchHighlightClassName(e,t);u&&r.styleclass.push(u)}if(t.align){var c="function"==typeof t.align?t.align.call(n,f,e,t)||"left":t.align;r.styleclass.push("align-"+c)}if(n.option.ellipsisText===!0&&r.styleclass.push("cell-ellipsis-text"),r["data-alopexgrid-key"]=t.key||null,n._isCellEditable(e,t)?r.styleclass.push("cell-ui-editable"):r.styleclass.push("cell-ui-noneditable"),t.render||t.editable){var g=n._extractRenderObject(e,t);g&&"object"==typeof g&&g.type&&r.styleclass.push("cell-type-"+g.type)}if(!n.option.disableCellTitle&&t.tooltip)if(e._state.groupHeader||e._state.groupFooter)r.title="/text";else if(e){var f=e[t.key],h=f;"function"==typeof t.tooltip?h=t.tooltip(f,e,t)||"":"string"==typeof t.tooltip?h=t.tooltip:(t.render||t.editable)&&g&&(h=kt.renderUtil.getTextFromRenderRuleArray(f,e,g,t,n)),null!=h&&(r.title=h)}if(t.styleclass){var d=t.styleclass;"function"==typeof d&&(d=d.call(n,e[o],e,t)),d&&"string"==typeof d&&r.styleclass.push(d)}if(t.highlight){var d=t.highlight;"function"==typeof d&&(d=d.call(n,e[o],e,t)),d&&(r.styleclass.push("cell-highlight","alopexgrid-cell-highlight"),"string"==typeof d&&r.styleclass.push(d))}t.inlineStyle&&(r.style=r.style||{},kt.renderUtil.inlineStyleToStyleObject(t.inlineStyle,r.style,[e[o],e,t],n))}else r.styleclass.push("emptycell"),r["data-alopexgrid-rowindex"]=null,r["data-alopexgrid-columnindex"]=null,r["data-alopexgrid-dataindex"]=null,r["data-alopexgrid-dataid"]=null,r["data-alopexgrid-key"]=null;if(t&&!a){var m=n.state.visibleColumnMappingList[0],v=n.state.visibleColumnMappingList[n.state.visibleColumnMappingList.length-1];m&&m.columnIndex===t.columnIndex&&r.styleclass.push("cell-firstcolumn"),v&&v.columnIndex===t.columnIndex&&r.styleclass.push("cell-lastcolumn"),t.multi&&r.styleclass.push("cell-multi-column"),t.columnIndex<=n.state.fixupto&&(r.styleclass.push("cell-fixcol","alopexgrid-cell-fixedcolumn"),t.columnIndex===n.state.fixupto&&r.styleclass.push("cell-fixcol-lastcolumn","alopexgrid-cell-lastfixedcolumn")),n.state.groupKeyOrderMap&&n.state.groupKeyOrderMap[t.key]>=0&&r.styleclass.push("cell-grouping"),t.selectorColumn&&(r.styleclass.push("selector-column"),n.state.rowSingleSelect&&r.styleclass.push("single-selector-column")),t.rowindexColumn&&r.styleclass.push("rowindex-column"),t.numberingColumn&&r.styleclass.push("numbering-column"),t.dragdropColumn&&(r.styleclass.push("dragdrop-column"),r.styleclass.push("cell-unselectable"))}return r.styleclass=r.styleclass.join(" "),r},kt.prototype._extractRenderObject=function(e,t){var a=t.columnIndex,n=!(!e||!t)&&(t.editable&&e._state.editing&&e._state.editing.hasOwnProperty(t.columnIndex)),r=(e?n?e._state.editing[a]:e[t.key]:void 0,null);return n?(r=t.editable,r===!0&&(r={type:"text"})):(r=t.render,"editable"===t.render&&t.editable&&(r=t.editable,r===!0&&(r={type:"text"}))),r},kt.prototype._postCellRender=function(e,t,a){var n=this,r=a.columnIndex,o=!(!t||!a)&&(a.editable&&t._state.editing&&t._state.editing.hasOwnProperty(a.columnIndex)),l=t?o?t._state.editing[r]:t[a.key]:void 0,i=n._extractRenderObject(t,a);i&&"object"==typeof i&&(n.option.renderMapping[i.type]&&"function"==typeof n.option.renderMapping[i.type].postRender&&n.option.renderMapping[i.type].postRender.call(n,e,l,t,i,a,n),"function"==typeof i.postRender&&i.postRender.call(n,e,l,t,i,a,n)),n.option.disableCellRenderedEvent||n._triggerGridEvent("cellRendered",{data:t,mapping:a,value:l,editing:o,render:i},e)},kt.prototype._getMultiParentColumnIndex=function(e){var t=e&&"object"==typeof e?e.columnIndex:e;return"string"==typeof t&&t.indexOf("m")>=0&&(t=parseInt(t.split("m")[0])),t},kt.prototype._getMultiParentMapping=function(e){return"string"==typeof e.columnIndex&&e.columnIndex.indexOf("m")>=0&&(e=this.state.columnIndexToMapping[parseInt(e.columnIndex.split("m")[0])]),e},kt.prototype._iterateMultiMapping=function(t,a,n){var r=this;if(a.multi){var o=a.multi;if(s(o)&&(o=o.call(r,t[a.key],t,a),!e.isArray(o)))return;for(var l=0,i=o.length;l<i;l++){var d=null;if(o[l].columnIndex=a.columnIndex+"m"+l,d=n.call(r,l,o[l],o),d===!1)return!1}}},kt.prototype._renderDataByMapping=function(e,t){var a=this;if(t.multi){var n=document.createDocumentFragment();return a._iterateMultiMapping(e,t,function(t,r,o){var l=document.createElement("div");l.className="multicell",0===t?l.className+=" multicell-firstrow":t===o.length-1&&(l.className+=" multicell-lastrow"),l.setAttribute("data-alopexgrid-multi",t),l.style.height=100/o.length+"%",kt.renderUtil.setElementContent(l,a._renderDataByMapping(e,r)),a._setCellAttribute(a._generateCellAttribute(e,r,!0),l),n.appendChild(l)}),n}var r=t.editable&&e._state.editing&&e._state.editing.hasOwnProperty(t.columnIndex),o=o=r?e._state.editing[t.columnIndex]:t.key?e[t.key]:"",l=a._extractRenderObject(e,t),i=o;if("function"==typeof l){var d=l.call(a,o,e,l,t,a);if(!d||"object"!=typeof d||d.nodeType||!d.type)return null==d?"":d;l=d}if(l&&l.constructor===Object&&a.option.renderMapping[l.type]){var s=a.option.renderMapping[l.type],p=null;!r&&a.option.readonlyRender&&(p=l.readonly,l.readonly=!0);var u=s.renderer.call(a,o,e,l,t,a);null!==p&&(l.readonly=p),i=u}else null==o&&(o=""),i=a.option.disableValueEscape?o:document.createTextNode(o);return null==i?"":i},kt.prototype._extractEditingValueFromCell=function(e,t,a){var n=this,r=a.editable;r===!0&&(r={type:"text"});var o=null;if(d(r)&&n.option.renderMapping[r.type]&&(o=n.option.renderMapping[r.type].editedValue),"function"==typeof a.editedValue&&(o=a.editedValue),o)return o.call(n,e[0],t,r,a,n);var l=e.find("input,select,textarea");return l.length?l.val():e.text()},kt.prototype._startupUpdateEditingData=function(e){for(var t=this,a=0,n=t.option.columnMapping.length;a<n;a++){var r=t.option.columnMapping[a];r&&r.editable&&t._isEditingCell(e,r)&&t._updateEditingCellWithoutElement(e,r)}},kt.prototype._updateEditingCellWithoutElement=function(t,a){var n=this;if(a=n._getMultiParentMapping(a)){var r=n._isEditingCell(t,a.columnIndex);if(r===!0){var o=e(n._createCell(t,a));n._updateEditingCell(o),o.remove()}}},kt.prototype._updateEditingForDataMapping=function(e,t,a){var n=this,r=!1,o=a.columnIndex;if(n._isCellEditable(t,a)&&t._state.editing.hasOwnProperty(o)){var l=n._extractEditingValueFromCell(e,t,a),i=t._state.editing[o];if(r=i!==l,t._state.editing[o]=l,n.option.mergeEditingImmediately){var d={};d[a.key]=l,n._dataEdit(t,d)}if(n.state.groupRowspanned&&n.option.rowspanGroupEdit&&a.rowspan){var s=n._getGroupingRangeByMapping(t._index.data,a);if(s)for(var p=s.from;p<=s.to;p++)p!==t._index.data&&(n.state.data[p]._state.editing[o]=l,n.option.mergeEditingImmediately&&n._dataEdit(n.state.data[p],d))}}return r},kt.prototype._refreshByFromChangedCell=function(t,a,n,r){var o=this;if(o.state.hasMappingRefreshBy)for(var l=o.option.refreshByOnHiddenColumn?o.option.columnMapping:o.state.visibleColumnMappingList,i=0,d=l?l.length:-1;i<d;i++){var s=l[i];if(s&&s.hasOwnProperty("refreshBy")&&s.columnIndex!==a.columnIndex&&(!s.id||s.id!==a.id)){var p=!1;if("string"!=typeof s.refreshBy||a.key!==s.refreshBy&&a.id!==s.refreshBy){if("number"==typeof s.refreshBy&&a.columnIndex===s.refreshBy)p=!0;else if(e.isArray(s.refreshBy)&&(e.inArray(a.key,s.refreshBy)>=0||e.inArray(a.columnIndex,s.refreshBy)>=0))p=!0;else if(s.refreshBy===!0)p=!0;else if("function"==typeof s.refreshBy){var u=s.refreshBy.call(o,n,r,a.key,t,a);u===!0&&(p=!0)}}else p=!0;p&&(o._refreshCell(t,s),o._updateEditingCellWithoutElement(t,s))}}},kt.prototype._updateEditingCell=function(t){var a=this;if(!t.nodeType)return void t.each(function(){a._updateEditingCell(this)});t=e(t),t[0].getAttribute("data-alopexgrid-multi")&&(t=t.closest(".alopexgrid-cell"));var n=t.attr("data-alopexgrid-dataid"),r=a._dataGetByIndex({id:n}),o=parseInt(t.attr("data-alopexgrid-columnindex")),l=(parseInt(t.attr("data-alopexgrid-rowindex")),a._columnIndexKeyToMappingList(o)[0]),i=!1,d=kt.currentValue(r,l.key),s=null;if(l.multi){var p=t.children(".multicell"),d={},s={},u=[];a._iterateMultiMapping(r,l,function(e,t){u.push(t),d[t.key]=kt.currentValue(r,t.key);var n=a._updateEditingForDataMapping(p.eq(e),r,t);n===!0&&(i=!0),s[t.key]=kt.currentValue(r,t.key)})}else i=a._updateEditingForDataMapping(t,r,l),s=kt.currentValue(r,l.key);return i&&(a.state.hasMappingRefreshBy&&a._refreshByFromChangedCell(r,l,d,s),a._triggerGridEvent("cellValueEditing",{data:r,mapping:l,value:s,prevValue:d},t)),i},kt.prototype._renderGroupSummaryValue=function(e,t){var a=this,n=null,r=null;if(e._state.groupHeader&&(n=a._getGroupingRangeByGroupId(e._state.groupHeader),r=t.groupHeader||null),e._state.groupFooter&&(n=a._getGroupingRangeByGroupId(e._state.groupFooter),r=t.groupFooter||null),n&&r)return a._groupSummaryValue(n,r,e,t)},kt.prototype._groupSummaryValue=function(t,a,n,r){var o=this;if(!a)return null;if(e.isArray(a)||(a=[a]),!a.length)return null;for(var l=document.createDocumentFragment(),i=0,d=a.length;i<d;i++){var s=a[i],p="",u=!1;if("string"==typeof s){var c=(s.match(/((^\w+)[(].*[)])/i)||[null]).pop(),g=(s.match(/[^(]*\(([^)]*)\)/)||["",null])[1],f=g?g.split(/\W+/):null;if("groupValue"===c)if(f&&f.length){var h=parseInt(f[0])||0;p=t.member[0][o.option.grouping.by[h]]}else p=t.value;else if("getValue"===c&&f)p=n[f[0]];else if("groupFoldingIcon"===c){var m=o._isGroupRangeCollapsed(t),v=m?" group-collapsed":"";p='<span class="alopexgrid-handle alopexgrid-groupfolding-icon'+v+'"',p+=' data-alopexgrid-rangeid="'+t.id+'"',p+="></span>",u=!0}else if(kt.aggregateFunction[c]){for(var x=[],y=0,C=t.member.length;y<C;y++)null!=t.member[y]._index.target&&x.push(t.member[y]);var I=kt.aggregateFunction.primitive(x,(f?f[0]:null)||r.key);p=kt.aggregateFunction[c](I)}else p=s,u=!0}else"number"==typeof s?p=kt.renderUtil.addCommas(s):"function"==typeof s&&(p=s.call(o,t,r),null==p&&(p=""),u=!0);if(u){var _=document.createElement("span");_.className="groupsummary-value",_.innerHTML=p,l.appendChild(_)}else{var w=document.createTextNode(String(p)||"");l.appendChild(w)}}return l},kt.prototype._setCellAttribute=function(e,t){if(t.alopexgridInlineStyle){for(var a=t.alopexgridInlineStyle.split(","),n=0,r=a.length-1;n<r;n++)t.style[a[n]]="";t.alopexgridInlineStyle=null,delete t.alopexgridInlineStyle}for(var o in e)if("styleclass"===o)t.className+=(t.className?" ":"")+e[o];else if("style"===o){var l=e[o];if("string"==typeof l){var i=l.split(";");l={};for(var n=0,r=i.length;n<r;n++){var d=i[n].split(":");l[kt.trimString(d[0])]=kt.trimString(d[1])}}t.alopexgridInlineStyle="";for(var s in l){var p=l[s];null!=p?(t.style[s]=p,t.alopexgridInlineStyle+=s+","):t.style[s]=""}}else null===e[o]?t.removeAttribute(o):t.setAttribute(o,e[o])},kt.prototype._setCellContent=function(t,a){kt.renderUtil.setElementContent(a,t),this.option.disableEnhancedEventParse!==!0&&L(this,a),"/text"===a.title&&(a.title=e.text(a))},kt.prototype._generateCellContent=function(e,t,a){var n=this,r=n.state,l=n.option,i="";if(!e)return i;var d=!!e._state.editing&&n._isEditingCell(e,t),s=!(n.option.disableFoldingInEditingCell!==!0||!d);if(e._state.groupHeader||e._state.groupFooter){if(i=n._renderGroupSummaryValue(e,t),null==i&&t.rowindexColumn){var p=e._index.row;n.option.rowindexColumnFromZero||(p+=1),i=p}}else if(t.selectorColumn){var u=!!e._state.selected,c=!1;r.testRowAllowSelect&&l.rowOption.allowSelect(e)===!1&&(u=!1,c=!0);var g=null;if(a&&a.firstChild&&a.firstChild.tagName){var f=a;"DIV"===a.firstChild.tagName&&kt.renderUtil.hasClass(f.firstChild,"cell-content")&&(f=a.firstChild),f.firstChild&&"LABEL"===f.firstChild.tagName&&kt.renderUtil.hasDefaultInputWrapperClass(f.firstChild)&&(g=f.firstChild)}if(g&&g.firstChild&&"INPUT"===g.firstChild.tagName&&(kt.renderUtil.hasClass(g.firstChild,"selector-checkbox")&&(!n.state.rowSingleSelect||!n.option.singleSelectorColumnWithRadio)||kt.renderUtil.hasClass(g.firstChild,"selector-radio")&&n.state.rowSingleSelect&&n.option.singleSelectorColumnWithRadio))i=!1,u?kt.renderUtil.addClass(g,"checked"):kt.renderUtil.removeClass(g,"checked"),c?kt.renderUtil.addClass(g,"disabled"):kt.renderUtil.removeClass(g,"disabled"),g.firstChild.checked=u,g.firstChild.disabled=c;else{var h='type="checkbox" class="selector-checkbox selector-column-input"';n.state.rowSingleSelect&&n.option.singleSelectorColumnWithRadio&&(h='type="radio" class="selector-radio selector-column-input"');var m="<input "+h+' name="'+o()+'" '+(u?'checked="checked"':"")+(c?' disabled="disabled"':"")+">";i=document.createElement("label"),n.state.rowSingleSelect&&n.option.singleSelectorColumnWithRadio?(kt.renderUtil.addDefaultInputWrapperClass(i,"radio"),kt.renderUtil.addClass(i,"alopexgrid-selectorcolumn-radio-wrapper")):(kt.renderUtil.addDefaultInputWrapperClass(i,"checkbox"),kt.renderUtil.addClass(i,"alopexgrid-selectorcolumn-checkbox-wrapper")),u&&(i.className+=" checked"),c&&(i.className+=" disabled"),i.innerHTML=m}}else if(t.rowindexColumn){var p=e._index.row;n.option.rowindexColumnFromZero||(p+=1),i=p}else if(t.dragdropColumn)i=document.createElement("div"),i.className="row-dragdrop-handle alopexgrid-handle",i.setAttribute("onmousedown",ut+".run('"+n.key+"', '_rowDragStart', event);"),i.setAttribute("ontouchstart",ut+".run('"+n.key+"', '_rowDragStart', event);");else if(t.numberingColumn){var v,x=n.pageInfo(),y=n.option.numberingColumnFromZero?0:1;n.state.dynamicBinding&&(y+=x.perPage>0&&x.current>0?Math.max(0,x.perPage*(x.current-1)):0),v=e._index.data+y,i='<div class="numbering-column-wrapper" style="text-align:center;">'+v+"</div>"}else i=n._renderDataByMapping(e,t);if(!s&&n.option.tree&&n.option.tree.useTree&&t.treeColumn){for(var C=document.createDocumentFragment(),I=e._state.treeNodeDepth,_=parseInt(n.option.tree.depthStartValue),w=I;_<w;_++){var b=document.createElement("span");b.className="alopexgrid-treecolumn-indent",C.appendChild(b)}var M=document.createElement("span");M.className="alopexgrid-treecolumn-icon"+(e._state.expandedTreeNode?" expanded":"")+(e._state.treeNodeLeaf?" leaf":" expandable"),C.appendChild(M),i=A(i,C,!0,i===!1?a:null)}if(e&&e._index&&e._index.id&&(t.rowResizing||t.rowindexColumn)){var S=document.createElement("div");S.className="rowindex-column-resizing-handle resizing-handle alopexgrid-handle",S.setAttribute("data-alopexgrid-resizingrowindex",e._index.row),S.setAttribute("onmousedown",ut+".run('"+n.key+"', '_rowResizeStart',event,"+e._index.row+","+t.columnIndex+");"),S.setAttribute("ontouchstart",ut+".run('"+n.key+"', '_rowResizeStart',event,"+e._index.row+","+t.columnIndex+");"),S.setAttribute("ondblclick",ut+".run('"+n.key+"', 'setRowHeight',{_index:{row:"+e._index.row+"}},'content');"),i=A(i,S,!1,i===!1?a:null)}if(!s&&e&&e._index&&e._index.id&&t.groupFoldingColumn){var E=n._getGroupingRangeByData(e,t);if(E&&E.id){var T=document.createElement("span");T.className="alopexgrid-handle alopexgrid-groupfolding-icon "+(n._isGroupRangeCollapsed(E)?"group-collapsed":""),T.setAttribute("data-alopexgrid-rangeid",E.id),i=A(i,T,!(!n.option.grouping||"left"!==n.option.grouping.groupFoldingColumnPosition),i===!1?a:null)}}if(n.option.wrapCellContent&&i!==!1){var D=document.createElement("div");return D.className=n.option.wrapCellContentClassName,n._setCellContent(i,D),D}return i},kt.prototype._createCell=function(e,t,a){var n=this,r=null;r=a?a:document.createElement("div"),r.className="cell bodycell",t=n._getMultiParentMapping(t);var o=(a?a.getAttribute("data-alopexgrid-rowindex"):null,n._generateCellAttribute(e,t));n._setCellAttribute(o,r);var l=n._generateCellContent(e,t);return l!==!1&&n._setCellContent(l,r),r.isCellAttributeGenerated=!0,r.isCellContentGenerated=!0,n._postCellRender(r,e,t),r},kt.prototype._basicCellCreation=function(e,t,a,n){var r=this;if(!e.isCellAttributeGenerated||n===!0){var o=r._generateCellAttribute(t,a);r._setCellAttribute(o,e),e.isCellAttributeGenerated=!0}if(!e.isCellContentGenerated||n===!0){var l=r._generateCellContent(t,a,e);l!==!1&&r._setCellContent(l,e),r._postCellRender(e,t,a),e.isCellContentGenerated=!0}},kt.prototype._clearCellCache=function(){for(var e in this.state.cellCache)this._clearCellCacheByDataId(e);for(var t in this.state.cellCache)this.state.cellCache.hasOwnProperty(t)&&delete this.state.cellCache[t];this.state.cellCacheHelper.trimCount=0,this.state.cellCacheHelper.cacheDataList=[],this.state.cellCacheHelper&&(this.state.cellCacheHelper.incTimer&&(clearInterval(this.state.cellCacheHelper.incTimer),this.state.cellCacheHelper.incTimer=null),this.state.cellCacheHelper.padTimer&&(clearInterval(this.state.cellCacheHelper.padTimer),this.state.cellCacheHelper.padTimer=null))},kt.prototype._clearCellCacheByDataId=function(e){if(this.state.cellCache[e]){for(var t in this.state.cellCache[e])delete this.state.cellCache[e][t];delete this.state.cellCache[e]}},kt.prototype._clearCellCacheByDataMapping=function(e,t){e&&e._index&&t&&t.id&&this.state.cellCache[e._index.id]&&this.state.cellCache[e._index.id][t.id]&&delete this.state.cellCache[e._index.id][t.id]},kt.prototype._getCachedCell=function(e,t){return this.state.cellCacheEnabled&&this.state.cellCache&&e&&e._index&&t&&t.id&&this.state.cellCache[e._index.id]&&this.state.cellCache[e._index.id][t.id]?this.state.cellCache[e._index.id][t.id]:null},kt.prototype._cacheCell=function(e,t,a){var n=this;if(!a&&n.state.cellCache[e._index.id]&&n.state.cellCache[e._index.id][t.id])return n.state.cellCache[e._index.id][t.id];var r=!1;n.state.cellCache[e._index.id]||(n.state.cellCache[e._index.id]={},n.state.cellCacheHelper.cacheDataList.push(e),r=!0);var o=document.createElement("div");return o.className="cell bodycell",o.setAttribute("data-alopexgrid-root",n.key),n._basicCellCreation(o,e,t),n.state.cellCache[e._index.id][t.id]=o,r&&n._trimCellCache(),o},kt.prototype._cacheCellByData=function(e){var t=this;if(t.option.cellCache.enabled)for(var a="full"===t.option.cellCache.columnRange?t.state.visibleColumnMappingList:t.state.renderTargetMappingInfo.renderTargetMapping,n=0,r=a.length;n<r;n++)t._cacheCell(e,a[n])},kt.prototype._cacheCellElement=function(e,t,a){var n=!1;this.state.cellCache[e._index.id]||(this.state.cellCache[e._index.id]={},this.state.cellCacheHelper.cacheDataList.push(e),n=!0),this.state.cellCache[e._index.id][t.id]=a,n&&this._trimCellCache()},kt.prototype._trimCellCache=function(){var e=this;if(e.option.cellCache.policy&&(e.state.cellCacheHelper.trimCount++,e.state.cellCacheHelper.trimCount>30)){e.state.cellCacheHelper.trimCount=0;var t="distant"==e.option.cellCache.policy?e.state.cellCacheHelper.cacheDataList.length:O(e.state.cellCache);if(t>e.option.cellCache.capacity){var a=t-e.option.cellCache.capacity;if("random"==e.option.cellCache.policy){for(var n in e.state.cellCache)if(e._clearCellCacheByDataId(n),a--,a<0)break}else if("distant"==e.option.cellCache.policy){e.state.cellCacheHelper.cacheDataList.sort(function(t,a){var n=Math.min(Math.abs(t._index.row-e.state.renderFromRenderedIndex),Math.abs(t._index.row-e.state.renderToRenderedIndex)),r=Math.min(Math.abs(a._index.row-e.state.renderFromRenderedIndex),Math.abs(a._index.row-e.state.renderToRenderedIndex));return n-r});for(var r=e.state.cellCacheHelper.cacheDataList.splice(e.option.cellCache.capacity),o=0,l=r.length;o<l;o++)e._clearCellCacheByDataId(r[o]._index.id)}"distant"!=e.option.cellCache.policy&&(e.state.cellCacheHelper.cacheDataList=[])}}},kt.prototype._getProcessedPageUpLength=function(e){var t=this,a=t.state.refreshbodycell&&t.state.refreshbodycell.renderedPinnedDataList?t.state.refreshbodycell.renderedPinnedDataList.length:0,n=0,r=t.state.refreshbodycell&&t.state.refreshbodycell.renderedDataList?t.state.refreshbodycell.renderedDataList[a]:t.state.renderTargetDataList[t.state.renderFromRenderedIndex+a],o=t.state.refreshbodycell.bodyCellStartY,l=t.state.refreshbodycell.bodyCellEndY;if(a)for(var i=0,d=t.state.refreshbodycell.renderedPinnedDataList.length;i<d;i++){var s=t.state.refreshbodycell.renderedPinnedDataList[i];o+=t._getRowHeight(s)}for(var p=a,u=t.state.refreshbodycell.renderedDataList.length;p<u;p++){var s=t.state.refreshbodycell.renderedDataList[p],c=t.state.refreshbodycell.bodyCellPositionY[p];if(null!=c){var g=t._getRowHeight(s),f=c+g-1;if(o<=c&&f<=l){r=s;break}}}if(r=t.state.renderTargetDataList[(r?r._index.row:0)-1],
t.state.renderFromRenderedIndex){if(r){for(var h=l-o,m=r._index.row,v=m,x=0;m>=0;){var r=t.state.renderFromRenderedIndex[m],g=t._getRowHeight(r);if(x+g>h)break;x+=g,m--}if(m<0)for(m=0,v++;x<=h&&v<t.state.renderTargetDataList.length;){var r=t.state.renderFromRenderedIndex[v],g=t._getRowHeight(r);if(x+g>h)break;x+=g,v++}m=Math.max(0,m),v=Math.min(t.state.renderTargetDataList.length,v),n=Math.abs(v-m)}}else n=(t.state.cellSelection?t.state.cellSelection.focusRenderedIndex:0)||t.state.refreshbodycell.renderedDataList.length;var y=e===!0?null:t.option.verticalScrollMoveTempo;return"function"==typeof y&&(y=y(n,a)),y||n},kt.prototype._getProcessedPageDownLength=function(e){var t=this,a=t.state.refreshbodycell&&t.state.refreshbodycell.renderedPinnedDataList?t.state.refreshbodycell.renderedPinnedDataList.length:0,n=t._getFullyRenderedRowLength()-a,r=e===!0?null:t.option.verticalScrollMoveTempo;return"function"==typeof r&&(r=r(n,a)),r||n},kt.prototype._getFullyRenderedRowLength=function(e){var t=this,a=0,n=0,r=t.state.refreshbodycell&&t.state.refreshbodycell.renderedPinnedDataList?t.state.refreshbodycell.renderedPinnedDataList.length:0;if(t.state.refreshbodycell&&t.state.refreshbodycell.renderedDataList){var o=t.state.refreshbodycell.bodyCellStartY,l=t.state.refreshbodycell.bodyCellEndY;if(r)for(var i=0,d=t.state.refreshbodycell.renderedPinnedDataList.length;i<d;i++){var s=t.state.refreshbodycell.renderedPinnedDataList[i];o+=t._getRowHeight(s)}for(var p=r,u=t.state.refreshbodycell.renderedDataList.length;p<u;p++){var s=t.state.refreshbodycell.renderedDataList[p],c=t.state.refreshbodycell.bodyCellPositionY[p];if(null!=c){var g=t._getRowHeight(s),f=c+g-1;o<=c&&f<=l?a++:e&&(c<o&&o<=f?n+=1:c<=l&&l<f&&(n+=1))}}}return a+n+r},kt.prototype._getProcessedPageLeftLength=function(){var e=this,t=e.state.refreshbodycell&&e.state.refreshbodycell.renderedFixedColumnMappingList?e.state.refreshbodycell.renderedFixedColumnMappingList.length:0,a=0,n=e.state.refreshbodycell.bodyCellStartX,r=e.state.refreshbodycell.bodyCellEndX,o=rt(e,e.state.renderFromColumnIndex,1);if(t){for(var l=0,i=e.state.refreshbodycell.renderedFixedColumnMappingList.length;l<i;l++){var d=e.state.refreshbodycell.renderedFixedColumnMappingList[l];n+=e.state.columnWidthMap[d.columnIndex]}o=rt(e,e.state.refreshbodycell.renderedColumnMappingList[i].columnIndex,1)}if(null!=o){var s=r-n,p=o,u=0,c=e.state.columnWidthMap[o];for(u+c<=s&&(u+=c,a++);u<s;){var g=rt(e,p,1);if(null==g||g<0)break;if(c=e.state.columnWidthMap[g],u+c>s)break;u+=c,p=g,a++}for(;u<s;){var f=ot(e,o,1);if(null==f||f>e.state.maxColumnIndex)break;if(c=e.state.columnWidthMap[f],u+c>s)break;u+=c,o=f,a++}}var h=e.option.horizontalScrollMoveTempo;return"function"==typeof h&&(h=h(a,t)),h||a},kt.prototype._getProcessedPageRightLength=function(){var e=this,t=e.state.refreshbodycell&&e.state.refreshbodycell.renderedFixedColumnMappingList?e.state.refreshbodycell.renderedFixedColumnMappingList.length:0,a=e._getFullyRenderedColumnLength()-t,n=e.option.horizontalScrollMoveTempo;return"function"==typeof n&&(n=n(a,t)),n||a},kt.prototype._getFullyRenderedColumnLength=function(e){var t=this,a=0,n=0,r=t.state.refreshbodycell&&t.state.refreshbodycell.renderedFixedColumnMappingList?t.state.refreshbodycell.renderedFixedColumnMappingList.length:0;if(t.state.refreshbodycell&&t.state.refreshbodycell.renderedColumnMappingList){var o=t.state.refreshbodycell.bodyCellStartX,l=t.state.refreshbodycell.bodyCellEndX;if(r)for(var i=0,d=t.state.refreshbodycell.renderedFixedColumnMappingList.length;i<d;i++){var s=t.state.refreshbodycell.renderedFixedColumnMappingList[i];o+=t.state.columnWidthMap[s.columnIndex]}for(var p=r,u=t.state.refreshbodycell.renderedColumnMappingList.length;p<u;p++){var s=t.state.refreshbodycell.renderedColumnMappingList[p],c=t.state.refreshbodycell.bodyCellPositionX[p];if(null!=c){var g=t.state.columnWidthMap[s.columnIndex],f=c+g-1;o<=c&&f<=l?a++:e&&(c<o&&o<=f?n+=1:c<=l&&l<f&&(n+=1))}}}return a+n+r},kt.prototype._allowGroupMerge=function(e,t,a,n){var r=this;if(e._index.row>t._index.row){var o=e;e=t,t=o}var l=r._getGroupingRangeByData(e,a),i=r._getGroupingRangeByData(t,a),d=a.rowspan.by||a.rowspan;1==d&&(d=a.key);var s=r.state.groupKeyOrderMap[d];if(l.groupDepth<s||i.groupDepth<s)return!1;var p=P(r,l,i,d);if(!p)return!1;if(1==n){if((e._state.groupFooter||e._state.groupHeader)&&l.groupDepth==s)return!1;if((t._state.groupFooter||t._state.groupHeader)&&i.groupDepth==s)return!1}return!0},kt.prototype._refreshBodyCells=function(e){function t(e,t,a,n,r,o,l,i,d,s){var p=document.createElement("div");p.setAttribute("data-alopexgrid-root",e.key),p.className="cell emptycell nodata nodatacell",s&&(p.className+=" nofiltereddata"),p.style.top=t+"px",p.style.left=a+"px",p.style.width=Math.max(0,Math.min(n,r-a))+"px",p.style.height=(e.state.nodataRowHeight||e.state.rowHeight)+"px";var u=document.createElement("span");u.className="emptycell-message",s?u.innerHTML=e.option.message.noFilteredData:u.innerHTML=e.option.message.nodata,p.appendChild(u),e.$wrapper[0].appendChild(p);for(var c=0,g=o.length;c<g;c++)l[c+",0"]=!0;i.length||i.push(null),d=!0}var a=this,n=p(a.state.bodyCellList),r={dataIndexList:null,columnIndexList:null,dataIndexMap:{},columnIndexMap:{}},o=!1;if(e&&e.refreshGeometry===!0&&(o=!0,a.option.cellCache.enabled))for(var l in a.state.cellCache){var i=a.state.cellCache[l];for(var s in i)i[s].cellWidthProcessed=!1,i[s].cellHeightProcessed=!1}if(e&&d(e)){if(r.dataIndexList=e.dataIndexList,r.dataIndexList)for(var u=0,c=r.dataIndexList.length;u<c;u++)r.dataIndexMap[r.dataIndexList[u]]=!0;if(r.columnIndexList=e.columnIndexList,r.columnIndexList)for(var u=0,c=r.columnIndexList.length;u<c;u++)r.columnIndexMap[r.columnIndexList[u]]=!0;e=!1}if(e===!0&&a.state.refreshbodycell){if(a.option.cellCache.enabled){for(var l in a.state.cellCache){var i=a.state.cellCache[l];for(var s in i)i[s].isCellAttributeGenerated=!1,i[s].isCellContentGenerated=!1,i[s].cellWidthProcessed=!1,i[s].cellHeightProcessed=!1,i[s].className="cell bodycell"}var g="full"===a.option.cellCache.columnRange?a.state.visibleColumnMappingList:a.state.renderTargetMappingInfo.renderTargetMapping;if("all"==a.option.cellCache.mode)for(var f=0,h=a.state.renderTargetDataList.length;f<h;f++)for(var m=a.state.renderTargetDataList[f],v=0,x=g.length;v<x;v++)a._cacheCell(m,g[v]);else"inc"==a.option.cellCache.mode&&(a._triggerGridEvent("incrementalCacheStart"),a.state.cellCacheHelper.incRowCounter=-1,a.state.cellCacheHelper.incStartTime=Date.now(),a.state.cellCacheHelper.incTimer=setInterval(function(){for(var e=a.state.renderTargetDataList[++a.state.cellCacheHelper.incRowCounter];e&&a.state.cellCache[e._index.id]&&a.state.cellCache[e._index.id][g[0].id]&&a.state.cellCache[e._index.id][g[0].id].isCellContentGenerated;)e=a.state.renderTargetDataList[++a.state.cellCacheHelper.incRowCounter];if(e)for(var t=0,n=g.length;t<n;t++)a._cacheCell(e,g[t]);if(!e||a.state.cellCacheHelper.incRowCounter>=a.state.renderTargetDataList.length)return clearInterval(a.state.cellCacheHelper.incTimer),a.state.cellCacheHelper.incTimer=null,a.state.cellCacheHelper.incDuration=Date.now()-a.state.cellCacheHelper.incStartTime,void a._triggerGridEvent("incrementalCacheEnd")},a.option.cellCache.timerInterval))}for(var y in a.state.refreshbodycell)delete a.state.refreshbodycell[y];delete a.state.refreshbodycell}if(r.dataIndexList&&a.option.cellCache.enabled)for(var u=0,c=r.dataIndexList.length;u<c;u++){var m=a.state.data[r.dataIndexList[u]];if(m){var i=a.state.cellCache[m._index.id];for(var s in i)i[s].isCellContentGenerated=!1,i[s].isCellAttributeGenerated=!1,cacheobj[s].cellWidthProcessed=!1,cacheobj[s].cellHeightProcessed=!1,i[s].className="cell bodycell"}}a.state.refreshbodycell=a.state.refreshbodycell||{},a.state.bodyHeight=0;var C=(a.state.headerHeight||0)+a.state.refreshfootercell.upperHeight,I=a.state.wrapperHeight-a.state.refreshfootercell.lowerHeight,_=0,w=a.state.wrapperWidth,b=a.state.scrollxEnd,M=a.state.scrollyEnd,S=_,E=C,T=a.state.renderFromColumnIndex||0,D=a.state.renderFromRenderedIndex||0,R=a.state.refreshbodycell.prevColumnIndex,F=a.state.refreshbodycell.prevRenderedIndex;a.state.refreshbodycell.prevRowFixCount!==a.option.rowFixCount&&(e=!0);var k=1,L=0,A=0;a.state.fixupto>=0&&(S+=a.state.fixedColumnWidth);var O=[],P=a._hasPinnedData(),B=a.option.disableScrolledFix?0:a.option.rowFixShowFrom||0;if(P)for(var u=0,c=a.state.pinnedDataIdList.length;u<c;u++){var l=a.state.pinnedDataIdList[u],m=a.state.data[a.state.dataIdToIndexMap[l]];m&&null!=m._index.row&&(E+=a.state.rowHeightMapByDataId[l]||a.state.rowHeight,O.push(m))}else if(a.option.rowFixCount>0){D<B&&(D=B);for(var u=B||0,c=a.option.rowFixCount;u<c;u++){var m=a.state.renderTargetDataList[u];m&&(O.push(m),E+=a.state.rowHeightMapByDataId[m._index.id]||a.state.rowHeight)}}P&&O.length?a.state.lastPinnedDataId=O[O.length-1]._index.id:a.state.lastPinnedDataId=null;var G=[];if(It)for(var u=0,c=n.length;u<c;u++)G.push(n[u]);else G=G.concat(Array.prototype.slice.call(n));var H={},N={},$=0,W=[],K=[],U=a.state.renderTargetMappingInfo;W=U.renderTargetMapping,K=U.fixedRenderTargetMapping,$=U.renderTargetWidth,k=U.fitRatio;var Y=U.columnWidthByIdMap,V=U.renderFitWidth;L=(W[Math.max(W.length-1,0)]||{}).columnIndex;for(var X={},u=0,c=W.length;u<c;u++)X[W[u].columnIndex]=u,N[W[u].id]=u;for(var z=0,j=[],q=[],Z=I-C,Q=[],J=a.option.useContinuousYScroll?a.__getRenderedIndexByBlankHeight(a.state.translateY,!0):0,ee=a.option.useContinuousXScroll?a._getColumnIndexByBlankWidth(a.state.translateX,!0):0,te=0,u=D,c=a.state.renderTargetDataList.length;u<c;u++,te++){var m=te<O.length?O[te]:a.state.renderTargetDataList[u],ae=(m?a.state.rowHeightMapByDataId[m._index.id]:null)||a.state.rowHeight;if(z+=ae,j.push(m),q.push(m?m._index.row:u),te<O.length&&Q.push(m),z>Z+J&&!M)break}var ne=Q[Q.length-1]||null;if(A=D+j.length-1,z<Z+J&&a.option.rowPadding){var re=a.option.rowPadding;re===!0&&a.option.paging&&(re=a.option.paging.perPage);for(var u=A+1;u<re&&(j.push(null),z+=a.state.rowHeight,!(z>Z+J));u++);}else if(z<Z+J){var oe=!1;if(M&&D>0?oe=!0:!M&&A>=a.state.renderTargetDataList.length-1&&A>(a.option.rowPadding||0)&&(oe=!0),oe)for(var le=a.option.rowFixCount?B:0;D>le;){D-=1;var m=a.state.renderTargetDataList[D],ae=(m?a.state.rowHeightMapByDataId[m._index.id]:null)||a.state.rowHeight;if(z+=ae,j.splice(O.length,0,m),q.splice(O.length,0,D),z>Z+J)break}}a.state.renderToRenderedIndex=A,a.state.renderToColumnIndex=L,!e&&a.option.fitTableWidth&&k!==a.state.refreshbodycell.fitRatio&&(e=!0);for(var u=0,c=j.length;u<c;u++)j[u]&&(H[j[u]._index.id]=u);if(a.option.cellCache.enabled&&"pad"===a.option.cellCache.mode){for(var re=Math.ceil(j.length*(a.option.cellCache.padRatio||1)),ie=[],de=A+1,h=Math.min(de+re,a.state.renderTargetDataList.length);de<h;de++)a.state.renderTargetDataList[de]&&!a.state.cellCacheHelper.padDataIdOnQueue[a.state.renderTargetDataList[de]._index.id]&&(ie.push(a.state.renderTargetDataList[de]),a.state.cellCacheHelper.padDataIdOnQueue[a.state.renderTargetDataList[de]._index.id]=!0);for(var de=D-1;de>=Math.max(de-re,0);de--)a.state.renderTargetDataList[de]&&!a.state.cellCacheHelper.padDataIdOnQueue[a.state.renderTargetDataList[de]._index.id]&&(ie.push(a.state.renderTargetDataList[de]),a.state.cellCacheHelper.padDataIdOnQueue[a.state.renderTargetDataList[de]._index.id]=!0);a.state.cellCacheHelper.padDataList=ie.concat(a.state.cellCacheHelper.padDataList).slice(0,a.option.cellCache.capacity);var g="full"===a.option.cellCache.columnRange?a.state.visibleColumnMappingList:a.state.renderTargetMappingInfo.renderTargetMapping;a.state.cellCacheHelper.padTimer||(a.state.cellCacheHelper.padTimer=setInterval(function(){for(var e=null;(e=a.state.cellCacheHelper.padDataList.shift())&&a.state.cellCache[e._index.id];)delete a.state.cellCacheHelper.padDataIdOnQueue[e._index.id];if(e)for(var t=0,n=g.length;t<n;t++)a._cacheCell(e,g[t]);a.state.cellCacheHelper.padDataList.length||(clearInterval(a.state.cellCacheHelper.padTimer),a.state.cellCacheHelper.padTimer=null)},a.option.cellCache.timerInterval))}for(var se={},pe={},ue=D-F,ce=a.state.visibleIndexMapByColumnIndex,ge=ce[T]-ce[R],u=0,c=G.length;u<c;u++){var fe=G[u],he=fe.__aglocalx,me=fe.__aglocaly;if(a.option.cellCache.enabled)null==H[fe.__agdid]||null==N[fe.__agmid]?a.$wrapper[0].removeChild(fe):(he=N[fe.__agmid],me=H[fe.__agdid],null==he||null==me?a.$wrapper[0].removeChild(fe):(fe.__aglocalx=he,fe.__aglocaly=me),se[he+","+me]=!0);else{if(he<K.length){var ve=K[he],ye=fe.__agci;if(ye>=0&&ve.columnIndex!==ye){a.$wrapper[0].removeChild(fe);continue}}else if(ge){if(he-=ge,he<K.length){a.$wrapper[0].removeChild(fe);continue}fe.__aglocalx=he}if(me<Q.length){if(ne){var Ce=fe.__agri;if(Ce>ne._index.row){a.$wrapper[0].removeChild(fe);continue}}}else if(ue){if(me-=ue,me<Q.length){a.$wrapper[0].removeChild(fe);continue}fe.__aglocaly=me}he>=W.length||me>=j.length?a.$wrapper[0].removeChild(fe):null===he||null===me||he<0||me<0?a.$wrapper[0].removeChild(fe):se[he+","+me]=!0}}for(var Ie=p(a.state.nodataCellList);Ie.length;)a.$wrapper[0].removeChild(Ie[0]),Ie=p(a.state.nodataCellList);var _e=!1;a.state.data&&a.state.data.length?a.state.data&&a.state.data.length>0&&null!=a.state.filteredDataList&&0===a.state.filteredDataList.length&&a.option.message&&a.option.message.noFilteredData&&t(a,C,_,V,w,W,pe,j,_e,!0):a.option.message&&a.option.message.nodata&&t(a,C,_,V,w,W,pe,j,_e,!1);for(var we=[_],be=[C],Me=0,Se=0,Ee=W.length;Se<Ee;Se++){var Te=W[Se];we.push(we[we.length-1]+Y[Te.id]);for(var De=0,Re=0,Fe=j.length;Re<Fe;Re++){var m=j[Re];if(0==Se){var ae=(m&&m._index?a.state.rowHeightMapByDataId[m._index.id]:0)||a.state.rowHeight;0==Re&&!m&&_e&&(ae=a.state.nodataRowHeight||a.state.rowHeight),De+=ae,be[Re+1]=be[Re]+parseInt(ae)}if(!se[Se+","+Re]){var ke=null;m&&Te&&a.state.cellCache[m._index.id]&&a.state.cellCache[m._index.id][Te.id]?ke=a.state.cellCache[m._index.id][Te.id]:(ke=document.createElement("div"),ke.className="cell bodycell"),ke.__aglocalx=Se,ke.__aglocaly=Re,a.$wrapper[0].appendChild(ke),a.option.cellCache.enabled&&m&&Te&&(a._cacheCellElement(m,Te,ke),ke.__agdid=m._index.id,ke.__agmid=Te.id)}}Me=Math.max(Me,De)}if(G=[],n=p(a.state.bodyCellList),It)for(var u=0,c=n.length;u<c;u++)G.push(n[u]);else G=G.concat(Array.prototype.slice.call(n));for(var Le=[],u=0,c=W.length;u<c;u++)Le.push([]);var Ae=(z||0)+(a.state.headerHeight||0)+(a.state.footerHeight||0),Oe=-(b?$-a.state.wrapperWidth:0),Pe=-(M?Ae-a.state.wrapperHeight:0),Be=a.option.grouping?a.option.grouping.groupRowspanMode:null;!M&&a.option.useContinuousYScroll&&J&&(Pe=-Math.min(Ae-a.state.wrapperHeight,J)),!b&&a.option.useContinuousXScroll&&ee&&(Oe=-Math.min($-a.state.wrapperWidth,ee));for(var u=0,c=be.length;u<c;u++)Pe&&u>=O.length&&(be[u]+=Pe);for(var u=0,c=we.length;u<c;u++){var Te=W[u];Te&&Oe&&Te.columnIndex>a.state.fixupto&&(we[u]+=Oe)}for(var Ge=a.state.refreshbodycell.scrollxEnd!=b,He=a.state.refreshbodycell.scrollyEnd!=M,Ne=!!(ge||isNaN(ge)||Ge||o),$e=!!(ue||isNaN(ue)||He||o),u=0,c=G.length;u<c;u++){var fe=G[u],he=parseInt(fe.__aglocalx),me=parseInt(fe.__aglocaly),m=j[me],Te=W[he],We=m?m._index.row:q[me],Ke=j[me-1],Ue=j[me+1],Ye=!!(e||m&&r.dataIndexMap[m._index.data]&&!r.columnIndexList||m&&r.dataIndexMap[m._index.data]&&r.columnIndexMap[Te.columnIndex]);if(Le[he][me]=fe,m&&Te?(fe.id=a._cellIdFromRowIndex(We,Te.columnIndex),fe.setAttribute("data-alopexgrid-rowindex",We),fe.__agri=We,fe.__agci=Te.columnIndex):fe.removeAttribute("id"),Ye===!0&&(fe.className="cell bodycell",fe.setAttribute("data-alopexgrid-root",a.key)),pe[he+","+me])a.$wrapper[0].removeChild(fe);else{var Ve=a.state.hasLeftColspanMapByColumnIndex[Te.columnIndex],Xe=0;if(!fe.cellWidthProcessed||Ye||Ne||Ve){var ze=Te.columnIndex,je=Y[Te.id];if(m){var qe=a.state.fixupto>=0&&Te.columnIndex===a.state.fixupto,Ze=0;if(Ve)for(var Qe=ze;Qe>=0;){var Je=a.state.columnIndexToMapping[Qe--];if(Je&&xe(Je)&&(Je.colspan||Je.colspanTo)){var et=a._getColspanUpto(m,Je);if(et>=ze){je=Y[Je.id]||0,Je.columnIndex<ze&&(Xe-=je),et===a.state.fixupto&&(qe=!0);for(var tt=Je.columnIndex+1;tt<=et;tt++){var at=a.state.columnIndexToMapping[tt];if(at&&xe(at)){je+=Y[at.id]||0,Ze++,tt<ze&&(Xe-=Y[at.id]||0);var nt=X[tt];void 0!==nt&&tt>ze&&(pe[nt+","+me]=!0)}}Te=Je;break}}}Ze&&kt.renderUtil.addClass(fe,"cell-colspan-column"),qe&&kt.renderUtil.addClass(fe,"cell-fixcol-lastcolumn")}fe.style.width!==je+"px"&&(fe.style.width=je+"px"),fe.cellWidthProcessed=!0}if(!fe.cellHeightProcessed||Ye||$e){var ae=(m&&m._index?a.state.rowHeightMapByDataId[m._index.id]:0)||a.state.rowHeight;if(m){var rt=m===ne,ot=0,lt=!1,it=null;if(Te.rowspan&&a.state.groupRowspanned){if(Be){if((1==Be||2==Be)&&(it=a._getGroupingRangeByData(m,Te),ot++,Q.length!==me&&me?a._allowGroupMerge(Ke,m,Te,Be)||(lt=!0):lt=!0,lt))for(var dt=me+1,st=j.length;dt<st;dt++){var pt=j[dt];if(!pt)break;var ut=a._allowGroupMerge(m,pt,Te,Be);if(!ut)break;if(ae+=a.state.rowHeightMapByDataId[pt._index.id]||a.state.rowHeight,ot++,gt&&Q.length===dt){rt=!0;break}}}else if(it=a._getGroupingRangeByMapping(m._index.data,Te)){ot++;var ct=Ke?a._getGroupingRangeByMapping(Ke._index.data,Te):null,gt=me<Q.length;if(ct&&it.id===ct.id?Q.length===me&&(lt=!0):lt=!0,lt)for(var dt=me+1,st=j.length;dt<st;dt++){if(gt&&Q.length===dt){rt=!0;break}var pt=j[dt];if(!pt||"object"!=typeof pt)break;var ft=a._getGroupingRangeByMapping(pt._index.data,Te);if(!ft)break;if(it.id!==ft.id)break;ae+=a.state.rowHeightMapByDataId[pt._index.id]||a.state.rowHeight,ot++}}if(ot){if(!lt){pe[he+","+me]=!0,a.$wrapper[0].removeChild(fe);continue}var ht=!1;if(m._state.groupFooter||m._state.groupHeader){var mt=Te.rowspan.by||Te.rowspan;1==mt&&(mt=Te.key);var vt=a.state.groupKeyOrderMap[mt];1==Be&&it.groupDepth==vt||it.groupDepth<vt||(m=it.member[0]),ht=!0}kt.renderUtil.addClass(fe,"cell-rowspan-column");for(var xt=!1,yt=!1,Ct=it.member,_t=0,wt=Ct.length;_t<wt;_t++)Ct[_t]._state.selected&&(xt=!0),Ct[_t]._state.focused&&(yt=!0);ht||(xt&&(kt.renderUtil.addClass(fe,"cell-rowspan-contain-selected"),kt.renderUtil.addClass(fe,"selected")),yt&&(kt.renderUtil.addClass(fe,"cell-rowspan-contain-focused"),kt.renderUtil.addClass(fe,"focused")))}}rt&&kt.renderUtil.addClass(fe,"cell-fixrow-lastrow")}fe.style.height!==ae+"px"&&(fe.style.height=ae+"px"),fe.cellHeightProcessed=!0}var Se=we[he],bt=Se+Xe+"px";fe.style.left!==bt&&(fe.style.left=bt);var Re=be[me],Mt=Re+"px";fe.style.top!==Mt&&(fe.style.top=Mt),a._basicCellCreation(fe,m,Te,Ye),Ke&&(Ke._state.selected===!0?kt.renderUtil.addClass(fe,"prevrow-selected"):kt.renderUtil.removeClass(fe,"prevrow-selected")),Ue&&(Ue._state.selected===!0?kt.renderUtil.addClass(fe,"nextrow-selected"):kt.renderUtil.removeClass(fe,"nextrow-selected")),a.option.useClassHovering&&kt.renderUtil.removeClass(fe,"cell-hoveringrow")}}for(var y in pe)if(y){var he=y.split(",")[0],me=y.split(",")[1];if(Le[he]&&Le[he][me]){var fe=Le[he][me];fe.parentNode&&fe.parentNode.removeChild(fe)}}for(var St={},u=j.length-1;u>=0;u--)null!=j[u]?St[j[u]._index.id]=j[u]:j.splice(u,1);a.state.refreshbodycell.prevColumnIndex=T,a.state.refreshbodycell.prevRenderedIndex=D,a.state.refreshbodycell.renderedDataList=j,a.state.refreshbodycell.renderedDataIdMap=St,a.state.refreshbodycell.renderedColumnMappingList=W,a.state.refreshbodycell.renderedFixedColumnMappingList=K,a.state.refreshbodycell.renderedPinnedDataList=O,a.state.refreshbodycell.prevRowFixCount=a.option.rowFixCount,a.state.refreshbodycell.fitRatio=k,a.state.refreshbodycell.bodyCellStartX=_,a.state.refreshbodycell.bodyCellStartY=C,a.state.refreshbodycell.bodyCellEndX=w,a.state.refreshbodycell.bodyCellEndY=I,a.state.refreshbodycell.bodyCellPositionY=be,a.state.refreshbodycell.bodyCellPositionX=we,a.state.refreshbodycell.scrollEndXOffset=Oe,a.state.refreshbodycell.scrollEndYOffset=Pe,a.state.refreshbodycell.scrollxEnd=b,a.state.refreshbodycell.scrollyEnd=M,a.state.refreshbodycell.wrapperWidth=a.state.wrapperWidth,a.state.refreshbodycell.wrapperHeight=a.state.wrapperHeight,a.state.fixupto&&a.state.fixupto>0&&(we[a.state.fixupto]-=Oe),a.state.refreshbodycell.bodyCellPositionXForHeaderDrag=we,a.state.bodyHeight=Me},kt.prototype._refreshPagingUnit=function(t){var a=this;if(a._usePager()){var n={},r=a.pageInfo();for(var o in r)n[o]=r[o];if(a.option.paging&&n.pagerTotal){var l=(a.$pager,a.$pagerleft),i=a.$pagerright,d=[];if(s(n.pagerTotal))d.push(n.pagerTotal(n));else if("string"==typeof n.pagerTotal)d.push(n.pagerTotal);else if(n.pagerTotal){var u="<span>"+kt.i18n("totalCount")+" : "+n.dataLength+"</span>";d.push(u)}l.html(d.join(""))}else a.$pagerleft.empty();if(a.option.paging&&n.enabled){var i=(a.$pager,a.$pagerright),g=[];if(s(n.pagerSelect))g.push(n.pagerSelect(n));else if("string"==typeof n.pagerSelect)g.push(n.pagerSelect);else if(n.pagerSelect){var f=[];e.isArray(n.pagerSelect)?f=f.concat(n.pagerSelect):f.push(10,20,30,50,100),a.state.userSetPerPage&&(f=f.concat(a.state.userSetPerPage));for(var h=0,m=f.length;h<m;h++)f[h]=Number(f[h]);n.perPage&&e(f).index(Number(n.perPage))===-1&&(f.push(Number(n.perPage)),a.state.userSetPerPage=a.state.userSetPerPage||[],a.state.userSetPerPage.push(Number(n.perPage))),"number"!=typeof n.perPage&&isNaN(Number(n.perPage))?n.perPage=Number(f[0]):n.hasOwnProperty("perPage")&&!isNaN(Number(n.perPage))&&(n.perPage=Number(n.perPage)),f.sort(function(e,t){return e-t}),g.push('<select class="perPage">');for(var v={},x=0;x<f.length;x++){var y=parseInt(f[x]);if(v[y])return;v[y]=!0,g.push('<option value="',y,'"'),Number(y)===Number(n.perPage)&&g.push(' selected="selected"'),g.push(">",String(y),"</option>")}g.push("</select>")}i.html(g.join(""))}else a.$pagerright.empty();var C=p(a.state.paginationList),I=a.option.paging&&a.option.paging.hidePageList===!0;if(!n.rowCount&&a.option.paging&&"auto"===a.option.paging.hidePageList&&(I=!0),I?a.$pagercenter.hide():a.$pagercenter.show(),n.enabled)for(var h=0,m=C.length;h<m;h++){var _=C[h],w=_.getAttribute("data-to-page");switch(w){case"first":case"prev":case"next":case"last":if(!_.children.length||t===!0){var b=document.createElement("a");for(b.className="page-set",b.href="#"+w,b.appendChild(document.createTextNode(a.pageInfo()[w]||""));_.firstChild;)_.removeChild(_.firstChild);_.appendChild(b)}break;case"list":var M=1,S=n.total,E=Number(n.pagerCount)||5;if(a.option.currentPageInCenter&&S-M>=E)M=n.current-(E/2|0),S=M+E-1,M<1&&(M=1,S=M+E-1),S>n.total&&(S=n.total,M=n.total-E+1);else{for(S=c(S,E);S<n.current;)M+=E,S+=E;S>n.total&&(S=n.total)}for(var T=_.getElementsByTagName("li"),D=[],R=0,F=T.length;R<F;R++)D.push(T[R]);for(var k=null,L=null,A=null,R=0,F=D.length;R<F;R++){var O=D[R];if(O.children.length){var P=parseInt(O.firstChild.getAttribute("href").split("#").pop());P<M?_.removeChild(O):S<P?_.removeChild(O):M<=P&&P<=S&&(k=null===k?P:Math.min(k,P),k===P&&(L=O),A=null===A?P:Math.max(A,P),P===n.current?O.className="page-item page-button current":O.className="page-item page-button")}else _.removeChild(O)}for(var B=M;B<=S;B++)if(!(null!==k&&B>=k&&B<=A)){var O=document.createElement("li");O.setAttribute("data-alopexgrid-pagenumber",B),O.className="page-item page-button",B===n.current&&(O.className+=" current"),O.innerHTML='<a class="page-set" href="#'+B+'">'+B+"</a>",null!==k&&B<k?_.insertBefore(O,L):_.appendChild(O)}}}else for(var h=0,m=C.length;h<m;h++){var _=C[h],w=_.getAttribute("data-to-page");"list"===w&&_.children&&_.children.length&&e(_).empty()}}},kt.prototype._refreshTimerActivate=function(e){function t(){i._refreshBoard()}function a(){i._refreshBoard(),i.state.refreshTimer.basic=window.requestAnimationFrame(a)}function n(){i.state.refreshTimer.position.row=i.state.renderFromRenderedIndex,i.state.refreshTimer.position.col=i.state.renderFromRenderedIndex,i.state.refreshTimer.position.tx=i.state.translateX,i.state.refreshTimer.position.ty=i.state.translateY,i.state.refreshTimer.position.sx=i.state.scrollxEnd,i.state.refreshTimer.position.sy=i.state.scrollyEnd}function r(){return i.state.refreshTimer.position.row!=i.state.renderFromRenderedIndex||i.state.refreshTimer.position.col!=i.state.renderFromRenderedIndex||i.state.refreshTimer.position.tx!=i.state.translateX||i.state.refreshTimer.position.ty!=i.state.translateY||i.state.refreshTimer.position.sx!=i.state.scrollxEnd||i.state.refreshTimer.position.sy!=i.state.scrollyEnd}function o(){var e=r();i._refreshScrollbar(),e&&(i.state.refreshTimer.scroll&&clearTimeout(i.state.refreshTimer.scroll),i.state.refreshTimer.scroll=setTimeout(function(){i.state.refreshTimer.scrollCache&&(clearTimeout(i.state.refreshTimer.scrollCache),i.state.refreshTimer.scrollCache=null),i.state.refreshTimer.scrollCacheWorker&&(clearInterval(i.state.refreshTimer.scrollCacheWorker),i.state.refreshTimer.scrollCacheWorker=null),i._refreshBoard(),i.state.refreshTimer.scroll=null},i.option.lazyScroll.refreshDelay),i.state.refreshTimer.scrollCache&&(clearTimeout(i.state.refreshTimer.scrollCache),i.state.refreshTimer.scrollCache=null),i.state.refreshTimer.scrollCacheWorker&&(clearInterval(i.state.refreshTimer.scrollCacheWorker),i.state.refreshTimer.scrollCacheWorker=null),i.option.cellCache.enabled&&(i.state.refreshTimer.scrollCache=setTimeout(function(){i.state.refreshTimer.scrollCache=null,i.state.refreshTimer.cacheWorkerCount=0,i.state.refreshTimer.cacheWorkerLength=(i.state.refreshbodycell&&i.state.refreshbodycell.renderedDataList?i.state.refreshbodycell.renderedDataList.length:0)||20,i.state.refreshTimer.scrollCacheWorker=setInterval(function(){var e=i.state.renderTargetDataList[i.state.renderFromRenderedIndex+i.state.refreshTimer.cacheWorkerCount++];e&&i._cacheCellByData(e),(i.state.refreshTimer.cacheWorkerCount>=i.state.refreshTimer.cacheWorkerLength||!e)&&(clearInterval(i.state.refreshTimer.scrollCacheWorker),i.state.refreshTimer.scrollCacheWorker=null)},i.option.cellCache.timerInterval)},Math.ceil(.35*i.option.lazyScroll.refreshDelay)))),n()}function l(){o(),i.state.refreshTimer.basic=window.requestAnimationFrame(l)}var i=this,d=It?80:40,p=!!(i.option.useFrameSyncScroll&&s(window.requestAnimationFrame)&&s(window.cancelAnimationFrame));e===!0?(null!=i.state.refreshTimer.basic||p||(i.state.refreshTimer.basic=setInterval(t,d),i.state.refreshTimer.rafMode=!1),null==i.state.refreshTimer.basic&&p&&(i.state.refreshTimer.basic=window.requestAnimationFrame(a),i.state.refreshTimer.rafMode=!0)):e===!1?(i.state.refreshTimer.basic&&(i._refreshBoard(),i.state.refreshTimer.rafMode?window.cancelAnimationFrame(i.state.refreshTimer.basic):clearInterval(i.state.refreshTimer.basic)),i.state.refreshTimer.basic=null,i.state.refreshTimer.scroll&&clearTimeout(i.state.refreshTimer.scroll),i.state.refreshTimer.scroll=null,i.state.refreshTimer.scrollCache&&(clearTimeout(i.state.refreshTimer.scrollCache),i.state.refreshTimer.scrollCache=null),i.state.refreshTimer.scrollCacheWorker&&(clearInterval(i.state.refreshTimer.scrollCacheWorker),i.state.refreshTimer.scrollCacheWorker=null)):"scrollbarx"!==e&&"scrollbary"!==e||null==i.state.refreshTimer.basic&&(i.state.refreshTimer.position={},n(),p?(i.state.refreshTimer.basic=window.requestAnimationFrame(l),i.state.refreshTimer.rafMode=!0):(i.state.refreshTimer.basic=setInterval(o,d),i.state.refreshTimer.rafMode=!1))},kt.prototype._columnIndexOrder=function(e){return null==this.state.columnIndexArrOrderMap[e]?-1:this.state.columnIndexArrOrderMap[e]},kt.prototype._generateTranslatex=function(e){var t=this,a=0,n=0;if(null!=t.state.fixedColumnMapping&&(n=t.state.fixedColumnMapping.length),null!=t.state.standardColumnWidthMap){var r,o;for(var l in t.state.standardColumnWidthMap){if(r=t.state.standardColumnWidthMap[l],o=t.state.columnIndexArr[t._columnIndexOrder(l)-n],e<=0||o>=e)break;a+=r}}return a},kt.prototype._getColumnIndexByBlankWidth=function(e,t){var a=this,n=0,r=0,o=0;if(null!=a.state.fixedColumnMapping&&(o=a.state.fixedColumnMapping.length),null!=a.state.standardColumnWidthMap)for(var l in a.state.standardColumnWidthMap)if(n+=a.state.standardColumnWidthMap[l],n*a.state.scrollxRatio>=e){if(r=a.state.columnIndexArr[a._columnIndexOrder(l)-o],null==r&&(r=a.state.columnIndexArr[0]),t===!0)return-((n-a.state.standardColumnWidthMap[l])*a.state.scrollxRatio-e)/a.state.scrollxRatio;break}return r},kt.prototype.__getRenderedIndexByBlankHeight=function(e,t){var a=this,n=a.state,o=n.pagingInfo,l=Math.max(o.pageRowCount,a.option.rowPadding>0?a.option.rowPadding:0),i=n.renderTargetDataList,d=n.rowHeightMapByDataId,s=0,p=0,u=0,c=n.renderFromRenderedIndex;if(s=It?r(d):Object.keys(d).length,0===s){if(c=Math.floor(e/(a.state.scrollyRatio*a.state.rowHeight)),t===!0){var g=e/(a.state.scrollyRatio*a.state.rowHeight)-c;return a.state.rowHeight*g}return c}for(var f=0;f<l;f++){var h=i[f],m=0;if(m=h&&h._index&&d[h._index.id]?d[h._index.id]:n.rowHeight,p+=m,c=f,u=Math.ceil(n.scrollyRatio*p*n.scrollRatioConst)/n.scrollRatioConst,u>=e){if(t===!0){var g=m*a.state.scrollyRatio,v=a.state.scrollyRatio*(p-m);return Math.ceil((e-v)/a.state.scrollyRatio)}break}}return c},kt.prototype.__getRowHeightByRenderedIdx=function(e){var t=this,a=t.state,n=(t.pageInfo(),e),r=a.rowHeightMapByDataId,o=0;if(e<=0)return o;if(r)for(var l in r){var i=a.dataMapById[l];i&&null!=i._index.row&&i._index.row<e&&(o+=r[l],n-=1)}return n>0&&(o+=n*a.rowHeight),o},kt.prototype.__getAllRowHeight=function(){var e=this,t=e.state,a=e.pageInfo(),n=a.pageRowCount,r=t.rowHeightMapByDataId,o=0;if(r)for(var l in r){var i=t.dataMapById[l];i&&null!=i._index.row&&(o+=r[l],n-=1)}return o+=n*t.rowHeight};var Gt={string:!0,number:!0};kt.prototype._columnShowFromEnabled=function(){if(this.option.disableScrolledFix===!0)return!1;var e=typeof this.option.columnFixUpto,t=typeof this.option.columnFixShowFrom;return!(!Gt[e]||!Gt[t])},kt.prototype._limitRenderFromByFixCount=function(){var e=this;if(e.state.columnFixShowFromColumnIndex=null,!e.option.disableScrolledFix&&(null!=e.option.rowFixShowFrom&&e.option.rowFixCount&&(e.state.renderFromRenderedIndex=Math.max(e.state.renderFromRenderedIndex,e.option.rowFixShowFrom)),e._columnShowFromEnabled())){var t=e._columnIndexKeyToMappingList(e.option.columnFixUpto)[0],a=e._columnIndexKeyToMappingList(e.option.columnFixShowFrom)[0];t&&a&&(e.state.renderFromColumnIndex=Math.max(e.state.renderFromColumnIndex,a.columnIndex),e.state.columnFixShowFromColumnIndex=a.columnIndex)}},kt.prototype._setScrollInfo=function(){var t=this;if(t.state.renderTargetMappingInfo=t._generateRenderTargetMapping(),0==t.state.renderTargetDataList.length)return t.state.renderFromRenderedIndex=0,void(t.state.translateY=0);t._limitRenderFromByFixCount();var a=0;if(t.state.scrollxEnd===!0){if(t.state.wrapperWidth>=t.state.columnWidth)t.state.scrollxMoveable=!1,t.state.renderFromColumnIndex=t.state.columnIndexArr[0],a=0;else{t.state.scrollxRatio=t.state.wrapperWidth/t.state.columnWidth;var n=t.state.scrollbarxTrackLength*t.state.scrollxRatio;a=t.state.scrollbarxTrackLength-n,t.state.renderFromColumnIndex=t._getColumnIndexByBlankWidth(a)}}else if(t.state.wrapperWidth>=t.state.columnWidth)t.state.renderFromColumnIndex=t.state.columnIndexArr[0],a=0;else{var r=t._columnIndexOrder(t.state.renderFromColumnIndex);for(t.state.scrollxRatio=t.state.wrapperWidth/t.state.columnWidth;r<0&&null!=t.state.prevColumnIndexArr;){if(t.state.renderFromColumnIndex=t.state.prevColumnIndexArr[e.inArray(t.state.renderFromColumnIndex,t.state.prevColumnIndexArr)+1],null==t.state.renderFromColumnIndex){t.state.renderFromColumnIndex=t.state.columnIndexArr[0];break}r=t._columnIndexOrder(t.state.renderFromColumnIndex)}var o=t.state.renderTargetMappingInfo;if(o.renderTargetWidth<t.state.wrapperWidth&&t.state.renderFromColumnIndex!==t.state.columnIndexArr[0]){for(var l=t.state.wrapperWidth-o.renderTargetWidth;--t.state.renderFromColumnIndex>0;)if(l-=t.state.columnWidthMap[t.state.renderFromColumnIndex]||0,l<0){t.state.scrollxEnd=!0;break}t.state.renderFromColumnIndex<=0&&(t.state.renderFromColumnIndex=t.state.columnIndexArr[0],t.state.scrollxEnd=!1)}a=t._generateTranslatex(t.state.renderFromColumnIndex)*t.state.scrollxRatio,t.option.useContinuousXScroll&&t.state.refreshbodycell&&!t.state.scrollxEnd&&(a+=Math.abs(t.state.refreshbodycell.scrollEndXOffset||0)*t.state.scrollxRatio);
}t.state.translateX=a;var i=0,d=Math.max(t.option.rowPadding>0?t.option.rowPadding:0,t.state.renderTargetDataList.length);if(t.state.renderFromRenderedIndex-1>d)t.state.renderFromRenderedIndex=0,t.state.scrollyEnd=!1;else{if(0===t.state.renderFromRenderedIndex)i=0,t.state.refreshbodycell?t.state.refreshbodycell.scrollEndYOffset=0:null;else if(t.state.scrollyEnd)i=t.state.scrollbaryTrackLength-t.state.scrollbaryHeight;else{if(t.state.refreshbodycell&&t.state.refreshbodycell.scrollyEnd&&t.state.refreshbodycell.scrollEndYOffset<0){var s=t.state.refreshbodycell.renderedPinnedDataList.length,p=t.state.refreshbodycell.bodyCellPositionY[s+1]-t.state.refreshbodycell.bodyCellPositionY[s];if(Math.abs(t.state.refreshbodycell.scrollEndYOffset)>p/2&&(t.state.renderFromRenderedIndex+=1,t.state.renderFromRenderedIndex>=d)){var u=t.state.scrollbaryTrackLength-t.state.scrollbaryHeight;t.state.renderFromRenderedIndex=t.__getRenderedIndexByBlankHeight(u)}t.state.refreshbodycell.scrollEndYOffset=0}var c=t.__getRowHeightByRenderedIdx(t.state.renderFromRenderedIndex);i=Math.ceil(t.state.scrollyRatio*c*t.state.scrollRatioConst)/t.state.scrollRatioConst,t.option.useContinuousYScroll&&t.state.refreshbodycell&&!t.state.scrollyEnd&&(i=t.state.scrollyRatio*c,i+=Math.abs(t.state.refreshbodycell.scrollEndYOffset||0)*t.state.scrollyRatio),i>=t.state.scrollbaryTrackLength-t.state.scrollbaryHeight&&(t.state.scrollyEnd=!0)}if(t.state.scrollyEnd){i=t.state.scrollbaryTrackLength-t.state.scrollbaryHeight;for(var g=t.state.renderTargetDataList.length,f=t.state.wrapperHeight-t.state.headerHeight-t.state.footerHeight;f>0&&g>0;){var h=t._getRowHeight(t.state.renderTargetDataList[--g]);f-=h}t.state.renderFromRenderedIndex=Math.max(0,g),t.state.renderFromRenderedIndex<=0&&(t.state.scrollyEnd=!1,i=0)}}t.state.translateY=i},kt.prototype._scrollRightEvent=function(e,t){var a=this;if(a.state.hasHorizontalScrollbar){null==t&&(t=!0);var n=0,r=0;a.state.scrollxEnd||a.state.wrapperWidth>=a.state.standardColumnWidth||(r=a.state.columnIndexArr[a._columnIndexOrder(a.state.renderFromColumnIndex)+e],n=a._generateTranslatex(r)*a.state.scrollxRatio,n>=a.state.scrollbarxTrackLength-a.state.scrollbarxWidth?(a.state.scrollxEnd=!0,n=a.state.scrollbarxTrackLength-a.state.scrollbarxWidth,a.state.renderFromColumnIndex=a._getColumnIndexByBlankWidth(n)):a.state.renderFromColumnIndex=r,a.state.translateX=n,t&&a._refreshBoard())}},kt.prototype._scrollLeftMostEvent=function(e){return this._scrollLeftEvent(1/0,e)},kt.prototype._scrollLeftEvent=function(e,t){var a=this;if(a.state.hasHorizontalScrollbar){null==t&&(t=!0);var n=0,r=a.state.columnIndexArr[a._columnIndexOrder(a.state.renderFromColumnIndex)-e];null==r||e===1/0?(n=0,a.state.renderFromColumnIndex=a.state.columnIndexArr[0]):(n=a._generateTranslatex(r)*a.state.scrollxRatio,a.state.renderFromColumnIndex=r),a.state.scrollxEnd=!1,a.state.translateX=n,t&&a._refreshBoard()}},kt.prototype._scrollTopEvent=function(e){return this._scrollUpEvent(this.state.renderFromRenderedIndex,e)},kt.prototype._scrollUpEvent=function(e,t){var a=this;if(null==t&&(t=!0),a.state.hasVerticalScrollbar){if(a.state.scrollyEnd=!1,a.state.renderFromRenderedIndex=Math.max(0,a.state.renderFromRenderedIndex-e),0===a.state.renderFromRenderedIndex)a.state.translateY=0;else{var n=a.__getRowHeightByRenderedIdx(a.state.renderFromRenderedIndex);translateY=Math.ceil(a.state.scrollyRatio*n*a.state.scrollRatioConst)/a.state.scrollRatioConst,a.state.translateY=translateY}t&&a._refreshBoard()}},kt.prototype._scrollDownEvent=function(e,t){var a=this,n=0;if(null==t&&(t=!0),!a.state.scrollyEnd&&a.state.hasVerticalScrollbar){var r=a.__getRowHeightByRenderedIdx(a.state.renderFromRenderedIndex+e);n=Math.ceil(a.state.scrollyRatio*r*a.state.scrollRatioConst)/a.state.scrollRatioConst,n>=a.state.scrollbaryTrackLength-a.state.scrollbaryHeight?(a.state.scrollyEnd=!0,n=a.state.scrollbaryTrackLength-a.state.scrollbaryHeight,a.state.renderFromRenderedIndex=a.__getRenderedIndexByBlankHeight(n)):a.state.renderFromRenderedIndex+=e,a.state.translateY=n,t&&a._refreshBoard()}},kt.prototype._activateBoardScrollEvent=function(){function t(){var e,t=u.state.columnWidth-u.state.wrapperWidth,a=0;for(var n in u.state.standardColumnWidthMap)if(e=u.state.standardColumnWidthMap[n],a+=e,a>t){a-=e,u.state.lastScrollxPixcel=t-a-u.state.scrollbaryWidth;break}return u.state.lastScrollxPixcel}function a(e,a){var n=Math.ceil(Math.abs(e)/100),r=0,o=0;if(e>=0){if(u.state.scrollxEnd)return;o=u.state.columnIndexArr[u._columnIndexOrder(u.state.renderFromColumnIndex)+n],r=u._generateTranslatex(o)*u.state.scrollxRatio,r>=u.state.scrollbarxTrackLength-a?(u.state.scrollxEnd=!0,r=u.state.scrollbarxTrackLength-a,u.state.renderFromColumnIndex=u._getColumnIndexByBlankWidth(r)):u.state.renderFromColumnIndex=o,u.state.translateX=r}else{if(u.state.scrollxEnd){var l=t();r=u.state.scrollbarxTrackLength-(a+l*u.state.scrollxRatio)}else o=u.state.columnIndexArr[u._columnIndexOrder(u.state.renderFromColumnIndex)-n],null==o?(r=0,u.state.renderFromColumnIndex=u.state.columnIndexArr[0]):(r=u._generateTranslatex(o)*u.state.scrollxRatio,u.state.renderFromColumnIndex=o);u.state.scrollxEnd=!1,u.state.translateX=r}return!0}function n(e,t){var a=Math.ceil(Math.abs(e)/100);if(e>=0){if(u.state.scrollyEnd)return;var n=u.__getRowHeightByRenderedIdx(u.state.renderFromRenderedIndex+a);translateY=Math.ceil(u.state.scrollyRatio*n*u.state.scrollRatioConst)/u.state.scrollRatioConst,translateY>=Math.ceil(u.state.scrollbaryTrackLength-t)?(u.state.scrollyEnd=!0,translateY=Math.ceil(u.state.scrollbaryTrackLength-t),u.state.renderFromRenderedIndex=u.__getRenderedIndexByBlankHeight(translateY)):u.state.renderFromRenderedIndex+=a,u.state.translateY=translateY}else{u.state.renderFromRenderedIndex=Math.max(0,u.state.renderFromRenderedIndex-a),u.state.scrollyEnd=!1;var n=u.__getRowHeightByRenderedIdx(u.state.renderFromRenderedIndex);translateY=Math.ceil(u.state.scrollyRatio*n*u.state.scrollRatioConst)/u.state.scrollRatioConst,0===u.state.renderFromRenderedIndex?u.state.translateY=0:u.state.translateY=translateY}return!0}function r(e,t,a,n){var r=n.width(),o=e.data.scrollxHandlePosition;e.data.scrollbarxStartPosition,e.data.startPositionXDff;a.state.scrollxEnd=!1;var l=o+(e.data.startPageX-t.pageX)*a.state.scrollxRatio;l<=0?(a.state.renderFromColumnIndex=a.state.columnIndexArr[0],a.state.translateX=0):l+r>=a.state.scrollbarxTrackLength?(a.state.scrollxEnd=!0,a.state.translateX=a.state.scrollbarxTrackLength-r,a.state.renderFromColumnIndex=a._getColumnIndexByBlankWidth(a.state.translateX)):(a.state.renderFromColumnIndex=a._getColumnIndexByBlankWidth(l),a.state.translateX=l)}function o(e,t,a,n){var r=n.height(),o=e.data.scrollyHandlePosition;e.data.scrollbaryStartPosition,e.data.startPositionYDff;a.state.scrollyEnd=!1;var l=o+(e.data.startPageY-t.pageY)*a.state.scrollyRatio;l<=0?(a.state.renderFromRenderedIndex=0,a.state.translateY=0):l+r>=a.state.scrollbaryTrackLength?(a.state.scrollyEnd=!0,a.state.translateY=Math.ceil(a.state.scrollbaryTrackLength-r),a.state.renderFromRenderedIndex=a.__getRenderedIndexByBlankHeight(a.state.translateY)):(a.state.renderFromRenderedIndex=a.__getRenderedIndexByBlankHeight(l),a.state.translateY=l)}function l(e,t,a,n,r,o){var l,i=0;if(e>t){if(u.state.scrollxEnd)return;l=u._getProcessedPageRightLength()*n;var d=u.state.columnIndexArr[u._columnIndexOrder(u.state.renderFromColumnIndex)+l];d>=r?(i=o,i>=u.state.scrollbarxTrackLength-a?(u.state.scrollxEnd=!0,i=u.state.scrollbarxTrackLength-a,u.state.renderFromColumnIndex=u._getColumnIndexByBlankWidth(i)):u.state.renderFromColumnIndex=r):(i=u._generateTranslatex(d)*u.state.scrollxRatio,i>=u.state.scrollbarxTrackLength-a?(u.state.scrollxEnd=!0,i=u.state.scrollbarxTrackLength-a,u.state.renderFromColumnIndex=u._getColumnIndexByBlankWidth(i)):u.state.renderFromColumnIndex=d),u.state.translateX=i}else{u.state.scrollxEnd=!1,l=u._getProcessedPageLeftLength()*n;var s=Math.max(0,u._columnIndexOrder(u.state.renderFromColumnIndex)-l),p=u.state.columnIndexArr[s];null==p||isNaN(p)?(u.state.renderFromColumnIndex=u.state.columnIndexArr[0],i=0):r>=p?(u.state.renderFromColumnIndex=r,i=o):(u.state.renderFromColumnIndex=p,i=u._generateTranslatex(p)*u.state.scrollxRatio),0===u.state.renderFromColumnIndex?u.state.translateX=0:u.state.translateX=i}var c=u.option.useContinuousXScroll;u.option.useContinuousXScroll=!1,u._refreshBoard(),u.option.useContinuousXScroll=c}function i(e,a){var n=0,r=0;if(e.attr("class").indexOf("leftbutton")==-1){if(u.state.scrollxEnd)return;r=u.state.columnIndexArr[u._columnIndexOrder(u.state.renderFromColumnIndex)+1],n=u._generateTranslatex(r)*u.state.scrollxRatio,n>=u.state.scrollbarxTrackLength-a?(u.state.scrollxEnd=!0,n=u.state.scrollbarxTrackLength-a,u.state.renderFromColumnIndex=u._getColumnIndexByBlankWidth(n)):u.state.renderFromColumnIndex=r,u.state.translateX=n}else{if(u.state.scrollxEnd){var o=t();n=u.state.scrollbarxTrackLength-(a+o*u.state.scrollxRatio)}else r=u.state.columnIndexArr[u._columnIndexOrder(u.state.renderFromColumnIndex)-1],null==r?(n=0,u.state.renderFromColumnIndex=u.state.columnIndexArr[0]):(n=u._generateTranslatex(r)*u.state.scrollxRatio,u.state.renderFromColumnIndex=r);u.state.scrollxEnd=!1,u.state.translateX=n}var l=u.option.useContinuousXScroll;u.option.useContinuousXScroll=!1,u._refreshBoard(),u.option.useContinuousXScroll=l}function d(e,t,a,n,r,o){var l,i=0;if(e>t){if(u.state.scrollyEnd)return;l=u._getProcessedPageDownLength()*n;var d=u.state.renderFromRenderedIndex+l;if(d>=r)i=o,i>=u.state.scrollbaryTrackLength-a?(u.state.scrollyEnd=!0,i=Math.ceil(u.state.scrollbaryTrackLength-a),u.state.renderFromRenderedIndex=u.__getRenderedIndexByBlankHeight(i)):u.state.renderFromRenderedIndex=r;else{var s=u.__getRowHeightByRenderedIdx(d);i=Math.ceil(u.state.scrollyRatio*s*u.state.scrollRatioConst)/u.state.scrollRatioConst,i>=u.state.scrollbaryTrackLength-a?(u.state.scrollyEnd=!0,i=Math.ceil(u.state.scrollbaryTrackLength-a),u.state.renderFromRenderedIndex=u.__getRenderedIndexByBlankHeight(i)):u.state.renderFromRenderedIndex=d}u.state.translateY=i}else{u.state.scrollyEnd=!1,l=u._getProcessedPageUpLength()*n;var p=Math.max(0,u.state.renderFromRenderedIndex-l);if(r>=p)u.state.renderFromRenderedIndex=r,i=o;else{u.state.renderFromRenderedIndex=p;var s=u.__getRowHeightByRenderedIdx(u.state.renderFromRenderedIndex);i=Math.ceil(u.state.scrollyRatio*s*u.state.scrollRatioConst)/u.state.scrollRatioConst}0===u.state.renderFromRenderedIndex?u.state.translateY=0:u.state.translateY=i}var c=u.option.useContinuousYScroll;u.option.useContinuousYScroll=!1,u._refreshBoard(),u.option.useContinuousYScroll=c}function s(){for(var e=u.state.wrapperHeight-u.state.headerHeight-u.state.footerHeight+u.state.scrollbarxHeight,t=u.state.refreshbodycell.renderedDataList,a=0,n=u.state.rowHeightMapByDataId,r=0,o=t.length;r<o;r++){var l=t[r],i=n[l._index.id];a+=null!=i?i:u.state.rowHeight}return Math.max(0,a-e)}function p(e,t){var a=0;if(e.attr("class").indexOf("upbutton")==-1){if(u.state.scrollyEnd)return;var n=u.__getRowHeightByRenderedIdx(u.state.renderFromRenderedIndex+1);a=Math.ceil(u.state.scrollyRatio*n*u.state.scrollRatioConst)/u.state.scrollRatioConst,a>=u.state.scrollbaryTrackLength-t?(u.state.scrollyEnd=!0,a=Math.ceil(u.state.scrollbaryTrackLength-t),u.state.renderFromRenderedIndex=u.__getRenderedIndexByBlankHeight(a)):u.state.renderFromRenderedIndex+=1,u.state.translateY=a}else{if(!u.state.scrollyEnd&&0===u.state.renderFromRenderedIndex)return;if(u.state.scrollyEnd){var r=s();if(0===r){var n=u.__getRowHeightByRenderedIdx(u.state.renderFromRenderedIndex-1);u.state.renderFromRenderedIndex=Math.max(0,u.state.renderFromRenderedIndex-1),a=Math.ceil(u.state.scrollyRatio*n*u.state.scrollRatioConst)/u.state.scrollRatioConst}else{var n=u.__getRowHeightByRenderedIdx(u.state.renderFromRenderedIndex);a=Math.ceil(u.state.scrollyRatio*n*u.state.scrollRatioConst)/u.state.scrollRatioConst}}else{var n=u.__getRowHeightByRenderedIdx(u.state.renderFromRenderedIndex-1);u.state.renderFromRenderedIndex=Math.max(0,u.state.renderFromRenderedIndex-1),a=Math.ceil(u.state.scrollyRatio*n*u.state.scrollRatioConst)/u.state.scrollRatioConst}u.state.scrollyEnd=!1,0===u.state.renderFromRenderedIndex?u.state.translateY=0:u.state.translateY=a}var o=u.option.useContinuousYScroll;u.option.useContinuousYScroll=!1,u._refreshBoard(),u.option.useContinuousYScroll=o}var u=this,c=".alopexgridScrollbarEvent";xt.off(c+u.key),u.$scrollbarx.off(c),u.$scrollbary.off(c),u.$wrapper.off(c);var g=u.$scrollbarx.find(".scrollhandle"),f=u.$scrollbary.find(".scrollhandle"),h=u.$scrollbarLeftButton,m=u.$scrollbarUpButton,v="mousedown";yt&&(v="touchstart"),u.$wrapper.on((It?"mousewheel":"wheel")+c,{self:u},function(e){var t=e.data.self;if(null!=e.originalEvent&&(null==e.target||"SELECT"!==e.target.nodeName)){var r,o,l=e.originalEvent.deltaX,i=It?parseInt(e.originalEvent.wheelDelta*-.025):e.originalEvent.deltaY;t.state.hasHorizontalScrollbar&&t.state.scrollxMoveable&&0!==l&&(t.option.preventScrollPropagation===!0?(e.preventDefault(),e.stopPropagation()):l>0&&t.state.scrollxEnd||l<0&&0===t.state.renderFromColumnIndex||(e.preventDefault(),e.stopPropagation()),r=a(l,t.state.scrollbarxWidth)),t.state.hasVerticalScrollbar&&t.state.scrollyMoveable&&0!==i&&(t.option.preventScrollPropagation===!0?(e.preventDefault(),e.stopPropagation()):i>0&&t.state.scrollyEnd||i<0&&0===t.state.renderFromRenderedIndex||(e.preventDefault(),e.stopPropagation()),o=n(i,t.state.scrollbaryHeight)),r!==!0&&o!==!0||t._refreshBoard()}}),yt&&u.$wrapper.on("touchstart"+c,{self:u},function(t){if(null!=t.originalEvent){var a=t.target.className;if(!(a.indexOf("scrollbar")>=0||a.indexOf("scrollbutton")>=0||a.indexOf("scrollhandle")>=0||a.indexOf("resizing-handle")>=0||a.indexOf("header-dragdrop-handle")>=0||a.indexOf("row-dragdrop-handle")>=0)){var n=t.data.self;$target=e(t.target),$target.off(c+n.key);var l=t.originalEvent.touches[0],i=l.pageX,d=h.offset().left+h.width(),s=g.offset().left-d,p=i-d,u=l.pageY,v=m.offset().top+m.height(),x=f.offset().top-v,y=u-v,C={};C.self=n,C.startPageX=i,C.scrollxHandlePosition=s,C.scrollbarxStartPosition=d,C.startPositionXDff=p,C.startPageY=u,C.scrollyHandlePosition=x,C.scrollbaryStartPosition=v,C.startPositionYDff=y,n._refreshTimerActivate(!0),$target.on("touchmove"+c+n.key,C,function(e){if(e.cancelable!==!1){var t,a,n=e.data.self,l=e.originalEvent.touches[0],i=l.pageX-e.data.startPageX,d=l.pageY-e.data.startPageY,s=Math.abs(i),p=Math.abs(d);s>p?(t=!0,a=!1):(t=!1,a=!0),t&&n.state.hasHorizontalScrollbar&&n.state.scrollxMoveable&&(n.option.preventScrollPropagation===!0?(e.preventDefault(),e.stopPropagation()):i<0&&n.state.scrollxEnd||i>0&&0===n.state.renderFromColumnIndex||(e.preventDefault(),e.stopPropagation())),a&&n.state.hasVerticalScrollbar&&n.state.scrollyMoveable&&(n.option.preventScrollPropagation===!0?(e.preventDefault(),e.stopPropagation()):d<0&&n.state.scrollyEnd||d>0&&0===n.state.renderFromRenderedIndex||(e.preventDefault(),e.stopPropagation())),t&&l&&n.state.scrollxMoveable&&r(e,l,n,g),a&&l&&n.state.scrollyMoveable&&o(e,l,n,f)}}),$target.on("touchend"+c+n.key+" touchcancel"+c+n.key,{self:n},function(t){var a=t.data.self;a._refreshTimerActivate(!1),e(this).off(c+a.key)})}}}),u.$scrollbarx.on(v+c,{self:u},function(e){var t=e;"touchstart"===e.type&&(t=e.originalEvent.touches[0]);var a=e.data.self;if(a.state.scrollxMoveable&&e.target===this&&(yt!==!1||3!==e.which)){xt.off(c+a.key),a.state.isScrollyMoving=!1;var n=t.pageX;yt&&t.pageX===t.clientX&&(n+=xt.scrollLeft());var r=a.state.scrollbarxWidth,o=h.offset().left+h.width(),i=g.offset().left+r,d=1,s=n-o-r/2,p=a._getColumnIndexByBlankWidth(s);l(n,i,r,d,p,s);var u=null,f=null;u=setTimeout(function(){f=setInterval(function(){i=g.offset().left+r,i-n>0&&i-n<=r||a.state.renderFromColumnIndex!==p&&(l(n,i,a.state.scrollbarxWidth,d,p,s),a.option.useScrollAcceleration===!0&&d++)},50),u=null},200),H(function(){setTimeout(function(){N(),xt.trigger("__alopexgridscrollxend"+a.key)},0)}),xt.on("selectstart"+c+a.key+a.eventns,function(e){e.preventDefault()}),xt.on("mouseup"+c+a.key+a.eventns+" touchend"+c+a.key+a.eventns+" touchcancel"+c+a.key+a.eventns+" __alopexgridscrollxend"+a.key+c+a.key,{self:a},function(e){var t=e.data.self;u&&(clearTimeout(u),u=null),f&&(clearInterval(f),f=null),xt.off(c+t.key),Se(t)&&Xe(t)})}}),u.$scrollbarx.on(v+c,".scrollhandle",{self:u},function(e){var t=e.data.self;if(t.state.scrollxMoveable&&(yt!==!1||3!==e.which)){xt.off(c+t.key),t.state.isScrollyMoving=!1;var a=e;"touchstart"===e.type&&(a=e.originalEvent.touches[0]);var n=a.pageX,r=h.offset().left+h.width(),o=g.offset().left-r,l=n-r;H(function(){setTimeout(function(){N(),xt.trigger("__alopexgridscrollxend"+t.key)},0)}),t._refreshTimerActivate(!t.option.lazyScroll||!t.option.lazyScroll.enabled||"scrollbarx");var i={self:t,scrollxHandlePosition:o,scrollbarxStartPosition:r,startPositionDff:l};xt.on("selectstart"+c+t.key+t.eventns,function(e){e.preventDefault()}),xt.on("mousemove"+c+t.key+t.eventns+" touchmove"+c+t.key+t.eventns,i,function(e){e.preventDefault();var t=e.data.self,a=e;"touchmove"===e.type&&(a=e.originalEvent.touches[0]);var n=g.width(),r=e.data.scrollxHandlePosition,o=e.data.scrollbarxStartPosition,l=e.data.startPositionDff;t.state.scrollxEnd=!1;var i=a.pageX-l-o+r;i<=0?(t.state.renderFromColumnIndex=t.state.columnIndexArr[0],t.state.translateX=0):i+n>=t.state.scrollbarxTrackLength?(t.state.scrollxEnd=!0,t.state.translateX=t.state.scrollbarxTrackLength-n,t.state.renderFromColumnIndex=t._getColumnIndexByBlankWidth(t.state.translateX)):(t.state.renderFromColumnIndex=t._getColumnIndexByBlankWidth(i),t.state.translateX=i)}).on("mouseup"+c+t.key+" touchend"+c+t.key+" touchcancel"+c+t.key+" __alopexgridscrollxend"+t.key+c+t.key,{self:t},function(e){var t=e.data.self;t._refreshTimerActivate(!1),xt.off(c+t.key),Se(t)&&Xe(t)})}}),u.$scrollbarx.on(v+c,".scrollbutton",{self:u},function(t){var a=t.data.self;if(a.state.scrollxMoveable&&(yt!==!1||3!==t.which)){xt.off(c+a.key);var n=e(t.target);a.state.isScrollyMoving=!1,i(n,a.state.scrollbarxWidth);var r=null,o=null;r=setTimeout(function(){o=setInterval(function(){i(n,a.state.scrollbarxWidth)},50),r=null},200),H(function(){setTimeout(function(){N(),xt.trigger("__alopexgridscrollxend"+a.key)},0)}),xt.on("selectstart"+c+a.key+a.eventns,function(e){e.preventDefault()}),xt.on("mouseup"+c+a.key+a.eventns+" touchend"+c+a.key+a.eventns+" touchcancel"+c+a.key+a.eventns+" __alopexgridscrollxend"+a.key+c+a.key,{self:a},function(e){r&&(clearTimeout(r),r=null),o&&(clearInterval(o),o=null),xt.off(c+e.data.self.key),Se(a)&&Xe(a)})}}),u.$scrollbary.on(v+c,{self:u},function(e){var t=e;"touchstart"===e.type&&(t=e.originalEvent.touches[0]);var a=e.data.self;if(a.state.scrollyMoveable&&e.target===this&&(yt!==!1||3!==e.which)){xt.off(c+a.key),a.state.isScrollyMoving=!1;var n=t.pageY;yt&&t.pageY===t.clientY&&(n+=xt.scrollTop());var r=a.state.scrollbaryHeight,o=m.offset().top+m.height(),l=f.offset().top+r,i=1,s=n-o-r/2,p=a.__getRenderedIndexByBlankHeight(s);d(n,l,r,i,p,s);var u=null,g=null;u=setTimeout(function(){g=setInterval(function(){l=f.offset().top+r,l-n>0&&l-n<=r||a.state.renderFromRenderedIndex!==p&&(d(n,l,r,i,p,s),a.option.useScrollAcceleration===!0&&i++)},50),u=null},200),H(function(){setTimeout(function(){N(),xt.trigger("__alopexgridscrollyend"+a.key)},0)}),xt.on("selectstart"+c+a.key+a.eventns,function(e){e.preventDefault()}),xt.on("mouseup"+c+a.key+a.eventns+" touchend"+c+a.key+a.eventns+" touchcancel"+c+a.key+a.eventns+" __alopexgridscrollyend"+a.key+c+a.key,{self:a},function(e){var t=e.data.self;u&&clearTimeout(u),g&&clearInterval(g),xt.off(c+t.key),Se(t)&&Xe(t)})}}),u.$scrollbary.on(v+c,".scrollhandle",{self:u},function(e){if(null!=e.originalEvent){var t=e.data.self;if(t.state.scrollyMoveable&&(yt!==!1||3!==e.which)){xt.off(c+t.key),t.state.isScrollyMoving=!0;var a=e;"touchstart"===e.type&&(a=e.originalEvent.touches[0]);var n=a.pageY,r=m.offset().top+m.height(),o=f.offset().top-r,l=n-r,i=Math.ceil(t.state.scrollbaryTrackLength-f.height());H(function(){setTimeout(function(){N(),xt.trigger("__alopexgridscrollyend"+t.key)},0)}),t._refreshTimerActivate(!t.option.lazyScroll||!t.option.lazyScroll.enabled||"scrollbary");var d={self:t,scrollyHandlePosition:o,scrollbaryStartPosition:r,startPositionDff:l,maxBlankHeight:i};xt.on("selectstart"+c+t.key+t.eventns,function(e){e.preventDefault()}),xt.on("mousemove"+c+t.key+t.eventns+" touchmove"+c+t.key+t.eventns,d,function(e){e.preventDefault();var t=e.data.self,a=e;"touchmove"===e.type&&(a=e.originalEvent.touches[0]);var n=f.height(),r=e.data.scrollyHandlePosition,o=e.data.scrollbaryStartPosition,l=e.data.startPositionDff,i=e.data.maxBlankHeight;t.state.scrollyEnd=!1;var d=a.pageY-l-o+r;d<=0?(t.state.renderFromRenderedIndex=0,t.state.translateY=0):d+n>=t.state.scrollbaryTrackLength?(t.state.scrollyEnd=!0,t.state.translateY=i,t.state.renderFromRenderedIndex=t.__getRenderedIndexByBlankHeight(t.state.translateY)):(t.state.renderFromRenderedIndex=t.__getRenderedIndexByBlankHeight(d),t.state.translateY=d)}).on("mouseup"+c+t.key+" touchend"+c+t.key+" touchcancel"+c+t.key+" __alopexgridscrollyend"+t.key+c+t.key,{self:t},function(e){var t=e.data.self;t._refreshTimerActivate(!1),xt.off(c+t.key),Se(t)&&Xe(t)})}}}),u.$scrollbary.on(v+c,".scrollbutton",{self:u},function(t){var a=t.data.self;if(a.state.scrollyMoveable&&t.target===this&&(yt!==!1||2!==t.button)){var n=e(t.target);xt.off(c+a.key),a.state.isScrollyMoving=!0,p(n,a.state.scrollbaryHeight);var r=null,o=null;r=setTimeout(function(){o=setInterval(function(){p(n,a.state.scrollbaryHeight)},It?80:40),r=null},200),H(function(){setTimeout(function(){N(),xt.trigger("__alopexgridscrollyend"+a.key)},0)}),xt.on("selectstart"+c+a.key+a.eventns,function(e){e.preventDefault()}),xt.on("mouseup"+c+a.key+a.eventns+" touchend"+c+a.key+a.eventns+" touchcancel"+c+a.key+a.eventns+" __alopexgridscrollyend"+a.key+c+a.key+a.eventns,{self:a},function(e){var t=e.data.self;r&&(clearTimeout(r),e.data.scrollbaryTimer=null),o&&(clearInterval(o),o=null),xt.off(c+t.key),Se(t)&&Xe(t)})}})},kt.prototype._refreshScrollbar=function(t){var a=this;a.state.scrollRatioConst=1e3,a._limitRenderFromByFixCount();var n=a.$scrollbarx.find(".scrollhandle"),r=a.$scrollbarx.find(".leftbutton");if(a.state.scrollxMoveable=!0,a.state.columnWidth<=a.state.wrapperWidth)n.width(a.state.scrollbarxTrackLength),a.state.scrollbarxWidth=n.width(),a.state.scrollxMoveable=!1,a.state.translateX=0,a.state.scrollxRatio=0,a.state.renderFromColumnIndex=a.state.columnIndexArr[0];else{a.state.scrollxRatio=a.state.wrapperWidth/a.state.columnWidth;var o=a.state.scrollbarxTrackLength*a.state.scrollxRatio,l=2*r.width();if(l>o){var i=l-o;o=l,a.state.scrollxRatio=(a.state.wrapperWidth-i)/a.state.columnWidth}n.width(o),a.state.scrollbarxWidth=o}var d=a.$scrollbary.find(".scrollhandle"),s=a.$scrollbary.find(".upbutton");a.state.scrollyMoveable=!0;var p=a.state.wrapperHeight-a.state.headerHeight-a.state.footerHeight,u=a.__getAllRowHeight(),c=a.state.renderTargetDataList.length;if(!c&&a.option.message&&(a.option.message.nodata||null!=a.state.filteredDataList&&0===a.state.filteredDataList.length&&a.option.message.noFilteredData)&&(u+=a.state.rowHeight,c+=1),a.option.rowPadding>0&&c<a.option.rowPadding&&(u+=a.state.rowHeight*(a.option.rowPadding-c)),u<=p)d.height(a.state.scrollbaryTrackLength),a.state.scrollbaryHeight=d.height(),a.state.scrollyMoveable=!1,a.state.translateY=0,a.state.scrollyRatio=0;else{var g=u+a.state.headerHeight+a.state.footerHeight-2*s.height();a.state.scrollyRatio=a.state.scrollbaryTrackLength/g;var f=a.state.scrollbaryTrackLength*a.state.scrollyRatio,h=2*s.height();if(h>f)if(h>=a.state.scrollbaryTrackLength){var m=.6*a.state.scrollbaryTrackLength;a.state.scrollyRatio=(a.state.scrollbaryTrackLength-(m-f))/g,f=m}else{var v=h-f;f=h,a.state.scrollyRatio=(a.state.scrollbaryTrackLength-v)/g}f=Math.ceil(Math.min(a.state.scrollbaryTrackLength,f)),d.height(f),a.state.scrollbaryHeight=Math.ceil(f*a.state.scrollRatioConst)/a.state.scrollRatioConst}a.state.data.length===a.state.scrollbarRefreshLastDatalength&&a.option.columnMapping.length===a.state.scrollbarRefreshLastColumnLength||a._setScrollInfo();var x=a.state.translateX;if(a._columnShowFromEnabled()&&null!=a.state.columnFixShowFromColumnIndex){var y=a._generateTranslatex(a.state.columnFixShowFromColumnIndex);x=Math.max(x,y*a.state.scrollxRatio)}x=Math.max(0,x),It?n.css("left",a.state.scrollbarxTrackLeft+x+"px"):n.css("transform","translateX("+x+"px)");var C=a.state.translateY;if(null!=a.option.rowFixShowFrom&&a.option.rowFixCount&&!a.option.disableScrolledFix){var I=a.__getRowHeightByRenderedIdx(a.option.rowFixShowFrom);C=Math.max(C,I*a.state.scrollyRatio)}if(C=Math.max(0,C),It?d.css("top",a.state.scrollbaryTrackTop+C+"px"):d.css("transform","translateY("+C+"px)"),a.state.scrollbarRefreshLastDatalength=a.state.data.length,a.state.scrollbarRefreshLastColumnLength=a.option.columnMapping.length,a.option.scrollbarPreview&&1==a.option.scrollbarPreview.enabled){if(a.state.scrollbarPreview=a.state.scrollbarPreview||{},null!=a.state.scrollbarLastRow&&a.state.scrollbarLastRow!=a.state.renderFromRenderedIndex&&a.option.scrollbarPreview.row){a.state.scrollbarPreview.rowPreviewElement||(a.state.scrollbarPreview.rowPreviewElement=document.createElement("div"),a.state.scrollbarPreview.rowPreviewElement.className="preview row",a.$scrollbary[0].appendChild(a.state.scrollbarPreview.rowPreviewElement));var _=a.state.renderFromRenderedIndex;a.state.refreshbodycell&&a.state.refreshbodycell.renderedPinnedDataList.length&&(_=a.state.renderFromRenderedIndex+a.state.refreshbodycell.renderedPinnedDataList.length);var w=a.state.renderTargetDataList[_],b=a.state.columnIndexToMapping[a.state.renderFromColumnIndex];if(a.state.renderTargetMappingInfo&&a.state.renderTargetMappingInfo.renderTargetMapping)for(var M=0,S=a.state.renderTargetMappingInfo.renderTargetMapping.length;M<S;M++)if(!a.state.renderTargetMappingInfo.renderTargetMapping[M].selectorColumn&&a.state.renderTargetMappingInfo.renderTargetMapping[M].key){b=a.state.renderTargetMappingInfo.renderTargetMapping[M];break}"default"===a.option.scrollbarPreview.row?kt.renderUtil.setElementContent(a.state.scrollbarPreview.rowPreviewElement,document.createTextNode(kt.i18n("row")+(w._index.row+(a.option.scrollbarPreview.rowDefaultFromZero?0:1)))):"function"==typeof a.option.scrollbarPreview.row&&kt.renderUtil.setElementContent(a.state.scrollbarPreview.rowPreviewElement,a.option.scrollbarPreview.row(w,b)),a.state.scrollbarPreview.rowPreviewTimer&&(clearTimeout(a.state.scrollbarPreview.rowPreviewTimer),a.state.scrollbarPreview.rowPreviewTimer=null),a.state.scrollbarPreview.rowPreviewTimer=setTimeout(function(){a.state&&a.option&&(a.state.scrollbarPreview.rowPreviewElement&&a.$scrollbary[0].removeChild(a.state.scrollbarPreview.rowPreviewElement),a.state.scrollbarPreview.rowPreviewElement=null,a.state.scrollbarPreview.rowPreviewTimer=null)},a.option.scrollbarPreview.closeDelay)}if(null!=a.state.scrollbarLastColumn&&a.state.scrollbarLastColumn!=a.state.renderFromColumnIndex&&a.option.scrollbarPreview.column){a.state.scrollbarPreview.columnPreviewElement||(a.state.scrollbarPreview.columnPreviewElement=document.createElement("div"),a.state.scrollbarPreview.columnPreviewElement.className="preview column",a.$scrollbarx[0].appendChild(a.state.scrollbarPreview.columnPreviewElement));var w=a.state.renderTargetDataList[a.state.renderFromRenderedIndex],b=a.state.columnIndexToMapping[a.state.renderFromColumnIndex];if(a.state.refreshbodycell&&a.state.refreshbodycell.renderedPinnedDataList.length&&(w=a.state.refreshbodycell.renderedPinnedDataList[0]),a.state.renderTargetMappingInfo&&a.state.renderTargetMappingInfo.fixedRenderTargetMapping.length){var E=a._columnIndexOrder(a.state.renderFromColumnIndex);E+=a.state.renderTargetMappingInfo.fixedRenderTargetMapping.length,b=a.state.columnIndexToMapping[a.state.columnIndexArr[E]]}if("default"===a.option.scrollbarPreview.column)if(b.title){var T=document.createElement("div");kt.renderUtil.setElementContent(T,"function"==typeof b.title?b.title.call(a,b):b.title),a.state.scrollbarPreview.columnPreviewElement.innerHTML=kt.renderUtil.escapeHTMLString(e(T).text())}else b.key||null!=b.key?kt.renderUtil.setElementContent(a.state.scrollbarPreview.columnPreviewElement,document.createTextNode(b.key)):kt.renderUtil.setElementContent(a.state.scrollbarPreview.columnPreviewElement,document.createTextNode(kt.i18n("column")+b.columnIndex));else"function"==typeof a.option.scrollbarPreview.column&&kt.renderUtil.setElementContent(a.state.scrollbarPreview.columnPreviewElement,a.option.scrollbarPreview.column(w,b));a.state.scrollbarPreview.columnPreviewTimer&&(clearTimeout(a.state.scrollbarPreview.columnPreviewTimer),a.state.scrollbarPreview.columnPreviewTimer=null),a.state.scrollbarPreview.columnPreviewTimer=setTimeout(function(){a.state&&a.option&&(a.state.scrollbarPreview.columnPreviewElement&&a.$scrollbarx[0].removeChild(a.state.scrollbarPreview.columnPreviewElement),a.state.scrollbarPreview.columnPreviewElement=null,a.state.scrollbarPreview.columnPreviewTimer=null)},a.option.scrollbarPreview.closeDelay)}if(a.state.scrollbarPreview.rowPreviewElement){a.state.scrollbarPreview.rowPreviewElement.style.right=a.state.scrollbaryWidth+"px";var D=a.state.scrollbaryTrackTop+C,R=a.state.scrollbarPreview.rowPreviewElement.offsetHeight||a.state.scrollbarPreview.rowPreviewElement.clientHeight;D+R>=a.state.wrapperHeight&&(D-=D+R-a.state.wrapperHeight),a.state.scrollbarPreview.rowPreviewElement.style.top=Math.ceil(D)+"px"}if(a.state.scrollbarPreview.columnPreviewElement){a.state.scrollbarPreview.columnPreviewElement.style.bottom=a.state.scrollbarxHeight+"px";var F=a.state.scrollbarxTrackLeft+x,k=a.state.scrollbarPreview.columnPreviewElement.offsetWidth||a.state.scrollbarPreview.columnPreviewElement.clientWidth;F+k>=a.state.wrapperWidth&&(F-=F+k-a.state.wrapperWidth),a.state.scrollbarPreview.columnPreviewElement.style.left=Math.ceil(F)+"px"}}a.state.scrollbarLastRow=a.state.renderFromRenderedIndex,a.state.scrollbarLastColumn=a.state.renderFromColumnIndex},kt.prototype._refreshBoard=function(e){var t=this;if(!t.state.renderingSuppressed){t.state.renderFromRenderedIndex=Math.max(0,t.state.renderFromRenderedIndex||0),t.state.renderFromColumnIndex=Math.max(0,t.state.renderFromColumnIndex||0),t.state.renderTargetMappingInfo=t._generateRenderTargetMapping();var a=t.option.useContinuousXScroll&&t.state.prevTranslateX!==t.state.translateX,n=t.option.useContinuousYScroll&&t.state.prevTranslateY!==t.state.translateY;if(!e&&t.state.prevRenderFromRenderedIndex===t.state.renderFromRenderedIndex&&t.state.prevRenderFromColumnIndex===t.state.renderFromColumnIndex&&t.state.prevWrapperWidth===t.state.wrapperWidth&&t.state.prevWrapperHeight===t.state.wrapperHeight&&t.state.prevScrollxEnd===t.state.scrollxEnd&&t.state.prevScrollyEnd===t.state.scrollyEnd&&t.state.prevColumnIndexArr===t.state.columnIndexArr&&!a&&!n)return t._refreshScrollbar(e),void t._triggerGridEvent("gridRefresh",{});var r=!(t.state.prevRenderFromRenderedIndex===t.state.renderFromRenderedIndex&&t.state.prevRenderFromColumnIndex===t.state.renderFromColumnIndex&&t.state.prevScrollxEnd===t.state.scrollxEnd&&t.state.prevScrollyEnd===t.state.scrollyEnd);t.state.prevRenderFromRenderedIndex=t.state.renderFromRenderedIndex,t.state.prevRenderFromColumnIndex=t.state.renderFromColumnIndex,t.state.prevWrapperWidth=t.state.wrapperWidth,t.state.prevWrapperHeight=t.state.wrapperHeight,t.state.prevScrollxEnd=t.state.scrollxEnd;var o=t.state.prevScrollyEnd!==t.state.scrollyEnd&&t.state.scrollyEnd;t.state.prevScrollyEnd=t.state.scrollyEnd,t.state.prevColumnIndexArr=t.state.columnIndexArr,t.state.prevTranslateX=t.state.translateX,t.state.prevTranslateY=t.state.translateY,t._refreshPagingUnit(e),t._refreshScrollbar(e),t._refreshHeaderCells(e),t._refreshFooterCells(e),t._refreshBodyCells(e),t._triggerGridEvent("gridRefresh",{}),r&&t._triggerGridEvent("gridScroll",t.scrollOffset()),
o&&t._triggerGridEvent("scrollBottom",{})}},kt.prototype.calcAndRedraw=function(){var e=this;e.state.renderingSuppressed||(e._sortInternalData(),e._generateRenderTargetData(),e.viewUpdate(!0))},kt.prototype.filterAndRedraw=function(){var e=this;e.state.renderingSuppressed||(e._generateRenderTargetData(),e.viewUpdate(!0),ke(e))},kt.prototype.redraw=function(){var e=this;e.state.renderingSuppressed||e.viewUpdate(!0)},kt.prototype._getFilteredDataListExcept=function(e){for(var t=this,a=[],n=0,r=t.state.data.length;n<r;n++)t._doesDataPassFilter(t.state.data[n],e)||a.push(t.state.data[n]);return a},kt.prototype._generateFilterColumnList=function(){function t(t){var a={closeOuterClick:n.option.closeFilterOuterClick,saveFilterSize:n.option.saveFilterDropdownSize,scrollResetAfterFilter:n.option.scrollResetAfterFilter,typeList:n.option.filterTypeList,useRenderToFilter:t.useRenderToFilter};return d(n.option.filteringHeader)&&(a.minHeight=n.option.filteringHeader.minHeight,a.minWidth=n.option.filteringHeader.minWidth),e.extend({},n.option.filter,a,t.filter)}for(var a,n=this,r=[],o=[],l=0,i=n.state.visibleColumnMappingList.length;l<i;l++){var p=n.state.visibleColumnMappingList[l];p.filter!==!1&&p.filterOption?s(p.filterOption)?(r.push(p),o.push(t(p))):e.isArray(p.filterOption.type)?(r.push(p),o.push(t(p))):(a=kt.filterFunction[p.filterOption.type],s(a)&&(r.push(p),o.push(t(p)))):null!=n.state.removeFilterColumnMapping&&delete n.state.removeFilterColumnMapping[p.id]}n.state.mergedFilterOptionList=o,n.state.filterColumnMappingList=r},kt.prototype._doesDataPassFilter=function(t,a){var n=this,r=!1;n.option.rowOption&&n.option.rowOption.filter&&e.each(n.option.rowOption.filter,function(e,a){if(d(a)&&(a=n._filterDataToFunction(a)),s(a)&&a(t)!==!0)return r=!0,!0});for(var o=0;o<n.state.filterColumnMappingList.length;o++){var l=n.state.filterColumnMappingList[o],i=n._getColumnFilterFunction(l);if(null==a||l.columnIndex!==a){if(i){var p=t[l.key],u=n.state.mergedFilterOptionList[o]||{},c=u.useRenderToFilter?u.useRenderToFilter:null;if("render"===c&&"checkedList"!==l.filterOption.type){var g=n._renderDataByMapping(t,l);p="string"==typeof g?g:g.textContent;var f=i(p,t,l);if(i===ve){if("and"===l.filterOption.rule){if(f[0]!==!0||f[1]!==!0){r=!0,n.state.removeFilterColumnMapping[l.id]=!1;break}}else if(f[0]!==!0&&f[1]!==!0){r=!0,n.state.removeFilterColumnMapping[l.id]=!1;break}}else if(f!==!0){r=!0,n.state.removeFilterColumnMapping[l.id]=!1;break}}else{var h=i(p,t,l);if(i===ve){if("and"===l.filterOption.rule){if(h[0]!==!0||h[1]!==!0){r=!0,n.state.removeFilterColumnMapping[l.id]=!1;break}}else if(h[0]!==!0&&h[1]!==!0){r=!0,n.state.removeFilterColumnMapping[l.id]=!1;break}}else if(h!==!0){r=!0,n.state.removeFilterColumnMapping[l.id]=!1;break}}}n.state.removeFilterColumnMapping[l.id]!==!1&&(n.state.removeFilterColumnMapping[l.id]=!0)}}return r},kt.prototype._isGroupRangeCollapsed=function(e){var t=e.member[0]._state.collapsedGroupNode&&e.member[0]._state.collapsedGroupNode[e.groupKey];return t},kt.prototype._toggleCollapseGroupRange=function(e){this._isGroupRangeCollapsed(e)?this._expandGroupRange(e):this._collapseGroupRange(e)},kt.prototype._collapseGroupRange=function(e){for(var t=0,a=e.member.length;t<a;t++)e.member[t]._state.collapsedGroupNode=e.member[t]._state.collapsedGroupNode||{},e.member[t]._state.collapsedGroupNode[e.groupKey]=!0},kt.prototype._expandGroupRange=function(t){for(var a=!1,n=0,r=t.member.length;n<r;n++)t.member[n]._state.collapsedGroupNode&&(delete t.member[n]._state.collapsedGroupNode[t.groupKey],(a||e.isEmptyObject(t.member[n]._state.collapsedGroupNode))&&(delete t.member[n]._state.collapsedGroupNode,a=!0))},kt.prototype._isGroupDataCollapsed=function(e,t,a){var n=this,r=n._getGroupingRange(e._index.data,t);if(r)for(var o=r.groupDepth,l=a===!0?o:0;o>=l&&o>=0;o--)if(r=n._getGroupingRange(e._index.data,n.option.grouping.by[o]),n._isGroupRangeCollapsed(r))return!0;return!1},kt.prototype._collapseGroupData=function(e,t){var a=this._getGroupingRange(e._index.data,t);a&&this._collapseGroupRange(a)},kt.prototype._expandGroupData=function(e,t){var a=this._getGroupingRange(e._index.data,t);a&&this._expandGroupRange(a)},kt.prototype._toggleGroupData=function(e,t){var a=this._getGroupingRange(e._index.data,t);a&&(this._isGroupRangeCollapsed(a)?this._expandGroupData(e,t):this._collapseGroupData(e,t))},kt.prototype._getTopmostCollapsedRange=function(e){var t,a=this.option.grouping.by.length-1;if(e._state.groupFooter||e._state.groupHeader){if(t=this.state.groupingLookupTableMapById[e._state.groupFooter||e._state.groupHeader],!t)return null;e=t.member[0],a=this.state.groupKeyOrderMap[t.groupKey]}for(var n=null;a>=0&&(t=this._getGroupingRange(e._index.data,this.option.grouping.by[a--]));)this._isGroupRangeCollapsed(t)&&(n=t);return n},kt.prototype.isGroupCollapsed=function(e,t,a){var n=this,r=n._dataGet(e)[0];return arguments[arguments.length-1]===!0&&(a=!0),null==t?t=n.option.grouping.by[n.option.grouping.by.length-1]:"number"==typeof t&&(t=n.option.grouping.by[t]),r?n._isGroupDataCollapsed(r,t,a):null},kt.prototype._applyGroupFoldingStateToHeader=function(e,t){for(var a=this,n="toggle"===t,r=0,o=e.length;r<o;r++){var l=a._columnIndexKeyToMappingList(e[r]);if(a.state.headerGroupFoldingIconCollapsed=a.state.headerGroupFoldingIconCollapsed||{},l&&l.length)for(var i=0,d=l.length;i<d;i++)a.state.headerGroupFoldingIconCollapsed[l[i].id]=n?!a.state.headerGroupFoldingIconCollapsed[l[i].id]:!!t}},kt.prototype.collapseGroup=function(e,t){var a=this,n="string"==typeof e||"number"==typeof e;t=n?e:t,e=d(e)?e:{};var r=a._dataGet(e);if("number"==typeof t&&(t=a.option.grouping.by[t]),t=null==t?a.option.grouping.by:[t],(n||r.length===a.state.data.length)&&a._applyGroupFoldingStateToHeader(t,!0),r&&r.length){for(var o={},l=0,i=r.length;l<i;l++)for(var s=0,p=t.length;s<p;s++){var u=this._getGroupingRange(r[l]._index.data,t[s]);u&&!o[u.id]&&(o[u.id]=!0,a._collapseGroupRange(u))}a.filterAndRedraw()}},kt.prototype.expandGroup=function(e,t){var a=this,n="string"==typeof e||"number"==typeof e;t=n?e:t,e=d(e)?e:{};var r=a._dataGet(e);"number"==typeof t&&(t=a.option.grouping.by[t]);var o=null==t;if(t=null==t?a.option.grouping.by:[t],(n||r.length===a.state.data.length)&&a._applyGroupFoldingStateToHeader(t,!1),r&&r.length){var l={};if(o)if(n||!arguments.length)for(var i=0,s=r.length;i<s;i++)delete r[i]._state.collapsedGroupNode;else for(var i=0,s=r.length;i<s;i++){var p=this._getGroupingRange(r[i]._index.data,a.option.grouping.by[0]);if(p&&!l[p.id]){l[p.id]=!0;for(var u=0,c=p.member.length;u<c;u++)delete p.member[u]._state.collapsedGroupNode}}else for(var i=0,s=r.length;i<s;i++)for(var g=0,f=t.length;g<f;g++){var p=this._getGroupingRange(r[i]._index.data,t[g]);p&&!l[p.id]&&(l[p.id]=!0,a._expandGroupRange(p))}a.filterAndRedraw()}},kt.prototype.toggleGroup=function(e,t){var a=this,n="string"==typeof e||"number"==typeof e;t=n?e:t,e=d(e)?e:{};var r=a._dataGet(e);"number"==typeof t&&(t=a.option.grouping.by[t]),t=null==t?a.option.grouping.by:[t],(n||r.length===a.state.data.length)&&a._applyGroupFoldingStateToHeader(t,"toggle");var o={};if(r&&r.length){for(var l=0,i=r.length;l<i;l++)for(var s=0,p=t.length;s<p;s++){var u=this._getGroupingRange(r[l]._index.data,t[s]);u&&!o[u.id]&&(o[u.id]=!0,this._isGroupRangeCollapsed(u)?this._expandGroupData(r[l],t[s]):this._collapseGroupData(r[l],t[s]))}a.filterAndRedraw()}},kt.prototype._isGroupEnabled=function(){return!!(this.option.grouping&&this.option.grouping.useGrouping&&this.option.grouping.by&&this.option.grouping.by.length)},kt.prototype._isGroupFooterEnabled=function(){var t=!1;if(this._isGroupEnabled())if(this.option.grouping.useGroupFooter===!0)t=!0;else if(e.isArray(this.option.grouping.useGroupFooter))t=!0;else if(d(this.option.grouping.foldedGroupFooter))for(var a in this.option.grouping.foldedGroupFooter)if(this.option.grouping.foldedGroupFooter[a]===!0){t=!0;break}return t},kt.prototype._isGroupHeaderEnabled=function(){var t=!1;if(this._isGroupEnabled())if(this.option.grouping.useGroupHeader===!0)t=!0;else if(e.isArray(this.option.grouping.useGroupHeader))t=!0;else if(d(this.option.grouping.foldedGroupFooter))for(var a in this.option.grouping.foldedGroupFooter)if(this.option.grouping.foldedGroupFooter[a]===!0){t=!0;break}return t},kt.prototype._isGroupSummaryEnabled=function(){return!(!this._isGroupFooterEnabled()&&!this._isGroupHeaderEnabled())},kt.prototype._generateRenderTargetData=function(){var t=this,a=t.state.data,n=[],r=[],o={enabled:null,current:null,total:null,dataLength:null,rowCount:null,pageRowCount:null,pageDataLength:null,perPage:null,pagerCount:null,pagerSelect:null,pagerTotal:null,first:null,prev:null,next:null,last:null},l=t.option.paging||{};o.pagerSelect=l.pagerSelect,o.pagerTotal=l.pagerTotal,o.first=l.first||null,o.prev=l.prev||null,o.next=l.next||null,o.last=l.last||null;var i=l.customPaging,s=o.enabled=!!l.enabled;l.enabledByPager&&(s=o.enabled=!!t.option.pager),t.option.tree&&t.option.tree.useTree&&(s=o.enabled=!1),i||null!=l.perPage||(s=o.enabled=!1),o.pagerCount=l.pagerCount||10,o.current=(i?i.current:l.current)||1,o.perPage=i?i.perPage:l.perPage,null==o.perPage&&(o.perPage=a.length),t._generateFilterColumnList();var p=t.option.rowOption&&d(t.option.rowOption.filter)&&!e.isEmptyObject(t.option.rowOption.filter)||t.state.filterColumnMappingList.length,u=t._hasPinnedData(),c=!!(t.option.tree&&t.option.tree.useTree&&t.state.treeInfo),g=t._isGroupEnabled(),f=t._isGroupHeaderEnabled(),h=t._isGroupFooterEnabled(),m=null,v=null,x=null,y=null;if(g){for(var C=[],I=0,_=t.option.grouping.by.length;I<_;I++)C.push({});if(f){m={},x={};var w=null;if(e.isArray(t.option.grouping.useGroupHeader)?w=t.option.grouping.useGroupHeader:t.option.grouping.useGroupHeader===!0&&(w=t.option.grouping.by),w){for(var b=0,_=w.length;b<_;b++)null!=t.state.groupingKeyMap[w[b]]&&(m[w[b]]=!0,x[w[b]]=!0);if(d(t.option.grouping.foldedGroupHeader))for(var M in t.option.grouping.foldedGroupHeader)t.option.grouping.foldedGroupHeader[M]===!0&&(x[M]=!0)}}if(h){v={},y={};var w=null;if(e.isArray(t.option.grouping.useGroupFooter)?w=t.option.grouping.useGroupFooter:t.option.grouping.useGroupFooter===!0&&(w=t.option.grouping.by),w){for(var b=0,_=w.length;b<_;b++)null!=t.state.groupingKeyMap[w[b]]&&(v[w[b]]=!0,y[w[b]]=!0);if(d(t.option.grouping.foldedGroupFooter))for(var M in t.option.grouping.foldedGroupFooter)t.option.grouping.foldedGroupFooter[M]===!0&&(y[M]=!0)}}}var S=t.state.groupHeaderDataMapById=t.state.groupHeaderDataMapById||{},E=t.state.groupFooterDataMapById=t.state.groupFooterDataMapById||{},T=0,D=!(!g||!f&&!h),R=!(!t.option.grouping||!t.option.grouping.useGrouping||t.option.grouping.showGroupSummaryOnly!==!0);null==t.state.removeFilterColumnMapping&&(t.state.removeFilterColumnMapping={});for(var F=0,k=a.length;F<k;F++){var L=a[F];if(delete L._index.row,delete L._index.target,L._state.filtered=!1,p){var A=t._doesDataPassFilter(L);if(A)continue;L._state.filtered=!0}if(!(u&&t.state.pinnedDataIdMap[L._index.id]||c&&L._index.parentid&&t._isTreeParentNodeExpanded(L)!==!0)){if(D){for(var O=[],I=0,_=t.option.grouping.by.length;I<_;I++){var M=t.option.grouping.by[I],P=t._getGroupingRange(F,M);O.push(P)}if(h)for(var I=t.option.grouping.by.length-1;I>=0;I--){var B=C[I];if(B.id&&B.id!==O[I].id&&(v[t.option.grouping.by[I]]||y[t.option.grouping.by[I]]&&t._isGroupRangeCollapsed(B))){var G=E[B.id]||{_index:{},_state:{groupFooter:B.id}};G._index.id||t._giveDataId(G),G._state.filtered=p,E[B.id]=G,n.push(G)}}if(f)for(var I=0,_=t.option.grouping.by.length;I<_;I++)if(O[I].id&&C[I].id!==O[I].id&&(m[t.option.grouping.by[I]]||x[t.option.grouping.by[I]]&&t._isGroupRangeCollapsed(O))){var H=S[O[I].id]||{_index:{},_state:{groupHeader:O[I].id}};H._index.id||t._giveDataId(H),S[O[I].id]=H,H._state.filtered=p,n.push(H)}for(var I=0,_=t.option.grouping.by.length;I<_;I++)C[I]=O[I]}n.push(L),L._index.target=T++}}if(null!=t.state.removeFilterColumnMapping&&null!=t.state.filterColumnMappingList&&t.state.filterColumnMappingList.length>0){var N=Object.keys(t.state.removeFilterColumnMapping).map(function(e){return t.state.removeFilterColumnMapping[e]});e.inArray(!0,N)!==-1&&e.each(t.state.removeFilterColumnMapping,function(e,a){var n=t.state.removeFilterColumnMapping[e];if(null!=n&&n===!0){var r=t.state.columnIdToMapping[e];delete r.filterOption,delete t.state.removeFilterColumnMapping[e],t.state.filterColumnMappingList=t.state.filterColumnMappingList.filter(function(t){return t.id!==e}),t.state.mergedFilterOptionList=t.state.mergedFilterOptionList.filter(function(t){return t.id!==e})}})}if(h)for(var I=t.option.grouping.by.length-1;I>=0;I--)if(C[I].id&&(v[t.option.grouping.by[I]]||y[t.option.grouping.by[I]]&&t._isGroupRangeCollapsed(C[I]))){var G=E[C[I].id]||{_index:{},_state:{groupFooter:C[I].id}};G._index.id||t._giveDataId(G),E[C[I].id]=G,G._state.filtered=p,n.push(G)}i?o.total=i.total:n.length?o.total=Math.floor(n.length/o.perPage)+(n.length%o.perPage?1:0):o.total=0,(o.total===1/0||isNaN(o.total))&&(o.total=n.length?1:0),o.current=Math.min(o.total,Math.max(1,o.current));var $=null,W=null;s?($=(o.current-1)*o.perPage,W=o.current*o.perPage-1):o.current=1;var K=0,U=0,Y=0;if(u)for(var V=0,X=t.state.pinnedDataIdList.length;V<X;V++){var z=t.state.pinnedDataIdList[V],F=t.state.dataIdToIndexMap[z],L=t.state.data[F];z&&L&&(L._index.row=U++,r.push(L),K++,L._state.groupFooter||L._state.groupHeader||Y++)}for(var j={},V=0,X=n.length;V<X;V++)if(!s||i||!(V<$||W<V)){var L=n[V];if(g){if(R&&!L._state.groupFooter&&!L._state.groupHeader)continue;var q=t._getTopmostCollapsedRange(L);if(q){var O=t._getGroupingRangeByData(L),Z=!!(null!=v&&v[q.groupKey]||null!=m&&m[q.groupKey]);if((null!=y&&y[q.groupKey]||null!=x&&x[q.groupKey])&&(Z=!0),O&&O.id===q.id&&Z);else if(Z){if(O&&O.groupDepth>q.groupDepth)continue;if(!O)continue}else{if(j[q.id])continue;j[q.id]=!0}}}L._index.row=U++,r.push(L),L._state.groupFooter||L._state.groupHeader||Y++}var Q=T+K,J=n.length+K;t.option.paging&&t.option.paging.countGroupSummary===!0&&(Q=J,Y=U),o.dataLength=i?i.dataLength:Q,o.rowCount=J,o.pageDataLength=Y,o.pageRowCount=U,o.pageDataList=r,p?t.state.filteredDataList=n:delete t.state.filteredDataList,t.state.targetDataList=n,t.state.renderTargetDataList=r,t.state.pagingInfo=o},kt.prototype._hiddenHeaderDragStart=function(t,a){var n=this,r=e.event.fix(t);if("touchstart"===t.type)r=t.touches[0];else if(1!=t.which)return;t.preventDefault(),n.$wrapper.off(".alopexgridHeaderSelectEngine");var o=".alopexgridhiddenheaderdragdropevent",l=n.$columnhiddenarea,d=e(t.target).closest(".headercell"),s={};s.self=n,s.hiddenHeaderDragDropEventNS=o,s.hiddenColArea=l,s.hiddenAreaHasScroll=l.get(0).scrollWidth>l.innerWidth(),s.headercell=d,s.columnIndex=a,s.wrapperX=n.$wrapper.offset().left,s.atColumnIndex=null,s.targetHiddenColumnIndex=null,s.after=!1,s.$proxy=null,s.$bar=null,s.scrollTimer=null,s.prevX=r.pageX,s.prevY=r.pageY,s.toHideArea=!1,s.canDragDrop=!0,s.groupDragDrop=!1,s.dragColumnMapping=null,s.leftColumn=null,s.leftColumnMapping=null,s.rightColumn=null,s.rightColumnMapping=null,s.toHiddenColumnArea=null,s.targetHiddenColumn=null,s.targetHiddenColumnMapping=null,n.state.hiddenColumnDraging=!0,xt.off(o+n.key),xt.on("keydown"+o+n.key+n.eventns,s,function(e){var t=e.data.self,a=e.data.hiddenColArea,n=e.keyCode;switch(n){case 27:xt.off(e.data.hiddenHeaderDragDropEventNS+t.key),t._enableHeaderSelect(!!t.option.enableHeaderSelect),a.removeClass("focused"),e.data.$proxy&&(e.data.$proxy.remove(),delete e.data.$proxy),e.data.$bar&&(e.data.$bar.remove(),delete e.data.$bar),e.data.scrollTimer&&(clearInterval(e.data.scrollTimer),e.data.scrollTimer=null),null!==e.data.atColumnIndex&&(e.data.atColumnIndex=null)}}),xt.on("mousemove"+o+n.key+n.eventns+" touchmove"+o+n.key+n.eventns,s,function(t){var a=t,n=t.target;if("touchmove"===t.type&&(a=t.originalEvent.touches[0],n=document.elementFromPoint(a.clientX,a.clientY)),t.data.prevX!==a.pageX||t.data.prevY!==a.pageY){t.data.prevX=a.pageX,t.data.prevY=a.pageY;var r=t.data.self,o=t.data.hiddenColArea,l=t.data.headercell,d=t.data.columnIndex;t.preventDefault(),i();var s=t.data.$proxy,p=t.data.$bar;if(null==s){s=e("<div>"),s.addClass(pt+" alopexgrid-proxy alopexgrid-dragdrop-header alopexgrid-refer-"+r.key);var u=e('<div class="columnhiddenarea"><div>').css("overflow","visible");null!=l&&($cloneHeader=l.clone(),$cloneHeader.css({top:"0px",left:"0px"}),u.append($cloneHeader)),s.append(u),s.appendTo(document.body),t.data.$proxy=s}null==p&&(p=e("<div>"),p.addClass("alopexgrid-dragdrop-header-indicator"),t.data.$bar=p),t.data.$bar.prependTo(r.$wrapper),s.css({top:a.pageY+"px",left:a.pageX+"px"}),t.data.scrollTimer&&(clearInterval(t.data.scrollTimer),t.data.scrollTimer=null);var c=r.state.refreshbodycell.bodyCellStartX;r.state.fixedColumnWidth>0&&(c+=r.state.fixedColumnWidth);var g=r.state.refreshbodycell.bodyCellEndX,f=t.data.hiddenAreaHasScroll,h=o.offset().top+o.height();if(f)var m=o.scrollLeft(),v=o.offset().left,x=v+o.width(),y=1;var C=a.pageX,I=a.pageY;if(C<=t.data.wrapperX+c){var _=Math.ceil(Math.abs(C-(t.data.wrapperX+c))/25),w=function(){I<=h?f&&v-C>0&&(o.scrollLeft(m-(v-C)*y),y+=5):r._scrollLeftEvent(_)};w(),t.data.scrollTimer=setInterval(w,100)}else if(C>t.data.wrapperX+g){var _=Math.ceil(Math.abs(C-(t.data.wrapperX+g))/25),w=function(){I<=h?f&&C-x>0&&(o.scrollLeft(m+(C-x)*y),y+=5):r._scrollRightEvent(_)};w(),t.data.scrollTimer=setInterval(w,100)}var b=r.state.renderTargetMappingInfo,M=b.fixedRenderTargetMapping,S=b.renderTargetWidth,E=b.fitRatio,T=r.state.scrollxEnd,D=0;T&&S>r.state.wrapperWidth&&(D=S-r.state.wrapperWidth);var R=!0,F=e(n),k=F.closest(".columnhiddenarea");if(F.closest(".alopexgrid-dragdrop-header")&&0!==F.closest(".alopexgrid-dragdrop-header").length)return void o.removeClass("focused");if(k&&0!==k.length&&"true"===k.attr("data-alopexgrid-columnhiddenarea")){t.data.atColumnIndex=null,t.data.toHideArea=!0,o.addClass("focused");var L=F.closest(".headercell");L&&0!==L.length?t.data.targetHiddenColumnIndex=L.attr("data-alopexgrid-columnindex"):t.data.targetHiddenColumnIndex=null,t.data.dragColumnMapping=r.state.columnIndexToMapping[d];var A=t.data.targetHiddenColumnIndex,O=null;null!=t.data.targetHiddenColumnIndex&&(A=Number(t.data.targetHiddenColumnIndex),O=r.state.columnIndexToMapping[A]);var P=r._triggerGridEvent("hiddenHeaderDragOver",{dragColumn:d,dragColumnMapping:t.data.dragColumnMapping,leftColumn:null,leftColumnMapping:null,rightColumn:null,rightColumnMapping:null,toHiddenColumnArea:t.data.toHideArea,targetHiddenColumn:A,targetHiddenColumnMapping:O});P?(t.data.canDragDrop=!0,t.data.$proxy.removeClass("disabled")):(t.data.canDragDrop=!1,t.data.$proxy.addClass("disabled"))}else{t.data.toHideArea=!1,t.data.targetHiddenColumnIndex=null,o.removeClass("focused");var B=r.state.refreshbodycell.renderedColumnMappingList.length,L=F.closest(".headercell"),G=F.closest(".bodycell"),H=F.closest(".footercell"),N=F.closest(".filtercell"),$=F.closest(".pager"),W=F.closest("."+pt);if(null!=L&&0!==L.length||null!=G&&0!==G.length||null!=H&&0!==H.length||null!=N&&0!==N.length||null!=$&&0!==$.length)for(var K=0;K<B;K++){var U=r.state.refreshbodycell.renderedColumnMappingList[K],Y=U.columnIndex,V=(r.state.columnIndexToMapping[Y],r.state.columnWidthMap[Y]);1!==E&&(V*=r.state.refreshbodycell.fitRatio),M.length>0&&r.state.refreshbodycell.renderedColumnMappingList[M.length].columnIndex===Y&&(V-=D);var X=r.state.refreshbodycell.bodyCellPositionXForHeaderDrag[K],z=X+t.data.wrapperX;if(C>=z&&C<=z+V){t.data.atColumnIndex=Y,Math.abs(C-z)>Math.abs(C-(z+V))?(t.data.after=!0,It?t.data.$bar.css("left",X+V+"px"):t.data.$bar.css("transform","translateX("+(X+V)+"px)")):(t.data.after=!1,It?t.data.$bar.css("left",X+"px"):t.data.$bar.css("transform","translateX("+X+"px)"));break}}else if(null!=W&&0!==W.length){t.data.after=!0;var Y,U=r.state.refreshbodycell.renderedColumnMappingList[B-1];Y=null==U?Math.min.apply(null,r.state.hiddenColumnIdxArr):U.columnIndex,d===Y?(t.data.atColumnIndex=null,t.data.canDragDrop=!1):(t.data.atColumnIndex=Y,R=!1)}else t.data.atColumnIndex=null,t.data.canDragDrop=!1}if(t.data.toHideArea===!1&&null!==t.data.atColumnIndex){R?t.data.$bar.show():t.data.$bar.hide(),t.data.dragColumnMapping=r.state.columnIndexToMapping[d];var j=e.inArray(t.data.atColumnIndex,r.state.visibleColumnIndexArr);t.data.after?(t.data.leftColumn=t.data.atColumnIndex,t.data.leftColumnMapping=r.state.columnIndexToMapping[t.data.atColumnIndex],t.data.rightColumn=r.state.visibleColumnIndexArr[j+1],null==t.data.rightColumn?(t.data.lrightColumn=null,t.data.lrightColumnMapping=null):t.data.rightColumnMapping=r.state.columnIndexToMapping[t.data.rightColumn]):(t.data.leftColumn=r.state.visibleColumnIndexArr[j-1],null==t.data.leftColumn?(t.data.leftColumn=null,t.data.leftColumnMapping=null):t.data.leftColumnMapping=r.state.columnIndexToMapping[t.data.leftColumn],t.data.rightColumn=t.data.atColumnIndex,t.data.rightColumnMapping=r.state.columnIndexToMapping[t.data.rightColumn]);var P=r._triggerGridEvent("hiddenHeaderDragOver",{dragColumn:d,dragColumnMapping:t.data.dragColumnMapping,leftColumn:t.data.leftColumn,leftColumnMapping:t.data.leftColumnMapping,rightColumn:t.data.rightColumn,rightColumnMapping:t.data.rightColumnMapping,toHiddenColumnArea:t.data.toHideArea,targetHiddenColumn:null,targetHiddenColumnMapping:null});if(P&&(t.data.canDragDrop=!0,t.data.$bar.removeClass("disabled"),t.data.$proxy.removeClass("disabled")),r.option.grouping&&r.option.grouping.by.length>0&&r.option.grouping.useGroupColumnRearrange===!0){var q,j=e.inArray(t.data.atColumnIndex,r.state.visibleColumnIndexArr);t.data.after?(j+=1,q=r.state.visibleColumnIndexArr[j]):q=r.state.visibleColumnIndexArr[j];var Z=r.state.groupingColumnIndexToMapping[d],O=r.state.groupingColumnIndexToMapping[q];if(r.option.grouping.useDragDropBetweenGroups)null!=Z&&null!=O?(t.data.canDragDrop=!0,t.data.groupDragDrop=!0,t.data.$bar.removeClass("disabled"),t.data.$proxy.removeClass("disabled")):null==Z&&null==O?(t.data.groupDragDrop=!1,t.data.canDragDrop=!0,t.data.$bar.removeClass("disabled"),t.data.$proxy.removeClass("disabled")):(t.data.groupDragDrop=!1,t.data.canDragDrop=!1,t.data.$bar.addClass("disabled"),t.data.$proxy.addClass("disabled"));else if(null!=Z&&null!=O)t.data.canDragDrop=!0,t.data.groupDragDrop=!0,t.data.$bar.removeClass("disabled"),t.data.$proxy.removeClass("disabled");else if(null!=Z&&null==O){t.data.groupDragDrop=!1;var Q=r.option.grouping.by,J=Q[Q.length-1],ee=(r._getColumnByKey(J)||{}).columnIndex,te=e.inArray(ee,r.state.visibleColumnIndexArr),ae=r.state.visibleColumnIndexArr[te+1],ne=r.state.columnIndexToKeyMap[ae];"undefined"===ne?(t.data.canDragDrop=!1,t.data.$bar.addClass("disabled"),t.data.$proxy.addClass("disabled")):(t.data.canDragDrop=!0,t.data.$bar.removeClass("disabled"),t.data.$proxy.removeClass("disabled"))}else if(null==Z&&null!=O){t.data.groupDragDrop=!1;var re=r.state.columnIndexToKeyMap[d];"undefined"===re?(t.data.canDragDrop=!1,t.data.$bar.addClass("disabled"),t.data.$proxy.addClass("disabled")):(t.data.canDragDrop=!0,t.data.$bar.removeClass("disabled"),t.data.$proxy.removeClass("disabled"))}else t.data.groupDragDrop=!1,t.data.canDragDrop=!0,t.data.$bar.removeClass("disabled"),t.data.$proxy.removeClass("disabled")}P===!1&&(t.data.canDragDrop=!1,t.data.$bar.addClass("disabled"),t.data.$proxy.addClass("disabled"))}else t.data.$bar.hide()}}).on("mouseup"+o+n.key+n.eventns+" touchend"+o+n.key+n.eventns+" touchcancel"+o+n.key+n.eventns,s,function(t){function a(e,t){e._triggerGridEvent("hiddenHeaderDragDropEnd",{dropColumn:t.columnIndex,dropColumnMapping:t.dragColumnMapping,leftColumn:t.leftColumn,leftColumnMapping:t.leftColumnMapping,rightColumn:t.rightColumn,rightColumnMapping:t.rightColumnMapping,toHiddenColumnArea:t.toHideArea})}function n(e){return null!==e&&void 0!==e}var r=t.data.self,o=(t.data.headercell,t.data.hiddenColArea),l=t.data.columnIndex;if(xt.off(t.data.hiddenHeaderDragDropEventNS+r.key),r._enableHeaderSelect(!!r.option.enableHeaderSelect),o.removeClass("focused"),t.data.$proxy&&(t.data.$proxy.remove(),delete t.data.$proxy),t.data.$bar&&(t.data.$bar.remove(),delete t.data.$bar),t.data.scrollTimer&&(clearInterval(t.data.scrollTimer),t.data.scrollTimer=null),t.data.canDragDrop!==!1&&r._triggerGridEvent("hiddenHeaderDragDrop",{dropColumn:t.data.columnIndex,dropColumnMapping:t.data.dragColumnMapping,leftColumn:t.data.leftColumn,leftColumnMapping:t.data.leftColumnMapping,rightColumn:t.data.rightColumn,rightColumnMapping:t.data.rightColumnMapping,toHiddenColumnArea:t.data.toHideArea})!==!1){if(t.data.toHideArea){var i=e.inArray(l,r.state.hiddenColumnIdxArr);if(null!=t.data.targetHiddenColumnIndex){var d=e.inArray(Number(t.data.targetHiddenColumnIndex),r.state.hiddenColumnIdxArr);null!=d&&d!==-1?(r.option.hiddenColumnOrderList.splice(i,1),r.option.hiddenColumnOrderList.splice(d,0,l),r.state.hiddenColumnIdxArr.splice(i,1),r.state.hiddenColumnIdxArr.splice(d,0,l)):(r.option.hiddenColumnOrderList.splice(i,1),r.option.hiddenColumnOrderList.push(l),r.state.hiddenColumnIdxArr.splice(i,1),r.state.hiddenColumnIdxArr.push(l))}else{if(r.state.hiddenColumnIdxArr&&r.state.hiddenColumnIdxArr.length>0&&r.state.hiddenColumnIdxArr[r.state.hiddenColumnIdxArr.length-1]===l)return;r.option.hiddenColumnOrderList.splice(i,1),r.option.hiddenColumnOrderList.push(l),r.state.hiddenColumnIdxArr.splice(i,1),r.state.hiddenColumnIdxArr.push(l)}return r.calcAndRedraw(),void a(r,t.data)}if(null!==t.data.atColumnIndex){var s=r.state.hiddenColumnIndexToMapping[l];if(null!=s){var p=e.inArray(s.columnIndex,r.state.hiddenColumnIdxArr);r.option.hiddenColumnOrderList.splice(p,1),r.state.hiddenColumnIdxArr.splice(p,1),delete r.state.hiddenColumnIndexToMapping[l]}r.showCol(l);var u=t.data.atColumnIndex,c=e.inArray(l,r.state.visibleColumnIndexArr),g=e.inArray(u,r.state.visibleColumnIndexArr);if(l===u)return void a(r,t.data);if(t.data.after&&c===g+1)return void a(r,t.data);if(!t.data.after&&c+1===g)return void a(r,t.data);var f=r.state.columnIndexToMapping[l],h=r.state.columnIndexToMapping[u];if(r.option.grouping&&r.option.grouping.by.length>0&&r.option.grouping.useDragDropBetweenGroups===!1&&r.option.grouping.useGroupColumnRearrange===!0&&t.data.groupDragDrop===!1){var m=r.state.groupingColumnIndexToMapping[l],v=r._getColumnByKey(h.key);if(null!==m&&void 0!==m){var x=r.option.grouping.by,y=x[x.length-1],C=(r._getColumnByKey(y)||{}).columnIndex,I=e.inArray(C,r.state.visibleColumnIndexArr),_=r.state.visibleColumnIndexArr[I+1],w=r.state.columnIndexToKeyMap[_],b=e.inArray(f.key,r.option.grouping.by);r.option.grouping.by.splice(b,1),r.option.grouping.by.push(w),r.state.sortingRequired=!0}else if(v){var M=e.inArray(h.key,r.option.grouping.by);r.option.grouping.by.splice(M,0,f.key),r.option.grouping.by.splice(r.option.grouping.by.length-1,1),r.state.sortingRequired=!0}}var S=[],E={};if(null!==r.option.autoColumnIndex&&void 0!==r.option.autoColumnIndex&&r.option.autoColumnIndex===!0)if(l>u){t.data.after&&(g+=1,u=r.state.visibleColumnIndexArr[g]);for(var T=u;T<l;T++)h=r.state.columnIndexToMapping[T],h.columnIndex=T+1,$(r,h,T,S,E);W(r,S,E),f.columnIndex=u,r.option.columnMapping.splice(u,0,f),r.option.columnMapping.splice(l+1,1)}else{t.data.after||(g-=1,u=r.state.visibleColumnIndexArr[g]);for(var T=l+1;T<u+1;T++)h=r.state.columnIndexToMapping[T],h.columnIndex=T-1,$(r,h,T,S,E);W(r,S,E),f.columnIndex=u,r.option.columnMapping.splice(u+1,0,f),r.option.columnMapping.splice(l,1)}else{if(c>g){t.data.after&&(g+=1,u=r.state.visibleColumnIndexArr[g]);for(var D,T=g;T<c;T++)D=r.state.columnIndexArr[T],h=r.state.columnIndexToMapping[D],h.columnIndex=r.state.columnIndexArr[T+1],$(r,h,T,S,E);W(r,S,E)}else{t.data.after||(g-=1,u=r.state.visibleColumnIndexArr[g]);for(var D,T=c+1;T<g+1;T++)D=r.state.columnIndexArr[T],h=r.state.columnIndexToMapping[D],h.columnIndex=r.state.columnIndexArr[T-1],$(r,h,T,S,E);W(r,S,E)}f.columnIndex=u}if(t.data.groupDragDrop){for(var R,F=r.option.grouping.by,k=[],L=0,A=F.length;L<A;L++)R=r._getColumnByKey(F[L]),k[R.columnIndex]=R.key;r.option.grouping.by=k.filter(n),r.state.sortingRequired=!0}r.updateOption(),r.state.hiddenColumnDraging=!1,a(r,t.data)}}})},kt.prototype._headerDragStart=function(t,a){var n=this,r=e.event.fix(t);if("touchstart"===t.type)r=t.touches[0];else if(1!=t.which)return;t.preventDefault(),n.$wrapper.off(".alopexgridHeaderSelectEngine");var o=".alopexgridheaderdragdropevent",l=n.$columnhiddenarea,d=e(t.target).closest(".headercell"),s={};s.self=n,s.headerDragDropEventNS=o,s.selfTo=null,s.hiddenColArea=l,s.hiddenColAreaVisible="none"!==l.css("display"),s.headercell=d,s.columnIndex=a,s.wrapperX=n.$wrapper.offset().left,s.atColumnIndex=null,s.targetHiddenColumnIndex=null,s.after=!1,s.$proxy=null,s.$bar=null,s.scrollTimer=null,s.prevX=r.pageX,s.prevY=r.pageY,s.toHideArea=!1,s.canDragDrop=!0,s.groupDragDrop=!1,s.dragColumnMapping=null,s.leftColumn=null,s.leftColumnMapping=null,s.rightColumn=null,s.rightColumnMapping=null,s.toHiddenColumnArea=null,s.targetHiddenColumn=null,s.targetHiddenColumnMapping=null,xt.off(o+n.key),xt.on("keydown"+o+n.key+n.eventns,s,function(e){var t=e.data.self,a=e.data.hiddenColArea,n=e.keyCode;switch(n){case 27:xt.off(e.data.headerDragDropEventNS+t.key),t._enableHeaderSelect(!!t.option.enableHeaderSelect),a.removeClass("focused"),e.data.$proxy&&(e.data.$proxy.remove(),delete e.data.$proxy),e.data.$bar&&(e.data.$bar.remove(),delete e.data.$bar),e.data.scrollTimer&&(clearInterval(e.data.scrollTimer),e.data.scrollTimer=null),null!==e.data.atColumnIndex&&(e.data.atColumnIndex=null)}}),xt.on("mousemove"+o+n.key+n.eventns+" touchmove"+o+n.key+n.eventns,s,function(t){var a=t,n=t.target;if("touchmove"===t.type&&(a=t.originalEvent.touches[0],n=document.elementFromPoint(a.clientX,a.clientY)),t.data.prevX!==a.pageX||t.data.prevY!==a.pageY){t.data.prevX=a.pageX,t.data.prevY=a.pageY;var r=t.data.self,o=t.data.hiddenColArea,l=t.data.headercell,d=t.data.columnIndex;t.preventDefault(),i();var s=t.data.$proxy,p=t.data.$bar;if(null==s){s=e("<div>"),s.addClass(pt+" alopexgrid-proxy alopexgrid-dragdrop-header alopexgrid-refer-"+r.key);var u=e('<div class="'+pt+'"><div>').css("overflow","visible"),c=e('<div class="wrapper"><div>').css("overflow","visible");if(null!=l){var g=l.clone();g.css({top:"0px",left:"0px"}),c.append(g)}if(yt===!1){var f,h,m,v=r.columnInfo(d),x=r.state.refreshbodycell.renderedDataList;m=null==g?0:g.height();for(var y=0,C=x.length;y<C;y++)h=x[y],f=e(r._createCell(h,v)),f.css({top:m+"px",left:"0px",height:r.state.rowHeight+"px",width:r.state.columnFitWidthById[v.id]+"px"}),f.appendTo(c),m+=r.state.rowHeight}u.append(c),s.append(u),s.appendTo(document.body),t.data.$proxy=s}null==p&&(p=e("<div>"),p.addClass("alopexgrid-dragdrop-header-indicator"),t.data.$bar=p),t.data.$bar.prependTo(r.$wrapper),t.data.$proxy.css({top:a.pageY+"px",left:a.pageX+"px"}),t.data.scrollTimer&&(clearInterval(t.data.scrollTimer),t.data.scrollTimer=null);var I=r.state.refreshbodycell.bodyCellStartX;r.state.fixedColumnWidth>0&&(I+=r.state.fixedColumnWidth);var _=r.state.refreshbodycell.bodyCellEndX;if(t.data.hiddenColAreaVisible){var w=o.get(0).scrollWidth>o.innerWidth(),b=o.offset().top+o.height();if(w)var M=o.scrollLeft(),S=o.offset().left,E=S+o.width(),T=1}var D=t.data,R=a.pageX,F=a.pageY;if(R<=t.data.wrapperX+I){var k=Math.ceil(Math.abs(R-(t.data.wrapperX+I))/25),L=function(){D.hiddenColAreaVisible&&F<=b?w&&S-R>0&&(o.scrollLeft(M-(S-R)*T),T+=5):r._scrollLeftEvent(k)};L(),t.data.scrollTimer=setInterval(L,100)}else if(R>=t.data.wrapperX+_){var k=Math.ceil(Math.abs(R-(t.data.wrapperX+_))/25),L=function(){D.hiddenColAreaVisible&&F<=b?w&&R-E>0&&(o.scrollLeft(M+(R-E)*T),T+=5):r._scrollRightEvent(k)};L(),t.data.scrollTimer=setInterval(L,100)}var A=r.state.renderTargetMappingInfo,O=A.fixedRenderTargetMapping,P=A.renderTargetWidth,B=A.fitRatio,G=r.state.scrollxEnd,H=0;G&&P>r.state.wrapperWidth&&(H=P-r.state.wrapperWidth);var N=!0,$=e(n),W=$.closest(".columnhiddenarea");if($.closest(".alopexgrid-dragdrop-header")&&0!==$.closest(".alopexgrid-dragdrop-header").length)return void o.removeClass("focused");
if(W&&0!==W.length&&"true"===W.attr("data-alopexgrid-columnhiddenarea")){t.data.atColumnIndex=null,t.data.toHideArea=!0,o.addClass("focused");var K=$.closest(".headercell");K&&0!==K.length?t.data.targetHiddenColumnIndex=K.attr("data-alopexgrid-columnindex"):t.data.targetHiddenColumnIndex=null,t.data.dragColumnMapping=r.state.columnIndexToMapping[d];var U=t.data.targetHiddenColumnIndex,Y=null;null!=t.data.targetHiddenColumnIndex&&(U=Number(t.data.targetHiddenColumnIndex),Y=r.state.columnIndexToMapping[U]);var V=r._triggerGridEvent("headerDragOver",{dragColumn:d,dragColumnMapping:t.data.dragColumnMapping,leftColumn:null,leftColumnMapping:null,rightColumn:null,rightColumnMapping:null,toHiddenColumnArea:t.data.toHideArea,targetHiddenColumn:U,targetHiddenColumnMapping:Y});V?(t.data.canDragDrop=!0,t.data.$proxy.removeClass("disabled")):(t.data.canDragDrop=!1,t.data.$proxy.addClass("disabled"))}else{t.data.toHideArea=!1,t.data.targetHiddenColumnIndex=null,o.removeClass("focused");var C=r.state.refreshbodycell.renderedColumnMappingList.length,K=$.closest(".headercell"),X=$.closest(".bodycell"),z=$.closest(".footercell"),j=$.closest(".filtercell"),q=$.closest(".pager"),Z=$.closest("."+pt);if(null!=K&&0!==K.length||null!=X&&0!==X.length||null!=z&&0!==z.length||null!=j&&0!==j.length||null!=q&&0!==q.length)for(var Q=0;Q<C;Q++){var J=r.state.refreshbodycell.renderedColumnMappingList[Q],ee=J.columnIndex,te=(r.state.columnIndexToMapping[ee],r.state.columnWidthMap[ee]);1!==B&&(te*=r.state.refreshbodycell.fitRatio),O.length>0&&r.state.refreshbodycell.renderedColumnMappingList[O.length].columnIndex===ee&&(te-=H);var ae=r.state.refreshbodycell.bodyCellPositionXForHeaderDrag[Q],ne=ae+t.data.wrapperX;if(R>=ne&&R<=ne+te){t.data.atColumnIndex=ee,Math.abs(R-ne)>Math.abs(R-(ne+te))?(t.data.after=!0,It?t.data.$bar.css("left",ae+te+"px"):t.data.$bar.css("transform","translateX("+(ae+te)+"px)")):(t.data.after=!1,It?t.data.$bar.css("left",ae+"px"):t.data.$bar.css("transform","translateX("+ae+"px)"));break}}else if(null!=Z&&0!==Z.length){t.data.after=!0;var ee,J=r.state.refreshbodycell.renderedColumnMappingList[C-1];ee=null==J?Math.min.apply(null,r.state.hiddenColumnIdxArr):J.columnIndex,d===ee?(t.data.atColumnIndex=null,t.data.canDragDrop=!1):(t.data.atColumnIndex=ee,N=!1)}else t.data.atColumnIndex=null,t.data.canDragDrop=!1}if(t.data.toHideArea===!1&&null!==t.data.atColumnIndex){N?t.data.$bar.show():t.data.$bar.hide(),t.data.dragColumnMapping=r.state.columnIndexToMapping[d];var re=e.inArray(t.data.atColumnIndex,r.state.visibleColumnIndexArr);t.data.after?(t.data.leftColumn=t.data.atColumnIndex,t.data.leftColumnMapping=r.state.columnIndexToMapping[t.data.atColumnIndex],t.data.rightColumn=r.state.visibleColumnIndexArr[re+1],null===t.data.rightColumn||void 0===t.data.rightColumn?(t.data.lrightColumn=null,t.data.lrightColumnMapping=null):t.data.rightColumnMapping=r.state.columnIndexToMapping[t.data.rightColumn]):(t.data.leftColumn=r.state.visibleColumnIndexArr[re-1],null===t.data.leftColumn||void 0===t.data.leftColumn?(t.data.leftColumn=null,t.data.leftColumnMapping=null):t.data.leftColumnMapping=r.state.columnIndexToMapping[t.data.leftColumn],t.data.rightColumn=t.data.atColumnIndex,t.data.rightColumnMapping=r.state.columnIndexToMapping[t.data.rightColumn]);var V=r._triggerGridEvent("headerDragOver",{dragColumn:d,dragColumnMapping:t.data.dragColumnMapping,leftColumn:t.data.leftColumn,leftColumnMapping:t.data.leftColumnMapping,rightColumn:t.data.rightColumn,rightColumnMapping:t.data.rightColumnMapping,toHiddenColumnArea:t.data.toHideArea,targetHiddenColumn:null,targetHiddenColumnMapping:null});if(V&&(t.data.canDragDrop=!0,t.data.$bar.removeClass("disabled"),t.data.$proxy.removeClass("disabled")),r.option.grouping&&r.option.grouping.by.length>0&&r.option.grouping.useGroupColumnRearrange===!0){var oe;t.data.after?(re+=1,oe=r.state.visibleColumnIndexArr[re]):oe=r.state.visibleColumnIndexArr[re];var le=r.state.groupingColumnIndexToMapping[d],Y=r.state.groupingColumnIndexToMapping[oe];if(r.option.grouping.useDragDropBetweenGroups)null!==le&&void 0!==le&&null!==Y&&void 0!==Y?(t.data.canDragDrop=!0,t.data.groupDragDrop=!0,t.data.$bar.removeClass("disabled"),t.data.$proxy.removeClass("disabled")):null!==le&&void 0!==le||null!==Y&&void 0!==Y?(t.data.groupDragDrop=!1,t.data.canDragDrop=!1,t.data.$bar.addClass("disabled"),t.data.$proxy.addClass("disabled")):(t.data.groupDragDrop=!1,t.data.canDragDrop=!0,t.data.$bar.removeClass("disabled"),t.data.$proxy.removeClass("disabled"));else if(null!==le&&void 0!==le&&null!==Y&&void 0!==Y)t.data.canDragDrop=!0,t.data.groupDragDrop=!0,t.data.$bar.removeClass("disabled"),t.data.$proxy.removeClass("disabled");else if(null===le||void 0===le||null!==Y&&void 0!==Y)if(null!==le&&void 0!==le||null===Y||void 0===Y)t.data.groupDragDrop=!1,t.data.canDragDrop=!0,t.data.$bar.removeClass("disabled"),t.data.$proxy.removeClass("disabled");else{t.data.groupDragDrop=!1;var ie=r.state.columnIndexToKeyMap[d];"undefined"===ie?(t.data.canDragDrop=!1,t.data.$bar.addClass("disabled"),t.data.$proxy.addClass("disabled")):(t.data.canDragDrop=!0,t.data.$bar.removeClass("disabled"),t.data.$proxy.removeClass("disabled"))}else{t.data.groupDragDrop=!1;var de=r.option.grouping.by,se=de[de.length-1],pe=(r._getColumnByKey(se)||{}).columnIndex,ue=e.inArray(pe,r.state.visibleColumnIndexArr),ce=r.state.visibleColumnIndexArr[ue+1],ge=r.state.columnIndexToKeyMap[ce];"undefined"===ge?(t.data.canDragDrop=!1,t.data.$bar.addClass("disabled"),t.data.$proxy.addClass("disabled")):(t.data.canDragDrop=!0,t.data.$bar.removeClass("disabled"),t.data.$proxy.removeClass("disabled"))}}V===!1&&(t.data.canDragDrop=!1,t.data.$bar.addClass("disabled"),t.data.$proxy.addClass("disabled"))}else t.data.$bar.hide()}}).on("mouseup"+o+n.key+n.eventns+" touchend"+o+n.key+n.eventns+" touchcancel"+o+n.key+n.eventns,s,function(t){function a(e,a){e._triggerGridEvent("headerDragDropEnd",{dropColumn:a.columnIndex,dropColumnMapping:a.dragColumnMapping,leftColumn:a.leftColumn,leftColumnMapping:a.leftColumnMapping,rightColumn:a.rightColumn,rightColumnMapping:a.rightColumnMapping,toHiddenColumnArea:t.data.toHideArea})}function n(e){return null!=e}var r=t.data.self,o=t.data.headercell,l=t.data.hiddenColArea,i=t.data.columnIndex;if(xt.off(t.data.headerDragDropEventNS+r.key),r._enableHeaderSelect(!!r.option.enableHeaderSelect),l.removeClass("focused"),t.data.$proxy&&(t.data.$proxy.remove(),delete t.data.$proxy),t.data.$bar&&(t.data.$bar.remove(),delete t.data.$bar),t.data.scrollTimer&&(clearInterval(t.data.scrollTimer),t.data.scrollTimer=null),t.data.canDragDrop!==!1&&r._triggerGridEvent("headerDragDrop",{dropColumn:t.data.columnIndex,dropColumnMapping:t.data.dragColumnMapping,leftColumn:t.data.leftColumn,leftColumnMapping:t.data.leftColumnMapping,rightColumn:t.data.rightColumn,rightColumnMapping:t.data.rightColumnMapping,toHiddenColumnArea:t.data.toHideArea})!==!1){if(t.data.toHideArea){if(null==o)return;var d=r.state.columnIndexToMapping[i];if(null!=t.data.targetHiddenColumnIndex){var s=e.inArray(Number(t.data.targetHiddenColumnIndex),r.state.hiddenColumnIdxArr);null!=s&&s!==-1?(r.option.hiddenColumnOrderList.splice(s,0,i),r.state.hiddenColumnIdxArr.splice(s,0,i)):(r.option.hiddenColumnOrderList.push(i),r.state.hiddenColumnIdxArr.push(i))}else r.option.hiddenColumnOrderList.push(i),r.state.hiddenColumnIdxArr.push(i);return r.state.hiddenColumnIndexToMapping[i]=d,r.hideCol(i),void a(r,t.data)}if(null!==t.data.atColumnIndex){var p=t.data.atColumnIndex,u=e.inArray(i,r.state.visibleColumnIndexArr),c=e.inArray(p,r.state.visibleColumnIndexArr);if(i===p)return void a(r,t.data);if(t.data.after&&u===c+1)return void a(r,t.data);if(!t.data.after&&u+1===c)return void a(r,t.data);var d=r.state.columnIndexToMapping[i],g=r.state.columnIndexToMapping[p];if(r.option.grouping&&r.option.grouping.by.length>0&&r.option.grouping.useDragDropBetweenGroups===!1&&r.option.grouping.useGroupColumnRearrange===!0&&t.data.groupDragDrop===!1){var f=r.state.groupingColumnIndexToMapping[i],h=r._getColumnByKey(g.key);if(null!==f&&void 0!==f){var m=r.option.grouping.by,v=m[m.length-1],x=(r._getColumnByKey(v)||{}).columnIndex,y=e.inArray(x,r.state.visibleColumnIndexArr),C=r.state.visibleColumnIndexArr[y+1],I=r.state.columnIndexToKeyMap[C],_=e.inArray(d.key,r.option.grouping.by);r.option.grouping.by.splice(_,1),r.option.grouping.by.push(I),r.state.sortingRequired=!0}else if(h){var w=e.inArray(g.key,r.option.grouping.by);r.option.grouping.by.splice(w,0,d.key),r.option.grouping.by.splice(r.option.grouping.by.length-1,1),r.state.sortingRequired=!0}}var b=[],M={};if(null!=r.option.autoColumnIndex&&r.option.autoColumnIndex===!0)if(i>p){t.data.after&&(c+=1,p=r.state.visibleColumnIndexArr[c]);for(var S=p;S<i;S++)g=r.state.columnIndexToMapping[S],g.columnIndex=S+1,$(r,g,S,b,M);W(r,b,M),d.columnIndex=p,r.option.columnMapping.splice(p,0,d),r.option.columnMapping.splice(i+1,1)}else{t.data.after||(c-=1,p=r.state.visibleColumnIndexArr[c]);for(var S=i+1;S<p+1;S++)g=r.state.columnIndexToMapping[S],g.columnIndex=S-1,$(r,g,S,b,M);W(r,b,M),d.columnIndex=p,r.option.columnMapping.splice(p+1,0,d),r.option.columnMapping.splice(i,1)}else{if(u>c){t.data.after&&(c+=1,p=r.state.visibleColumnIndexArr[c]);for(var E,S=c;S<u;S++)E=r.state.columnIndexArr[S],g=r.state.columnIndexToMapping[E],g.columnIndex=r.state.columnIndexArr[S+1],$(r,g,S,b,M);W(r,b,M)}else{t.data.after||(c-=1,p=r.state.visibleColumnIndexArr[c]);for(var E,S=u+1;S<c+1;S++)E=r.state.columnIndexArr[S],g=r.state.columnIndexToMapping[E],g.columnIndex=r.state.columnIndexArr[S-1],$(r,g,S,b,M);W(r,b,M)}d.columnIndex=p}if(t.data.groupDragDrop){for(var T,D=r.option.grouping.by,R=[],F=0,k=D.length;F<k;F++)T=r._getColumnByKey(D[F]),R[T.columnIndex]=T.key;r.option.grouping.by=R.filter(n),r.state.sortingRequired=!0}r.updateOption(),a(r,t.data)}}})},kt.prototype._rowDragStart=function(t){function a(e,t){var a=e.self,n=e.selfTo,r=e.dragOverData||null,o=r?e.self._dataGetByIndex({row:r._index.row-1}):null,l=r?e.self._dataGetByIndex({row:r._index.row+1}):null,i=e.atDataIndex<0,d=null;if(e.treeInfo)if(e.center)d=r;else{var s,p,u,c,g=e.atRowIndex+(e.after?1:0);null!==n?(s=n._dataGetByIndex({row:g-1}),p=n._dataGetByIndex({row:g}),u=n._getTreeNodeDepth(s),c=n._getTreeNodeDepth(p)):(s=a._dataGetByIndex({row:g-1}),p=a._dataGetByIndex({row:g}),u=a._getTreeNodeDepth(s),c=a._getTreeNodeDepth(p)),s&&(d=null!==n?n.treeGetParent(s)[0]:a.treeGetParent(s)[0],u>c?d=null!==n?n.treeGetParent(n.treeGetParent(s,{recursive:!0})[0])[0]:a.treeGetParent(a.treeGetParent(s,{recursive:!0})[0])[0]:u<c&&(d=s))}var f={dragDataList:e.dragdata,data:r,aboveData:o,belowData:l,insertAbove:!e.center&&!i&&!e.after,insertBelow:!e.center&&!i&&!!e.after,childOf:d,barVisible:i,$grid:e.selfTo?e.selfTo.$root:e.self.$root,toAnotherGrid:!!e.selfTo,cancelled:t===!0};return f}var n=this,r=e.event.fix(t);"touchstart"===t.type&&(r=t.touches[0]),t.preventDefault();var o=".alopexgriddragdropevent",l=e(t.target).closest(".bodycell"),d=l.attr("data-alopexgrid-dataid"),s=n._dataGetByIndex({id:d});if(null!=s){var p={};if(p.self=n,p.selfTo=null,p.rowDragDropEventNS=o,p.wrapperY=n.$wrapper.offset().top,p.$proxy=null,p.$bar=null,p.dragdata=[s],n.option.multiRowDragDrop===!0){var u=n.dataGet({_state:{selected:!0}});if(null!=u&&0!=u.length)for(var c=u.length-1;c>=0;c--)if(u[c]==s){u=e.map(u,function(e){if(null!=e._index.row)return e}),p.dragdata=u;break}}p.atDataIndex=null,p.canDragDrop=!0,p.after=!1,p.scrollTimer=null,p.lastHoverGrid=null,p.prevX=r.pageX,p.prevY=r.pageY,p.treeInfo=n.state.treeInfo||null,xt.off(o+n.key),xt.on("keydown"+o+n.key+n.eventns,p,function(e){var t=e.keyCode;switch(t){case 27:xt.off(e.data.rowDragDropEventNS+n.key),e.data.$proxy&&(e.data.$proxy.remove(),delete e.data.$proxy),e.data.$bar&&(e.data.$bar.remove(),delete e.data.$bar),e.data.scrollTimer&&(clearInterval(e.data.scrollTimer),e.data.scrollTimer=null),null!==e.data.atColumnIndex&&(e.data.atColumnIndex=null)}}),xt.on("mousemove"+o+n.key+n.eventns+" touchmove"+o+n.key+n.eventns,p,function(t){var n=t,r=t.target;if("touchmove"===t.type&&(n=t.originalEvent.touches[0],r=document.elementFromPoint(n.clientX,n.clientY)),t.data.prevX!==n.pageX||t.data.prevY!==n.pageY){t.data.prevX=n.pageX,t.data.prevY=n.pageY,t.preventDefault(),i();var o=t.data.self,l=t.data.$proxy,d=t.data.$bar;if(null==l){l=e("<div>"),l.addClass(pt+" alopexgrid-proxy alopexgrid-dragdrop-row alopexgrid-refer-"+o.key);for(var s=e('<div class="'+pt+'">').css("overflow","visible"),p=e('<div class="wrapper">').css("overflow","visible"),u=o.state.refreshbodycell.renderedColumnMappingList,c=0,g=0,f=t.data.dragdata.length>10?10:t.data.dragdata.length,h=0,m=f;h<m;h++){var v=t.data.dragdata[h];c=0;for(var x=0,y=u.length;x<y;x++){var C=u[x],I=e(o._createCell(v,C)),_=Math.round(o.state.renderTargetMappingInfo.fitRatio*parseInt(C.width)*.5);I.css({top:g+"px",left:c+"px",height:o.state.rowHeight+"px",width:_+"px","z-index":-1*h}),c+=_,I.appendTo(p)}g+=parseInt(o.state.rowHeight/3)}s.append(p),l.append(s),l.appendTo(document.body),t.data.$proxy=l}null==d&&(d=e("<div>"),d.addClass("alopexgrid-dragdrop-row-indicator"),t.data.$bar=d);var w=e(r),b=w.closest("."+pt);t.data.canDragDrop=!0,t.data.$bar.removeClass("disabled"),t.data.$proxy.removeClass("disabled");var M=!1;if(b&&0!==b.length&&void 0!=b.attr("id")&&b.attr("id")!=o.$root.attr("id")&&0==w.closest(".alopexgrid-enlarge-content").length){var S="#"+b.attr("id");o=e(S).__alopexgrid(),t.data.$bar.prependTo(b.children(".wrapper")),o.option.enableDropData===!1?M=!0:(t.data.wrapperY=o.$wrapper.offset().top,t.data.selfTo=o)}else o=t.data.self,t.data.$bar.prependTo(o.$wrapper),t.data.wrapperY=o.$wrapper.offset().top,t.data.selfTo=null;l.css({top:n.pageY+"px",left:n.pageX+"px"}),t.data.scrollTimer&&(clearInterval(t.data.scrollTimer),t.data.scrollTimer=null),t.data.treeExpandTimer&&(clearTimeout(t.data.treeExpandTimer),t.data.treeExpandTimer=null);var E=o.state.refreshbodycell.bodyCellStartY,T=o.state.refreshbodycell.bodyCellEndY;t.data.atRowIndex=null,t.data.atDataIndex=null,t.data.dragOverData=null;var D=n.pageY;if(D<=t.data.wrapperY+E){var R=Math.ceil(Math.abs(D-(t.data.wrapperY+E))/25),F=function(){o.state.scrollyMoveable&&o._scrollUpEvent(R)};F(),t.data.scrollTimer=setInterval(F,100)}else if(D>=t.data.wrapperY+T){var R=Math.ceil(Math.abs(D-(t.data.wrapperY+T))/25),F=function(){o.state.scrollyMoveable&&o._scrollDownEvent(R)};F(),t.data.scrollTimer=setInterval(F,100)}else{for(var k=0,y=o.state.refreshbodycell.renderedDataList.length;k<y;k++){var L=o.state.refreshbodycell.renderedDataList[k],A=L._index.data,O=o.state.refreshbodycell.bodyCellPositionY[k],P=O+t.data.wrapperY,B=o.state.rowHeightMapByDataId[L._index.id]||o.state.rowHeight;if(D>=P){if(D<=P+B){t.data.dragOverData=L,t.data.atDataIndex=A,t.data.atRowIndex=L._index.row;var G=Math.abs(D-P),H=Math.abs(D-(P+B)),N=G-H;if(N>0?(t.data.after=!0,It?t.data.$bar.css("top",O+B+"px"):t.data.$bar.css("transform","translateY("+(O+B)+"px)")):(t.data.after=!1,It?t.data.$bar.css("top",O+"px"):t.data.$bar.css("transform","translateY("+O+"px)")),t.data.treeInfo){var $=B-Math.min(2*o.state.rowHeight/3,2*B/3);t.data.$bar.css("height",""),t.data.center=Math.abs(N)<$,t.data.center?(It?t.data.$bar.css("top",O+"px"):t.data.$bar.css("transform","translateY("+O+"px)"),t.data.$bar.css("height",B+"px"),t.data.$bar.addClass("alopexgrid-dragdrop-parentrow-indicator"),o._isTreeLeafNode(L)||o._isTreeNodeExpanded(L)||(t.data.treeExpandTimer=setTimeout(function(){o.expandTreeNode(L)},o.option.tree.dragdropExpandDelay||0))):t.data.$bar.removeClass("alopexgrid-dragdrop-parentrow-indicator");var W=null;if(t.data.center)W=o.state.data[t.data.atDataIndex];else{var K=t.data.atRowIndex;t.data.after&&(K+=1);var U=o._dataGetByIndex({row:K-1}),Y=o._dataGetByIndex({row:K}),V=o._getTreeNodeDepth(U),X=o._getTreeNodeDepth(Y);W=null,U&&(W=o.treeGetParent(U)[0],V<X&&(W=U))}var L=t.data.dragdata[0];W&&(L===W||o._isTreeNodeIncludeChild(L,W))&&(M=!0)}break}k==y-1&&(t.data.after=!0,t.data.atDataIndex=A,t.data.atRowIndex=L._index.row)}}0==o.state.refreshbodycell.renderedDataList.length&&(t.data.after=!1,t.data.atDataIndex=-1,t.data.atRowIndex=-1)}null!=t.data.atDataIndex?t.data.$bar.show():t.data.$bar.hide();var z=o._triggerGridEvent("rowDragOver",a(t.data));z||(M=!0),M&&(t.data.canDragDrop=!1),t.data.canDragDrop||(t.data.$bar.addClass("disabled"),t.data.$proxy.addClass("disabled"))}}).on("mouseup"+o+n.key+n.eventns+" touchend"+o+n.key+n.eventns+" touchcancel"+o+n.key+n.eventns,p,function(e){var t=e.data.self,n=e.data.selfTo;if(xt.off(e.data.rowDragDropEventNS+t.key),e.data.$proxy&&(e.data.$proxy.remove(),delete e.data.$proxy),e.data.$bar&&(e.data.$bar.remove(),delete e.data.$bar),e.data.scrollTimer&&(clearInterval(e.data.scrollTimer),e.data.scrollTimer=null),e.data.canDragDrop!==!1)if(t._triggerGridEvent("rowDragDrop",a(e.data)),e.data.center&&null!=e.data.atDataIndex){var r=!1;e.data.atDataIndex<0&&(e.data.atDataIndex=0,r=!0);for(var o=t.state.data[e.data.atDataIndex],l=e.data.dragdata,i=l.length-1;i>0;i--)for(var d=l[i],s=i-1;s>=0;s--){var p=l[s],u=t.treeGetParent(d,{recursive:!0});u.indexOf(p)>-1&&l.splice(i,1)}for(var c=0,i=0;i<l.length;i++){if(m=l[i],null!==n&&(o=n.state.data[e.data.atDataIndex]),o&&(m===o||t._isTreeNodeIncludeChild(m,o)))return void t._triggerGridEvent("rowDragDropEnd",a(e.data,!0));if(null!==n){var g=void 0==o?"":o[n.option.tree.idKey];w=m._index.id,m=t._addTreeChildToList(m);for(var s=0;s<m.length;s++)m[s][n.option.tree.expandedKey]=t.state.treeOption.expandedValue[m[s]._state.expandedTreeNode?0:1];m=kt.trimData(m),t.dataDelete({_index:{id:w}}),void 0!==o&&0==r?(m[0][t.option.tree.parentIdKey]=g,n.dataAdd(m,{_index:{id:o._index.id}})):(n.dataAdd(m,{_index:{data:c}}),c+=m.length)}else t.treeDataMove(m,o)}t._triggerGridEvent("rowDragDropEnd",a(e.data,!1))}else if(null!==e.data.atDataIndex){var r=!1;e.data.atDataIndex<0&&e.data.atRowIndex<0&&(e.data.atDataIndex=0,e.data.atRowIndex=0,r=!0);var f=e.data.atDataIndex,h=e.data.atRowIndex,m=e.data.dragdata[0],v=e.data.after;if(v&&(f+=1,h+=1),e.data.treeInfo){for(var l=e.data.dragdata,i=l.length-1;i>0;i--){for(var d=l[i],s=i-1;s>=0;s--){var p=l[s],u=t.treeGetParent(d,{recursive:!0});u.indexOf(p)>-1&&(l[i].flag=!0)}l[i].flag&&l.splice(i,1)}for(var i=l.length-1;i>=0;i--){m=l[i];var x,y,C,I;null!==n?(x=n._dataGetByIndex({row:h-1}),y=n._dataGetByIndex({row:h}),C=n._getTreeNodeDepth(x),I=n._getTreeNodeDepth(y)):(x=t._dataGetByIndex({row:h-1}),y=t._dataGetByIndex({row:h}),C=t._getTreeNodeDepth(x),I=t._getTreeNodeDepth(y));var o=null;if(x&&(o=null!==n?n.treeGetParent(x)[0]:t.treeGetParent(x)[0],C>I?o=null!==n?n.treeGetParent(n.treeGetParent(x,{recursive:!0})[0])[0]:t.treeGetParent(t.treeGetParent(x,{recursive:!0})[0])[0]:C<I&&(o=x)),o&&(m===o||t._isTreeNodeIncludeChild(m,o)))return void t._triggerGridEvent("rowDragDropEnd",a(e.data,!0));if(null!==n){var g=null==o?"":o[n.option.tree.idKey];w=m._index.id,m=t._addTreeChildToList(m);for(var s=0;s<m.length;s++)m[s][n.option.tree.expandedKey]=t.state.treeOption.expandedValue[m[s]._state.expandedTreeNode?0:1];m=kt.trimData(m),t.dataDelete({_index:{id:w}}),m[0][t.option.tree.parentIdKey]=g,n.dataAdd(m,{_index:{data:f}})}else t.treeDataMove(m,o,{_index:{row:h}}),m._index.row<h&&(h-=t._addTreeChildToList(m).length)}return void t._triggerGridEvent("rowDragDropEnd",a(e.data,!1))}var _=m._index.data,w=_>f?_+1:_;null!==n?(w=m._index.id,1==e.data.dragdata.length?(m=kt.trimData(m),t.dataDelete({_index:{id:w}}),n.dataAdd(m,{_index:{data:f}})):e.data.dragdata.length>1&&(t.dataDelete(e.data.dragdata),m=kt.trimData(e.data.dragdata),n.dataAdd(m,{_index:{data:f}}))):1==e.data.dragdata.length?(t.state.data.splice(f,0,m),t.state.data.splice(w,1),Ee(t),t.sortClear(),t.calcAndRedraw()):e.data.dragdata.length>1&&(t.dataMove({_state:{selected:!0}},{_index:{data:f}}),t.state.data.length==f?t.dataMove({_state:{selected:!0}},{_index:{data:f-1}},v):t.dataMove({_state:{selected:!0}},{_index:{data:f}})),t._triggerGridEvent("rowDragDropEnd",a(e.data,!1))}})}},kt.prototype._rowResizeStart=function(t,a,n){if(t&&t.type){var r=this;if(!r.state.rowResizing&&(t=e.event.fix(t),"dblclick"!==t.type)){var o=e.event.fix(t);"touchstart"===t.type&&(o=t.originalEvent.touches[0]),r.state.$rowResizeBar&&(r.state.$rowResizeBar.remove(),r.state.$rowResizeBar=null);var l=".alopexgridrowresizeevent";r.state.rowHeightMapByDataId=r.state.rowHeightMapByDataId||{};var i=e(t.target),d=i.closest(".bodycell"),s=r._dataGetByIndex({row:a}),p=r.state.columnIndexToMapping[n],u=s._index.id,c=r.state.groupRowspanned&&p.rowspan?r._getGroupingRangeByMapping(s._index.data,p):null;if(c)for(var g=c.member.length;g>0;)if(s=c.member[--g],null!=s._index.row&&r.state.refreshbodycell&&r.state.refreshbodycell.renderedDataIdMap&&r.state.refreshbodycell.renderedDataIdMap[s._index.id]){u=s._index.id,a=s._index.row;break}var f=parseInt(o.pageY),h=d.offset().top-r.$wrapper.offset().top+d.outerHeight()-1,m=e('<div class="resize-align row-resize-align">');It?m.css("top",h+"px"):m.css("transform","translateY("+h+"px)");var v=m.clone();v.addClass("resize-align-reference"),r.$wrapper.append(v,m),r.state.$rowResizeBar=m;var x=parseInt(r.state.rowHeightMapByDataId[u]||r.state.rowHeight),y={self:r,$bar:m,$pos:v,startPageY:f,startTop:h,rowIndex:a,dataId:u,$cell:d,moveDiff:0,prevHeight:x,rowResizeEventNS:l};r._triggerGridEvent("UIRowResizeStart",{row:a,height:x}),xt.off(l+r.key+r.eventns),xt.on("keydown"+l+r.key+r.eventns,y,function(e){var t=e.keyCode;switch(t){case 27:xt.off(e.data.rowResizeEventNS+r.key+r.eventns),e.data.$pos&&(e.data.$pos.remove(),delete e.data.$pos),e.data.$bar&&(e.data.$bar.remove(),delete e.data.$bar)}}),xt.on("mousemove"+l+r.key+r.eventns+" touchmove"+l+r.key+r.eventns,y,K).on("mouseup"+l+r.key+r.eventns+" touchend"+l+r.key+r.eventns+" touchcancel"+l+r.key+r.eventns,y,U)}}},kt.prototype._columnResizeStart=function(t,a){if(t&&t.type){var n=e.event.fix(t);"touchstart"===t.type&&(n=t.touches[0]),t.preventDefault();var r=".alopexgridcolumnresizeevent",o=this,l=e(t.target),i=e(t.target).closest(".headercell"),d=i[0],s=e('<div class="resize-align column-resize-align">'),p=s[0],u=parseInt(d.style.left)+parseInt(d.style.width)+"px",c=(t.target.offsetWidth,o.state.columnIndexToMapping[a]),g={self:o,$bar:s,bar:p,prevX:0,totalMoveAmount:0,columnIndex:a,mapping:c,columnResizeEventNS:r};l.siblings(".resizing-handle").length>0&&(u=i.position().left+l.position().left+l.width()-1+"px"),p.style.top="0px",p.style.left=u,p.style.height=parseInt(1.5*o.state.wrapperHeight)+"px",o.$wrapper[0].appendChild(p),o.state.resizing=!0,g.prevX=parseInt(n.pageX),o._triggerGridEvent("UIColumnResizeStart",{mapping:c,width:parseInt(c.width),fitWidth:o.state.columnFitWidthById[c.id]}),xt.off(r+o.eventns+o.key),xt.on("keydown"+r+o.eventns+o.key,g,function(e){var t=e.keyCode;switch(t){case 27:xt.off(e.data.columnResizeEventNS+o.eventns+o.key),e.data.$bar&&(e.data.$bar.remove(),delete e.data.$bar)}}),xt.on("mousemove"+r+o.eventns+o.key+" touchmove"+r+o.eventns+o.key,g,Y).on("mouseup"+r+o.eventns+o.key+" touchend"+r+o.eventns+o.key+" touchcancel"+r+o.eventns+o.key,g,V)}},kt.prototype._isColumnSorted=function(e){var t=this;if(t.state.sortingInfo&&t.state.sortingInfo.length)for(var a=0,n=t.state.sortingInfo.length;a<n;a++){var r=t.state.columnMappingMapById[t.state.sortingInfo[a].mappingId];if(null!=r&&("number"==typeof e&&r.columnIndex===e||"string"==typeof e&&r.key===e||e&&"object"==typeof e&&e.id===r.id))return t.state.sortingInfo[a]}return!1},kt.prototype.sortToggle=function(e,t){var a=this,n=null;if(a.state.sortingInfo&&a.state.sortingInfo.length)for(var r=0,o=a.state.sortingInfo.length;r<o;r++){var l=a.state.columnMappingMapById[a.state.sortingInfo[r].mappingId];if("number"==typeof e&&l.columnIndex===e||"string"==typeof e&&l.key===e){n=a.state.sortingInfo[r];break}}var i=null;if(!n){var d=a._columnIndexKeyToMappingList(e)[0];if(d){var s={};s.mappingId=d.id,i=s}}var p=n||i;if(p){var u=t?t:"asc"===p.sortingDirection?"desc":"asc",c={},l=a.state.columnMappingMapById[p.mappingId];if(c.sortingKey=l.key,c.sortingColumn=l.columnIndex,c.sortingDirection=u,c.mapping=l,c.pageinfo=a.pageInfo(),c.sortingInfo=a.sortingInfo(),a._triggerGridEvent("sortToggle",c)===!1)return;p.sortingDirection=u,i&&(a.state.sortingInfo=a.state.sortingInfo||[],a.state.sortingInfo.push(i)),a.showProgress(function(){a.calcAndRedraw();var e={},t=a.state.columnMappingMapById[p.mappingId];e.sortingKey=t.key,e.sortingColumn=t.columnIndex,e.sortingDirection=u,e.mapping=t,e.pageinfo=a.pageInfo(),e.sortingInfo=a.sortingInfo(),a._triggerGridEvent("sortToggleEnd",e)})}},kt.prototype._generateSortingInfo=function(t,a){var n=this,r=[];if("number"==typeof t||"string"==typeof t){var o=n._columnIndexKeyToMappingList(t)[0];if(o){var l={};l.mappingId=o.id,l.sortingDirection=a||"asc",r.push(l)}}else if(e.isArray(t))for(var i=0,d=t.length;i<d;i++){var s=t[i].sortingColumn;if(void 0!==s){var o=n._columnIndexKeyToMappingList(s)[0];if(o){var l={};l.mappingId=o.id,l.sortingDirection=t[i].sortingDirection||"asc",r.push(l)}}}return r},kt.prototype._setSortingInfo=function(e,t){var a=this,n=a._generateSortingInfo(e,t);a.state.sortingInfo=n||[]},kt.prototype.dataSort=function(e,t){var a=this;if(s(e))return a.sortClear(),a.state.data.sort(e),void a.calcAndRedraw();a.sortClear();var n=a._generateSortingInfo(e,t);a.state.sortingInfo=n||[],a.calcAndRedraw()},kt.prototype._focusInfo=function(){var e=this,t=e.$focusfixture.prop("renderedIndex"),a=e.$focusfixture.prop("columnIndex"),n=null,r=null;return void 0===t||null===t?t=null:n=e._getRenderedDataFromRenderedIndex(t),void 0===a||null===a?a=null:r=e.state.columnIndexToMapping[a]||null,{row:t,column:a,data:n,mapping:r}},kt.prototype._focusRestore=function(e){var t=this;e&&u(e.row)&&u(e.column)&&(Qe(t,e.row,e.column),Xe(t,e.row,e.column))},kt.prototype.focusInfo=function(){var t=this,a={},n=e(document.activeElement),r=n.closest(t.$root).length?n.closest(".alopexgrid-cell"):null,o=t.$focusfixture.prop("renderedIndex"),l=t.$focusfixture.prop("columnIndex");return a.cellFocus={},t.option.cellSelectable&&null!=o&&null!=l?(a.cellFocus.row=o,a.cellFocus.columnIndex=l,a.cellFocus.data=t._getRenderedDataFromRenderedIndex(o)||null,a.cellFocus.mapping=t.state.columnIndexToMapping[l]||null,a.cellFocus.rowSelectionFrom=t.state.cellSelection.topBoundaryRenderedIndex,a.cellFocus.rowSelectionTo=t.state.cellSelection.bottomBoundaryRenderedIndex,a.cellFocus.columnSelectionFrom=t.state.cellSelection.leftBoundaryColumnIndex,a.cellFocus.columnSelectionTo=t.state.cellSelection.rightBoundaryColumnIndex):a.cellFocus=null,r&&r.length&&kt.regex.inputControls.test(document.activeElement.tagName)?(a.inputFocus={},a.inputFocus.row=parseInt(r.attr("data-alopexgrid-rowindex")),a.inputFocus.columnIndex=parseInt(r.attr("data-alopexgrid-columnindex")),a.inputFocus.data=t._getRenderedDataFromRenderedIndex(a.inputFocus.row)||null,a.inputFocus.mapping=t.state.columnIndexToMapping[a.inputFocus.columnIndex]||null,a.inputFocus.caretPostion=kt.regex.caretAvailableType.test(document.activeElement.type)?j(document.activeElement):null,a.inputFocus.tagName=document.activeElement.tagName,a.inputFocus.tagOrder=r.find(a.inputFocus.tagName).index(n)):a.inputFocus=null,a},kt.prototype.focusRestore=function(e){var t=this;if(e&&(e.cellFocus&&(null==e.cellFocus.rowSelectionFrom||null==e.cellFocus.columnSelectionFrom||null==e.cellFocus.rowSelectionTo||null==e.cellFocus.columnSelectionTo||t.option.disableCellSelectionRestore||e.disableCellSelectionRestore?Ne(t,e.cellFocus.row,e.cellFocus.columnIndex,e.cellFocus.row,e.cellFocus.columnIndex):Ne(t,e.cellFocus.rowSelectionFrom,e.cellFocus.columnSelectionFrom,e.cellFocus.rowSelectionTo,e.cellFocus.columnSelectionTo,e.cellFocus.row,e.cellFocus.columnIndex),Xe(t,e.cellFocus.row,e.cellFocus.columnIndex)),e.inputFocus)){var a=t.cellElementGet({_index:{row:e.inputFocus.row}},e.inputFocus.columnIndex),n=a.find(e.inputFocus.tagName).eq(e.inputFocus.tagOrder).focus().get(0);if(n&&null!=e.inputFocus.caretPostion&&kt.regex.caretAvailableType.test(n.type)){var r;e.inputFocus.caretPostion;z(n,e.inputFocus.caretPostion,null!=r?r:null)}}},kt.prototype.focusCell=function(e,t,a){var n=this,r=n.cellElementGet(e,t);if(!r||!r.length){var o=n._dataGet(e)[0],e={_index:{row:o._index.row}},l=t;if("string"==typeof l){var i=n._getColumnByKey(l);i&&(l=i.columnIndex)}(l<n.state.renderFromColumnIndex||l>n.state.renderToColumnIndex)&&(e._index.column=l),n.dataScroll(e),r=n.cellElementGet(e,t)}return r&&r.length&&(r.eq(0).mousedown().mouseup(),s(a)?a.call(n.$root,r):null),r},kt.prototype._getContentFitRowHeight=function(t){var a=this,n=a._dataGetByIndex(t&&t._index?t._index:{row:t});if(!n)return null;for(var r=a.state.rowHeight,o=0,l=a.state.visibleColumnMappingList.length;o<l;o++){var i=a.state.visibleColumnMappingList[o],d=a.state.columnFitWidthById[i.id]||parseInt(i.width),s=a.state.rowHeight;if(i.colspan||i.colspanTo){var p=a._getColspanUpto(n,i);if(p>=i.columnIndex)for(var u=i.columnIndex+1;u<=p;u++){var c=a.state.columnIndexToMapping[u];c&&xe(c)&&(d+=a.state.columnFitWidthById[c.id]||0)}}var g=a._createCell(n,i),f=e(g);g.style.overflow="visible",g.style.height="auto",g.style.width=d+"px",g.style.left=2*-d+"px",g.style.top=2*-s+"px",a.$wrapper[0].appendChild(g);var h=g.scrollHeight;if(h&&!isNaN(Number(h))&&(r=Math.max(r,h)),i.multi&&g.children&&g.children.length){for(var m=0,v=0,x=0,y=g.children.length;x<y;x++){var C=g.children[x];"DIV"===C.tagName&&kt.renderUtil.hasClass(C,"multicell")&&(C.style.height="auto",v++,m=Math.max(m,e(C).outerHeight()||0))}r=Math.max(r,m*v+(f.outerHeight()-f.height()||0))}f.remove()}return r||null},kt.prototype._getRowHeight=function(e){var t=this;return(e?t.state.rowHeightMapByDataId[e._index.id]:null)||t.state.rowHeight},kt.prototype._setRowHeight=function(e,t){var a=this;if("content"===t&&a.$wrapper.is(":visible")&&(t=a._getContentFitRowHeight(e)),null!=t&&t>0){var n=a._dataGetByIndex(e&&e._index?e._index:{row:e});a.state.rowHeightMapByDataId[n._index.id]=parseInt(t)}},kt.prototype.setRowHeight=function(t,a){if(null!=a||!e.isNumeric(t)&&"content"!==t||(a=t,t={}),null!=a){var n=this,r=n._dataGet(t);if(r&&r.length){for(var o=0,l=r.length;o<l;o++){var i=r[o];n._setRowHeight(i,a)}n.redraw()}}};var Ht={cache:{cache:!0},force:{force:!0}};kt.prototype.cellElementGet=function(t,a,n){var r=this;if(arguments.length&&arguments[arguments.length-1]===!0&&(n=Ht.force),!It&&!n&&!r.state.bodyCellList.length)return e();if(!arguments.length)return e(p(r.state.bodyCellList));for(var o=r._dataGet(t),l=r._columnIndexKeyToMappingList(a),i=[],d=0,s=o.length;d<s;d++){var u=o[d];if(!r.state.refreshbodycell||!r.state.refreshbodycell.renderedDataIdMap||r.state.refreshbodycell.renderedDataIdMap[u._index.id])for(var c={},g=0,f=l.length;g<f;g++){var h=l[g],m=r._getMultiParentColumnIndex(h);if(!c[m]){c[m]=!0;var v=r._cellElementGet(u,h);if(v?i.push(v):n&&(n.cache===!0&&r.state.cellCacheEnabled&&(v=r._getCachedCell(u,h)),v||n.force!==!0||(v=r._createCell(u,h)),v&&i.push(v)),r.state.groupRowspanned&&h.rowspan){var x=!1;if(h.rowspan===!0&&r.state.groupingKeyMap.hasOwnProperty(h.key)?x=!0:"object"==typeof h.rowspan&&"string"==typeof h.rowspan.by&&r.state.groupingKeyMap.hasOwnProperty(h.rowspan.by)&&(x=!0),x){var y=r._getGroupingRangeByMapping(u._index.data,h);if(y)for(var C=y.from;C<=y.to;C++)C!==u._index.data&&(v=r._cellElementGet(r.state.data[C],h),v&&i.push(v))}}}}}return e(i)},kt.prototype._cellElementGet=function(e,t){var a=this;return t=a._getMultiParentMapping(t),document.getElementById(a._cellIdFromRowIndex(e._index.row,t.columnIndex))||null},kt.prototype.rowElementGet=function(e,t){return this.cellElementGet(e,null,t)},kt.prototype.refreshRow=function(e,t){var a=this,n=a._dataGet(e);if(n&&n.length)for(var r=0,o=n.length;r<o;r++){var l=n[r];l&&a.refreshCell(l)}},kt.prototype.refreshCell=function(t,a){for(var n=this,r=n._dataGet(t),o=n._columnIndexKeyToMappingList(a),l=[],i=0,d=r.length;i<d;i++)for(var s=r[i],p=0,u=o.length;p<u;p++){
var c=o[p],g=n._refreshCell(s,c);g&&l.push(g)}return n._refreshBoard(),e(l)},kt.prototype._refreshCell=function(e,t){if(!e||!t)return!1;t=this._getMultiParentMapping(t);var a=document.getElementById(this._cellIdFromRowIndex(e._index.row,t.columnIndex));if(!a&&this.state.cellCacheEnabled&&(a=this._getCachedCell(e,t)),a){var n=kt.renderUtil.hasClass(a,"prevrow-selected"),r=kt.renderUtil.hasClass(a,"nextrow-selected");if(this._createCell(e,t,a),kt.renderUtil[n?"addClass":"removeClass"](a,"prevrow-selected"),kt.renderUtil[r?"addClass":"removeClass"](a,"nextrow-selected"),s(window.getSelection)){var o=window.getSelection();o.containsNode&&o.containsNode(a,!0)&&i()}return a}return null},kt.prototype._setCursorUnderPointer=function(t,a,n){if(i(),t&&(null==a||null==n))return void t.find("input,select,textarea").focus();try{var r=t.find("input,select,textarea");if(r.length){var o=Number.POSITIVE_INFINITY,l=r.get(0);r.each(function(t,r){var i=e(r),d=Z(i,a,n);d<=o&&(l=i,o=d)}),r=l;var d=r.prop("tagName");if("SELECT"===d)r.focus();else{var s=null,p=0,u=-1,c=-1;do{if(s=X(r[0],p),s.left>a){Math.abs(u-1-a)<=Math.abs(s.left-1-a)&&(p-=1);break}if(u===s.left&&c===s.top)break;u=s.left,c=s.top,p++}while(s);z(r[0],p)}}}catch(e){var g=t.find("input,select,textarea");"radio"===g.prop("type")?g.filter(":checked").focus():g.focus()}},kt.prototype._triggerGridEvent=function(t,a,n){var r=this;if(r.$root){var o=null;try{o=new Event(t,{bubbles:!0,cancelable:!0})}catch(a){It?o=e.Event(t):(o=document.createEvent("Event"),o.initEvent(t,!0,!0))}if(o.alopexgrid={},o.alopexgrid.$grid=r.$root,a&&"object"==typeof a)for(var l in a)a.hasOwnProperty(l)&&(o.alopexgrid[l]=a[l]);var i=r.$root;if(n){var d=e(n);n.nodeType?(i=d,o.alopexgrid.$cell=d.closest(".alopexgrid-cell")):n.jquery&&n.length&&(i=n.eq(0),o.alopexgrid.$cell=d.closest(".alopexgrid-cell"))}return o.alopexgrid.$cell&&!o.alopexgrid.$cell.length?delete o.alopexgrid.$cell:o.alopexgrid.$cell&&o.alopexgrid.$cell.length&&(o.alopexgrid.cell=o.alopexgrid.$cell[0]),i?i.nodeType&&(i=e(i)):i=r.$root,r.root===i[0]||e.contains(r.root,i[0])||(i=r.$root),It?i.trigger(o):i[0].dispatchEvent(o)}},kt.prototype._viewEventRemove=function(){var e=this,t=".alopexgridViewEventUpdate";xt.off(t+e.key),vt.off(t+e.key),e.$root.off(t),e.$title.off(t),e.$pager.off(t),e.$wrapper.off(t),e.$focusfixture.off(t),e.$pager.off(t)},kt.prototype.viewEventUpdate=function(t){function a(t){var a=t.data.self,n=parseInt(t.currentTarget.getAttribute("data-alopexgrid-dataindex")),r=parseInt(t.currentTarget.getAttribute("data-alopexgrid-columnindex")),o=Q(a,r),l=e.extend(!0,{},a.option.getEditingDataOnEvent?a._getRecentData(n):a.state.data[n]);return o&&o.key&&(l._key=o.key),o&&o.hasOwnProperty("columnIndex")&&(l._column=o.columnIndex),!isNaN(r)&&r>=0&&l&&l._index&&(l._index.column=r),l}function n(e){var t=e.data.self,n=a(e),r=e.data.handle,o="function"==typeof r?[r]:r;for(var l in o){var i=o[l];i.call(t,n,e)}}function r(e){if(e.state.rowInlineEditPool.length)for(var t=e.state.rowInlineEditPool.length-1;t>=0;t--){var a=e.state.rowInlineEditPool[t],n=e._dataGetByIndex({id:a});n&&n._state.editing&&"click"!==A||(!n||n&&!n._state.editing||n&&n._state.editing&&e.endEdit(n)!==!1)&&e.state.rowInlineEditPool.splice(t,1)}}function l(e,t){if(!t||!t._index||!t._index.id)return!1;for(var a=0,n=e.state.rowInlineEditPool.length;a<n;a++){var r=e.state.rowInlineEditPool[a];if(t._index.id===r)return!0}return!1}function p(e){return!(!e.state.lastInvalidEditingCell||!e.state.lastInvalidEditingCell[0])&&!!l(e,e.state.lastInvalidEditingCell[0])}function u(e){var t=e.state.lastInvalidEditingCell[0],a=e.state.lastInvalidEditingCell[1];if(t&&a){e.dataScroll({_index:{row:t._index.row,column:a.columnIndex}});var n=e.cellElementGet(t,a.columnIndex);n.find("input,select,textarea").eq(-1).focus()}}function c(e,t){if(!t||!t._index||!t._index.id)return!1;if(r(e),e.state.rowInlineEditPool.length)return void(e.option.restoreFocusOnInvalidInlineEdit===!0&&p(e)&&setTimeout(function(){u(e)},10));if(!l(e,t)){if(e.startEdit(t)===!1)return!1;e.state.rowInlineEditPool.push(t._index.id),i();var a=e.option.rowInlineEditOption.disableEvent;a||e._triggerGridEvent("rowInlineEditStart",{data:t})}}function g(e){var t=[],a=e.option.rowInlineEditOption.endAllEditing;if(a)t=e._dataGet({_state:{editing:!0}}),e.endEdit(t);else for(var n=0,o=e.state.rowInlineEditPool.length;n<o;n++){var l=e.state.rowInlineEditPool[n],d=e._dataGetByIndex({id:l});if(d&&d._state.editing){if(e.endEdit(d)===!1)return r(e),!1;d._state.editing||t.push(d)}}r(e),i();var s=e.option.rowInlineEditOption.disableEvent;if(!s)for(var n=0,o=t.length;n<o;n++)e._triggerGridEvent("rowInlineEditEnd",{data:t[n]})}function f(e,t){return e.state.renderTargetDataList[t.getAttribute("data-alopexgrid-rowindex")]}function h(e,t){return e.state.columnIndexToMapping[t.getAttribute("data-alopexgrid-columnindex")]}function m(e,t,a){if(!a.editable)return null;if("function"==typeof a.editable){var n=t._state.editing&&t._state.editing.hasOwnProperty(a.columnIndex)?t._state.editing[a.columnIndex]:t[a.key],r=a.editable.call(e,n,t,a.editable,a,e);if(r&&"object"==typeof r)return r.type||null}else if(a.editable===!0)return"text";return a.editable.type||null}function v(e,t,a){for(var n=0,r=a.length;n<r;n++)if(a[n][0]._index.id===e._index.id&&a[n][1].columnIndex===t.columnIndex)return!0;return!1}function x(e,t){for(var a=[],n=!1,r=!1,o=e.option.grouping&&e.option.grouping.useGrouping&&e.option.grouping.by&&e.option.grouping.by.length,l=!1,i=t.length-1;i>=0;i--){var d=t[i],s=d[0],p=d[1],u=s[p.key];if(e._isEditingCell(s._index.row,p.columnIndex)){if(e._endCellEdit(s,p)===!1){l=!0;continue}var c=s[p.key];if(a.push(d),e.state.sortingInfoKeyMap[p.key]&&u!==c&&(r=!0),o&&!n&&u!==c){var g=e._getGroupingRangeByMapping(s._index.data,p);g&&(n=!0)}}t.splice(i,1)}if(a.length){if(e.option.sortClearOnEdit&&r&&e.sortClear(),n||!e.option.sortClearOnEdit&&r)e.calcAndRedraw();else{for(var i=0,f=a.length;i<f;i++)e.refreshRow(a[i]);e._hasFooter()&&e._refreshFooterCells(!0)}for(var i=0,f=a.length;i<f;i++)e._triggerGridEvent("cellInlineEditEnd",{data:a[i][0],mapping:a[i][1]})}if(l===!0)return!1}function y(e,t,a,n){if(e._isPopupEditingColumn(a))return!1;if(e._startCellEdit(t,a),!e._isEditingCell(t,a))return!1;if(e._refreshCell(t,a),n.push([t,a]),e._triggerGridEvent("cellInlineEditStart",{data:t,mapping:a}),e.state.groupRowspanned&&e.option.rowspanGroupEdit&&a.rowspan){var r=e._getGroupingRangeByMapping(t._index.data,a);if(r)for(var o=r.from;o<=r.to;o++)o!==t._index.data&&(e._startCellEdit(e.state.data[o],a),e._refreshCell(e.state.data[o],a),n.push([e.state.data[o],a]),e._triggerGridEvent("cellInlineEditStart",{data:e.state.data[o],mapping:a}))}return!0}function C(t,a){var n=a[a.length-1];if(n){var r=n[0],o=n[1];t.option.cellSelectable&&je(t,r._index.row,o.columnIndex);var l=t._cellElementGet(r,o);setTimeout(function(){e(l).find("input,select,textarea").focus()},0)}}function I(t,a,n,r){var o=!1;if(n.instantInlineEditable){if(n.instantInlineEditable===!0)return!0;if("function"==typeof n.instantInlineEditable)return n.instantInlineEditable.call(t,a[n.key],a,n,t)}if(t.option.instantInlineEditType&&t.option.instantInlineEditType.length)for(var l=m(t,a,n),i=0,d=t.option.instantInlineEditType.length;i<d;i++){var s=t.option.instantInlineEditType[i],p=e.type(s);if("string"===p?(s=e.extend({},t.option.defaultInstantInlineEdit,{type:s}),p="object"):"object"===p&&(s=e.extend({},t.option.defaultInstantInlineEdit,s)),"object"===p&&!e.isEmptyObject(s)){if(s.type&&l!==s.type)continue;if(s.hasOwnProperty("columnIndex")){if("number"==typeof s.columnIndex&&n.columnIndex!==s.columnIndex)continue;if("string"==typeof s.columnIndex&&n.key!==s.columnIndex)continue}o=!0;break}if("function"===p&&s.call(t,a[n.key],a,n,r)===!0){o=!0;break}}return o}function _(e,t,a,n,r,o){if(!v(a,n,t)){var l=e._isEditingCell(a._index.row,n.columnIndex);if(!l){var i=x(e,t);if(i===!1&&e.option.restoreFocusOnInvalidInlineEdit===!0)return void C(e,t);var d=I(e,a,n,o);d&&setTimeout(function(){var o=e.option.cellInlineEditOption.allowStartEditWithInvalid;i===!1&&o!==!0||y(e,a,n,t),s(r)&&r()},1)}}}function w(t,a,n){var r=a.target.className;if(!(r.indexOf("scrollbar")>=0||r.indexOf("scrollbutton")>=0||r.indexOf("scrollhandle")>=0||r.indexOf("resizing-handle")>=0||r.indexOf("row-dragdrop-handle")>=0||r.indexOf("header-columnfolding-icon")>=0)){xt.off(n+t.key),i();var l=!1;"mousedown"===t.option.contextMenuEvent&&(l=!0);var d=a;Ct&&(d=a.originalEvent.touches[0]);var s=[];if(t.option.enableDefaultContextMenu&&t.option.defaultContextMenu&&t.option.defaultContextMenu.length&&(s=s.concat(t.option.defaultContextMenu)),t.option.enableContextMenu&&t.option.contextMenu&&t.option.contextMenu.length&&(s=s.concat(t.option.contextMenu)),s.length){var p=t._getDataFromEvent(a),u=t._getCellFromEvent(a);p&&(p=e.extend(!0,{},p),p._index.column=parseInt(u.attr("data-alopexgrid-columnindex")));var c=d.pageX,g=d.pageY;e(".alopexgrid-contextmenu-wrapper-"+t.key).remove(),t.state.$contextMenuDropdown&&(t.state.$contextMenuDropdown.remove(),t.state.$contextMenuDropdown=null);var f=e("<div>"),h=o();f.css({left:c+"px",top:g+"px"}),f.prop("id",h),f.addClass(pt+" alopexgrid-contextmenu-wrapper alopexgrid-contextmenu-wrapper-"+t.key);var m=t.state.$contextMenuDropdown=e("<ul>");m.addClass("alopexgrid-contextmenu");for(var v=0;v<s.length;v++){var x=s[v];m.append(b(t,x,v,p,u,n))}if(!m.children().length)return m.remove(),void f.remove();var y=vt.scrollLeft()+vt.width(),C=vt.scrollTop()+vt.height();m.appendTo(f),f.appendTo("body").addClass("alopexgrid-refer-"+t.key),m.show();var I=f.outerHeight(),_=f.outerWidth(),w=f.offset(),M=!1;if(w.top+I>C&&(f.css("top",g-I+"px"),M=!0),w.left+_>y&&(f.css("left",c-_+"px"),M=!0),M){var S=f.outerHeight();S!=I&&f.css("top",g-S+"px");var E=f.outerWidth();E!=_&&f.css("left",c-E+"px")}D.mousedownEvent=l,yt===!1&&xt.on("keydown"+n+t.key+t.eventns,D,function(e){var t=e.data.self;27===e.keyCode&&(t.state.$contextMenuDropdown&&(t.state.$contextMenuDropdown.parents(".alopexgrid-contextmenu-wrapper").remove(),t.state.$contextMenuDropdown.remove(),t.state.$contextMenuDropdown=null),xt.off(e.data.contextMenuEventNS+t.key),Xe(t))}),xt.on("mousedown"+n+t.key+t.eventns+" touchstart"+n+t.key+t.eventns+" scroll"+n+t.key+t.eventns+" wheel"+n+t.key+t.eventns,D,function(a){if(!(e(a.target).closest(".alopexgrid-contextmenu-wrapper").length>0||yt&&"mousedown"===a.type)){if(a.data.mousedownEvent)return void(a.data.mousedownEvent=!1);a.data.self&&a.data.self.state&&a.data.self.state.$contextMenuDropdown&&(a.data.self.state.$contextMenuDropdown.parents(".alopexgrid-contextmenu-wrapper").remove(),a.data.self.state.$contextMenuDropdown.remove(),a.data.self.state.$contextMenuDropdown=null),xt.off(a.data.contextMenuEventNS+t.key)}}),a.preventDefault()}}}function b(t,a,n,r,o,l){if(a.use===!1)return"";if(s(a.use)&&a.use.call(t.$root,r,o,t)===!1)return"";if(a.seperator===!0)return"<li><hr></li>";var i=e("<li>"),d=e("<a>").appendTo(i),p=a.title;s(p)&&(p=p.call(t.$root,r,o,t)),p&&(p.nodeType||p instanceof e)?d.html(p):d.text(t.option.contextMenuTitleMapper?t.option.contextMenuTitleMapper(p):p);var u={};return u.$grid=t.$root,u.gridInstance=t,u.contextMenuEventNS=l,d.attr("href","#"),d.on("click touchstart",u,function(e){var t=e.data.gridInstance;a.processor?a.processor.call(e.data.$grid,r,o,t):0,t.state.$contextMenuDropdown&&(t.state.$contextMenuDropdown.parents(".alopexgrid-contextmenu-wrapper").remove(),t.state.$contextMenuDropdown.remove(),t.state.$contextMenuDropdown=null),xt.off(e.data.contextMenuEventNS+t.key),e.preventDefault()}),i}var M=this,S=(M.$root,M.$wrapper),E=M.option,T=".alopexgridViewEventUpdate",D={self:M,targetElement:null};M._viewEventRemove();var R=[{target:"cell",delegate:".bodycell"},{target:"headercell",delegate:".headercell"}];if(e.each(R,function(t,a){E.on&&E.on[a.target]&&e.each(E.on[a.target],function(e,t){S.on((M.option.eventMapping[e]||e)+T,a.delegate,{self:M,handle:t},n)})}),M.option.on&&M.option.on.focus&&"object"==typeof M.option.on.focus)for(var F in M.option.on.focus)"string"==typeof F&&M.$focusfixture.on(F+T,{self:M,handle:M.option.on.focus[F]},n);if(S.on("click"+T,".alopexgrid-input-wrapper",D,function(t){if("LABEL"===t.target.tagName){var a=e(t.target).find("input");return a.prop("disabled")||a.prop("readOnly")||(0==!!t.data.self.option.disableRowSelectByKey&&(t.data.self.state.customCtrlKey=t.ctrlKey||t.metaKey,t.data.self.state.customShiftKey=t.shiftKey),a.click().change()),!1}}),S.on("change"+T,".alopexgrid-input-wrapper",D,function(t){var a=e(this),n=a.children("input");a.siblings(".alopexgrid-input-wrapper").removeClass("checked");var r=n[0].checked,o=n[0].alopexgridChecked;"boolean"==typeof o&&r!==o&&(r=o),r?a.addClass("checked"):a.removeClass("checked")}),S.on("change"+T+" click"+T+" keyup"+T,".alopexgrid-cell.editingcell",D,function(e){e.data.self._updateEditingCell(this)}),M.option.disableHeaderClickSorting!==!0){var k="click",L="mousedown";yt&&(k="touchstart",L="touchstart"),S.on(L+T,".headercell.click-sortable",D,function(e){e.data.targetElement=e.target}),S.on(k+T,".headercell.click-sortable",D,function(e){var t=e.data.self,a=e.target.className;if(e.data.targetElement===e.target&&!(a.indexOf("header-dragdrop-handle")>=0||a.indexOf("column-resizing-handle")>=0||a.indexOf("alopexgrid-treecolumn")>=0||a.indexOf("alopexgrid-nonsorting-handle")>=0)&&(kt.renderUtil.hasClass(e.target,"sorting-handle")||!kt.renderUtil.isGridPointerActionProhibited(e.target))){var n=parseInt(this.getAttribute("data-alopexgrid-columnindex"));if(!isNaN(n)){var r=t._isColumnSorted(n),o=null;"touchstart"===e.originalEvent.type?e.originalEvent.touches&&e.originalEvent.touches.length<2&&t.sortClear():e.shiftKey||t.sortClear(),r&&("asc"===r.sortingDirection?o="desc":"desc"===r.sortingDirection&&(o="asc")),t.sortToggle(n,o);var l=t.state.columnIndexToMapping[n];t._triggerGridEvent("UISortToggle",{sortingKey:l.key,sortingColumn:n,sortingDirection:o,mapping:l,pageInfo:t.state.pagingInfo})}}})}var A=M.option.rowInlineEditOption.startEvent||"dblclick";if(E.rowInlineEdit){M.state.rowInlineEditPool=M.state.rowInlineEditPool||[],S.on(A+T,D,function(t){var a=t.data.self,n=kt.parseEvent(t),o=n.data,d=n.mapping;if(o&&"INPUT"!==t.target.tagName&&"SELECT"!==t.target.tagName&&"TEXTAREA"!==t.target.tagName&&!kt.renderUtil.hasClass(t.target,"alopexgrid-input-wrapper")){var s=l(a,o),f=a.option.rowInlineEditOption.endAllEditing;if(s){var h=g(a)===!1;h&&a.option.restoreFocusOnInvalidInlineEdit===!0&&p(a)&&setTimeout(function(){u(a)},10)}else if(f&&o._state&&o._state.editing){var h=a.endEdit(o)===!1;r(a),i();var m=a.option.rowInlineEditOption.disableEvent;m||a._triggerGridEvent("rowInlineEditEnd",{data:o}),h&&a.option.restoreFocusOnInvalidInlineEdit===!0&&p(a)&&setTimeout(function(){u(a)},10)}else{if(o._state&&o._state.editing)return;if(f){var v=a._dataGet({_state:{editing:!0}});a.endEdit(v);for(var x=0,y=v.length;x<y;x++)a._triggerGridEvent("rowInlineEditEnd",{data:v[x]})}if(c(a,o),o._index&&o._index.id){var C=a._cellElementGet(o,d);if(C){var I=t.pageX,_=t.pageY;setTimeout(function(){var t=e(C);a._setCursorUnderPointer(t,I,_),a._triggerGridEvent("inlineEditInputFocus",{data:o,mapping:d},t)},0)}}}}}),S.on("mousedown"+T,D,function(e){e.data.rowInlineClickTarget=e.target}),S.on("click"+T,D,function(t){var a=t.data.self,n=t.data.rowInlineClickTarget||t.target;if(!e.data(n,"alopexGridScrollbarElement")){var r=kt.parseEvent(t),o=r.data,i=l(a,o),d=!1,s=a.option.rowInlineEditOption.endAllEditing;if(s)o&&o._state&&o._state.editing||(d=g(a)===!1);else if(o&&i)!o||o._index&&o._state||(d=g(a)===!1);else if(o&&o._state&&o._state.editing){if(kt.regex.inputControls.test(t.target.tagName))return;d=g(a)===!1}else d=g(a)===!1;d&&a.option.restoreFocusOnInvalidInlineEdit===!0&&p(a)&&setTimeout(function(){u(a)},10)}});var O=M.option.rowInlineEditOption.endEditByEnter;O&&M.$wrapper.on("keydown"+T,".bodycell",D,function(t){var a=t.data.self,n=e(this),r=parseInt(n.attr("data-alopexgrid-rowindex")),o=parseInt(n.attr("data-alopexgrid-columnindex")),l=a._isEditingCell(r,o);if("TEXTAREA"!==t.target.tagName&&l)if(13===t.which){var i=g(a)===!1;!i&&a.option.cellSelectable?Xe(a):i&&setTimeout(function(){u(a)},10)}else 27===t.which}),M.state.__rowInlineStartEdit=c,M.state.__rowInlineEndEdit=g}else M.state.__rowInlineStartEdit=null,M.state.__rowInlineEndEdit=null;if(E.rowClickSelect){var P="click";M.$root.on(P+T,".bodycell",D,function(t){var a=t.data.self;e(t.target);if(!kt.renderUtil.isGridPointerActionProhibited(t.target)){var n=!1;if(("INPUT"!==t.target.tagName||(n=kt.renderUtil.hasClass(t.target,"selector-column-input")))&&"SELECT"!==t.target.tagName&&"TEXTAREA"!==t.target.tagName){var r=parseInt(this.getAttribute("data-alopexgrid-columnindex")),o=parseInt(this.getAttribute("data-alopexgrid-rowindex")),l=a._getRenderedDataFromRenderedIndex(o),i=Q(a,r);if(l&&i){var d=l._state.selected;if(!a.state.rowSingleSelect||a.option.rowSingleSelectAllowUnselect!==!1||!d){var s=this;if(s.rowSingleCtrlKey=a.state.customCtrlKey||t.ctrlKey||t.metaKey,s.rowSingleShiftKey=a.state.customShiftKey||t.shiftKey,a.rowSelect(s,"toggle")===!1)return!1;if(a.state.hasSelectorColumn&&d!==l._state.selected){var p={data:l,mapping:i,value:l._state.selected,prevValue:d};a._triggerGridEvent("cellValueEditing",p),a._triggerGridEvent("cellValueChanged",p)}}}}}})}else M.$root.on("click"+T,".selector-column-input",D,function(t){var a=t.data.self,n=e(this).closest(".bodycell");if(n.length){e(t.target);if(!kt.renderUtil.isGridPointerActionProhibited(t.target)){var r=parseInt(n.attr("data-alopexgrid-columnindex")),o=parseInt(n.attr("data-alopexgrid-rowindex")),l=a._getRenderedDataFromRenderedIndex(o),i=Q(a,r);if(l&&i){var d=l._state.selected;if(!a.state.rowSingleSelect||a.option.rowSingleSelectAllowUnselect!==!1||!d){if(n[0].rowSingleCtrlKey=a.state.customCtrlKey,n[0].rowSingleShiftKey=a.state.customShiftKey,a.rowSelect(n[0],"toggle")===!1)return!1;if(a.state.hasSelectorColumn&&d!==l._state.selected){var s={data:l,mapping:i,value:l._state.selected,prevValue:d};a._triggerGridEvent("cellValueEditing",s,n),a._triggerGridEvent("cellValueChanged",s,n)}}}}}});if(M.option.disableFocusedState!==!0&&M.$root.on("mousedown"+T,".bodycell",D,function(e){e.data.self._rowFocus(this)}),M.option.cellPopupEdit&&M.option.cellPopupEdit.length>0){var B=M.option.cellPopupEditOption.startEvent||"dblclick";B=kt.trimString(B)+" ";var G=B.split(" ");B=kt.trimString(G.join(T+" ")),M.$root.on(B,".bodycell",D,function(t){i();var a=t.data.self,n=e(this);if(!n.hasClass("editingcell")&&a.option.rowInlineEdit!==!0&&a.option.cellInlineEdit===!0){var r=".alopexgridCellPopupEdit",o=parseInt(n.attr("data-alopexgrid-rowindex")),l=parseInt(n.attr("data-alopexgrid-columnindex")),s=a._getRenderedDataFromRenderedIndex(o),p=Q(a,l),u=!!a.state.hasRowAllowEdit,c=_e(a,s,p);if((null!=p.editable&&p.editable!==!1||c!==!1)&&!(u&&a.option.rowOption.allowEdit.call(a,s)===!1||null!=p.allowEdit&&p.allowEdit.call(a,s[p.key],s,p)===!1)){var g=a._columnIndexKeyToIndexArray(a.option.cellPopupEdit,null,!0);if(e.inArray(l,g)!==-1){var f=!1;"mousedown"===a.option.cellPopupEditOption.startEvent&&(f=!0);var h="cellpopupedit-focused";xt.off(r+a.key),null!=a.state.activePopupTextarea&&(a.state.activePopupTextarea.remove(),delete a.state.activePopupTextarea,null!=a.state.activePopupCell&&a.state.activePopupCell.removeClass(h)),n.addClass(h),a.state.activePopupCell=n;var m=document.createElement("div");m.tabIndex=0,m.className=pt+" alopexgrid-celledit-popupwrap alopexgrid-popupwrap";var v=e(m),x=e(t.target),y=x.offset(),C=y.top+t.offsetY,I=y.left+t.offsetX+10;v.css({left:I+"px",top:C+"px"});var _={};_.self=a,_.$cell=n,_.cellEditFocusCls=h,_.cellPopupEditEventNS=r,_.mousedownEvent=f;var w;if(!c){var b=document.createElement("button");b.className="alopexgrid-celledit-popupbutton alopexgrid-popupbutton save",b.innerText=kt.i18n("save"),w=e(b),w.on("click"+r+a.key+a.eventns+" touchstart"+r+a.key+a.eventns,_,function(e){var t=e.data.self;t.cellEdit(E.val(),{_index:{row:o}},l),xt.off(e.data.cellPopupEditEventNS+t.key),null!=t.state.activePopupTextarea&&(t.state.activePopupTextarea.remove(),delete t.state.activePopupTextarea,e.data.$cell.removeClass(e.data.cellEditFocusCls)),t.option.cellSelectable===!0&&Xe(t)})}var M=document.createElement("button");M.className="alopexgrid-celledit-popupbutton alopexgrid-popupbutton close",M.innerText=kt.i18n("close"),$cancelButton=e(M),$cancelButton.on("click"+r+a.key+a.eventns+" touchstart"+r+a.key+a.eventns,_,function(e){var t=e.data.self;xt.off(e.data.cellPopupEditEventNS+t.key),null!=t.state.activePopupTextarea&&(t.state.activePopupTextarea.remove(),delete t.state.activePopupTextarea,e.data.$cell.removeClass(e.data.cellEditFocusCls)),t.option.cellSelectable===!0&&Xe(t)});var S=document.createElement("textarea");S.className="alopexgrid-celledit-popuptextarea alopexgrid-popuptextarea",S.innerText=x.text(),c&&(S.setAttribute("readonly",""),S.className+=" disabled");var E=e(S),T=document.createElement("div");T.className="alopexgrid-popupbuttonarea";var D=e(T);D.append(w,$cancelButton),v.append(D,E),a.state.activePopupTextarea=v,e(document.body).append(v);var R=e.extend({},a.option.cellPopupEditOption,p.cellPopupEditOption);R.movable===!0&&D.addClass("movable");var F=120,k=100;null!=R.minWidth&&(F=Math.max(F,R.minWidth)),null!=R.minHeight&&(k=Math.max(k,R.minHeight)),v.css({"min-width":F+"px","min-height":k+"px"});var L=350,A=300;null!=R.width?v.css({width:Math.max(F,R.width)+"px"}):v.css({width:Math.max(F,L)+"px"}),null!=R.width?v.css({height:Math.max(k,R.height)+"px"}):v.css({height:Math.max(k,A)+"px"});var O=parseInt(v.css("padding-top"))+parseInt(v.css("padding-bottom")),P=v.outerHeight()-D.outerHeight()-O-5;E.css({height:P+"px"});var B=Number(v.css("left").split("px")[0]),G=Number(v.css("top").split("px")[0]),H=v.width()+Number(v.css("margin-left").split("px")[0])+Number(v.css("margin-right").split("px")[0]),N=v.height()+Number(v.css("margin-top").split("px")[0])+Number(v.css("margin-bottom").split("px")[0]),$=v.offset().left-vt.scrollLeft()+H,W=vt.width();$>W&&(B-=$-W+10,B<0&&(B=0));var K=v.offset().top-vt.scrollTop()+N,U=vt.height();K>U&&(G-=K-U+10,G<0&&(G=0)),v.css({left:B+"px",top:G+"px"});var Y=document.createElement("div");Y.className="box-resizing-handle",Y.style.right="0px",Y.style.bottom="0px",v.append(Y);var V=document.createElement("div");V.className="box-resizing-align",V.style.display="none",v.append(V);var X={};X.self=a,X.mapping=p,X.bar=V,X.$popupWrap=v,X.$popupTextarea=E,X.$popupButtonArea=D,X.mergedCellpopupEditOption=R,v.on("mousedown touchstart",".box-resizing-handle",X,function(e){var t=e;"touchstart"===e.type&&(t=e.originalEvent.touches[0]);var a=e.data.self;e.data.bar.style.display="block",e.data.bar.style.height=(e.data.startHeight=v.outerHeight())+"px",e.data.bar.style.width=(e.data.startWidth=v.outerWidth())+"px",e.data.startPageX=t.pageX,e.data.startPageY=t.pageY,e.data.diffx=0,e.data.diffy=0,e.data.minWidth=e.data.mergedCellpopupEditOption.minWidth,e.data.minHeight=e.data.mergedCellpopupEditOption.minHeight;var n=".alopexgridCellPopupEditResize"+a.key+a.eventns;e.data.cellPopupEditResizeEventNS=n,xt.off(n),xt.on("selectstart"+n,function(e){e.preventDefault()}),xt.on("mousemove"+n+" touchmove"+n,e.data,function(e){e.preventDefault();var t=e;"touchmove"===e.type&&(t=e.originalEvent.touches[0]),e.data.diffx=t.pageX-e.data.startPageX,e.data.diffy=t.pageY-e.data.startPageY,e.data.bar.style.width=Math.max(e.data.minWidth,e.data.startWidth+e.data.diffx)+"px",e.data.bar.style.height=Math.max(e.data.minHeight,e.data.startHeight+e.data.diffy)+"px"}),xt.on("mouseup"+n+" touchend"+n+" touchcancel"+n,e.data,function(e){e.data.self;xt.off(e.data.cellPopupEditResizeEventNS),e.data.bar.style.display="none";var t=Math.max(e.data.minWidth,e.data.startWidth+e.data.diffx),a=Math.max(e.data.minHeight,e.data.startHeight+e.data.diffy);e.data.$popupWrap.css({width:t,height:a});var n=parseInt(v.css("padding-top"))+parseInt(v.css("padding-bottom")),r=e.data.$popupWrap.outerHeight()-e.data.$popupButtonArea.outerHeight()-n-5;e.data.$popupTextarea.css({height:r+"px"}),e.data.mergedCellpopupEditOption.savePopupSize===!0&&(d(e.data.mapping.cellPopupEditOption)?(e.data.mapping.cellPopupEditOption.width=t,e.data.mapping.cellPopupEditOption.height=a):e.data.mapping.cellPopupEditOption={width:t,height:a}),e.preventDefault()})}),R.movable===!0&&(_.$popupWrap=v,_.cellPopupMoveEventNS=".alopexgridCellPopupMoveEventNS",D.on("mousedown"+r+a.key+a.eventns+" touchstart"+r+a.key+a.eventns,_,function(e){var t=e.data.self,a=e.data.$popupWrap,n=e;"touchstart"===e.type&&(n=e.originalEvent.touches[0]),e.preventDefault();var r={};r.self=t,r.$cell=e.data.$cell,r.cellEditFocusCls=e.data.cellEditFocusCls,r.$popupWrap=a,r.cellPopupMoveEventNS=e.data.cellPopupMoveEventNS,r.prevX=n.pageX,r.prevY=n.pageY;var o=e.data.$popupWrap.offset();r.gapX=n.pageX-o.left,r.gapY=n.pageY-o.top,xt.off(e.data.cellPopupMoveEventNS+t.key),xt.on("mousemove"+e.data.cellPopupMoveEventNS+t.key+" touchmove"+e.data.cellPopupMoveEventNS+t.key,r,function(e){var t=e;if("touchmove"===e.type&&(t=e.originalEvent.touches[0]),e.data.prevX!==t.pageX||e.data.prevY!==t.pageY){e.data.prevX=t.pageX,e.data.prevY=t.pageY;var a=(e.data.self,e.data.$popupWrap);e.preventDefault(),i(),a.css({left:e.data.prevX-e.data.gapX+"px",top:e.data.prevY-e.data.gapY+"px"})}}).on("mouseup"+e.data.cellPopupMoveEventNS+t.key+" touchend"+e.data.cellPopupMoveEventNS+t.key+" touchcancel"+e.data.cellPopupMoveEventNS+t.key,r,function(e){xt.off(e.data.cellPopupMoveEventNS+t.key)})})),xt.on("keydown"+r+a.key+a.eventns,_,function(e){var t=e.data.self,a=e.keyCode;switch(a){case 27:xt.off(e.data.cellPopupEditEventNS+t.key),null!=t.state.activePopupTextarea&&(t.state.activePopupTextarea.remove(),delete t.state.activePopupTextarea,e.data.$cell.removeClass(e.data.cellEditFocusCls),t.option.cellSelectable===!0&&Xe(t))}}),R.closeOuterClick===!0&&xt.on("mousedown"+r+a.key+a.eventns,_,function(t){var a=t.data.self,n=e(t.target);if(t.data.mousedownEvent)return void(t.data.mousedownEvent=!1);kt.trimString(n.attr("class"));null!=a.state.activePopupTextarea&&n&&0===n.closest(".alopexgrid-celledit-popupwrap.alopexgrid-popupwrap, .alopexgrid-celledit-popuptextarea.alopexgrid-popuptextarea, .alopexgrid-celledit-popupbutton.alopexgrid-popupbutton").length&&(xt.off(t.data.cellPopupEditEventNS+a.key),a.state.activePopupTextarea.remove(),delete a.state.activePopupTextarea,t.data.$cell.removeClass(t.data.cellEditFocusCls))}),setTimeout(function(){v.focus()},0)}}}})}var H=M.state.cellInlineEditData=M.state.cellInlineEditData||{self:M,pool:[]},N=M.state.cellInstantInlineEditData=M.state.cellInstantInlineEditData||{self:M,pool:[]};if(M.option.cellInlineEdit){var $=!(!M.option.instantInlineEditType||!M.option.instantInlineEditType.length);$=$||!!e.grep(M.option.columnMapping,function(e){return!!e.instantInlineEditable}).length,M.state.__cellInlineStartEdit=function(e,t){return y(M,e,t,H.pool)},M.state.__cellInlineEndEdit=function(){return x(M,H.pool)},$&&(M.$root.on("cellFocus"+T+" click"+T+" mouseenter"+T,".bodycell",N,function(e){var t=e.data.self,a=kt.parseEvent(e),n=a.data,r=a.mapping,o=e.data.pool;n&&n._index&&r&&_(t,o,n,r,null,e)}),M.$root.on("mouseenter"+T,".scrollbar,.headercell",N,function(e){x(e.data.self,e.data.pool)}),M.$root.on("mouseleave"+T,N,function(e){kt.regex.inputControls.test(e.target.tagName)||kt.renderUtil.hasClass(e.target,"alopexgrid-input-wrapper")||x(e.data.self,e.data.pool)})),M.$root.on("dataSet"+T+" dataEmpty"+T,function(e){H.pool=[],N.pool=[]});var W=M.option.cellInlineEditOption.startEvent||"dblclick";W=kt.trimString(W)+" ";var K=W.split(" ");W=kt.trimString(K.join(T+" ")),M.$root.on(W,".bodycell",H,function(t){var a=t.data.self,n=t.pageX,r=t.pageY,o=f(a,this),l=h(a,this);if(o&&l&&!a._isEditingCell(o._index.row,l.columnIndex)){var i=t.data.pool,d=x(a,i);if(d===!1&&a.option.restoreFocusOnInvalidInlineEdit===!0)return void C(a,i);if(!a._isCellEditable(o,l))return void Xe(a,o._index.row,l.columnIndex);var s=a.option.cellInlineEditOption.allowStartEditWithInvalid;if(d!==!1||s===!0){if(y(a,o,l,i)===!1)return;setTimeout(function(){var t=a._cellElementGet(o,l);if(t){var i=e(t);a._setCursorUnderPointer(i,n,r),a._triggerGridEvent("inlineEditInputFocus",{data:o,mapping:l},i)}else Xe(a,o._index.row,l.columnIndex)},0)}}}),e.inArray("cellFocus",K)<0&&e.inArray("mousedown",K)<0&&e.inArray("mouseup",K)<0&&e.inArray("click",K)<0&&M.$root.on("mousedown"+T,".bodycell",H,function(e){var t=e.data.self,a=(e.pageX,e.pageY,f(t,this)),n=h(t,this);if(a&&n&&!v(a,n,e.data.pool)){var r=e.data.pool,o=x(t,r);return(!o||t.option.restoreFocusOnInvalidInlineEdit!==!0)&&void 0}});var U=M.option.cellInlineEditOption.endEditByOtherAreaClick;if(U&&M.$root.on("mousedown"+T,H,function(t){e(t.target).closest(".bodycell").length||x(t.data.self,t.data.pool)}),M.option.cellSelectable){S.on("change"+T,"select",D,function(t){var a=t.data.self,n=e(this).closest(".bodycell");if(n.length){var r=parseInt(n.attr("data-alopexgrid-rowindex")),o=parseInt(n.attr("data-alopexgrid-columnindex"));Xe(a,r,o)}});var Y={37:"left",38:"up",39:"right",40:"down"};S.on("keydown"+T,"select",D,function(t){var a=t.data.self,n=e(this).closest(".bodycell");if(n.length){var r=parseInt(n.attr("data-alopexgrid-rowindex")),o=parseInt(n.attr("data-alopexgrid-columnindex"));if(32===t.which)return void this.focus();if(27===t.which)return Xe(a,r,o),!1;if(Y[t.which])_t||(t.preventDefault(),a.$focusfixture.trigger(t));else if(13===t.which)return}})}M.$root.on("keydown"+T,".bodycell",D,function(t){var a=t.data.self,n=e(this),r=parseInt(n.attr("data-alopexgrid-rowindex")),o=parseInt(n.attr("data-alopexgrid-columnindex")),l=a._isEditingCell(r,o);if(l)if(27===t.which)setTimeout(function(){a.cancelCellEdit(),a.option.cellSelectable?Xe(a,r,o):null},0);else if(13===t.which||9===t.which){var i=13===t.which,d=9===t.which;if(i){if("SELECT"===t.target.tagName)return;if("TEXTAREA"===t.target.tagName&&!t.ctrlKey)return}a._updateEditingCell(n),d&&(a.option.cellSelectable?t.preventDefault():null),setTimeout(function(){var n=e.inArray("cellFocus",K)<0,l=n?x(a,H.pool):null,d=n?x(a,N.pool):null,s=l!==!1&&d!==!1;a.option.cellSelectable?a.option.cellInlineEditOption.focusMoveAtEditEnd?s||a.option.restoreFocusOnInvalidInlineEdit===!1?(Xe(a,r,o),i?qe(a,t.shiftKey?-1:1,0):qe(a,0,t.shiftKey?-1:1)):a.option.restoreFocusOnInvalidInlineEdit===!0&&(C(a,H.pool),C(a,N.pool)):s?(Xe(a,r,o),a._triggerGridEvent("cellFocus",{data:a.state.renderTargetDataList[r]||null,mapping:a.state.columnIndexToMapping[o]||null},e(document.getElementById(a._cellIdFromRowIndex(r,o))))):a.option.restoreFocusOnInvalidInlineEdit===!0&&(C(a,H.pool),C(a,N.pool)):a.option.restoreFocusOnInvalidInlineEdit===!0&&(C(a,H.pool),C(a,N.pool))},0)}})}var V=M.option.endInlineEditByOuterClick;if((M.option.rowInlineEdit||M.option.cellInlineEdit)&&V){var X=s(V),z="mousedown";xt.on(z+T+M.key+M.eventns,D,function(t){var a=t.data.self,n=!1;if(X){var r=V.call(a,t.target,t);if(r===!1)return;r===!0&&(n=!0)}if(!n){var o=t.target;do{var l=!!o.getAttribute&&o.getAttribute("data-alopexgrid");if(l&&l===a.key)return;if(o.tagName&&e.inArray(o.tagName,["INPUT","SELECT","BUTTON","TEXTAREA","A"])>=0)return;o=o.parentNode}while(o)}a.option.cellInlineEdit?(x(a,H.pool),x(a,N.pool)):a.option.rowInlineEdit&&g(a)})}if(M._startCellSelectEngine(M.option.cellSelectable),M._enableHeaderSelect(!!M.option.enableHeaderSelect),M.$root.on("focus"+T+" focusin"+T,".alopexgrid-cell",D,function(e){var t=kt.parseEvent(e);t.data&&t.data._index&&t.data._index.id&&t.mapping&&kt.regex.inputControls.test(e.target.tagName)&&Qe(e.data.self,t.data._index.row,t.mapping.columnIndex)}),(M.option.enableContextMenu||M.option.enableDefaultContextMenu)&&(D.contextMenuEventNS=".alopexgridContextMenuEvent",Ct?(M.$root.on(M.option.contextMenuEvent+T+" touchstart"+T+M.key,D,function(e){var t=e.data.self;if("contextmenu"===t.option.contextMenuEvent){
var a=setTimeout(function(){w(t,e,e.data.contextMenuEventNS)},1e3);D.contextMenuEventTimer=a;var n=".mobilecontextmenuevent";D.contextMenuTouchEndEventNS=n,t.$root.on("touchend"+T+n+t.key+" touchcancel"+T+n+t.key+" mousedown"+T+n+t.key,D,function(e){var t=e.data.self;null!=e.data.contextMenuEventTimer&&(clearTimeout(e.data.contextMenuEventTimer),e.data.contextMenuEventTimer=null),t.$root.off(T+e.data.contextMenuTouchEndEventNS+t.key)})}else w(t,e,e.data.contextMenuEventNS)}),xt.on("touchmove"+T+M.key,D,function(e){null!=e.data.contextMenuEventTimer&&(clearTimeout(e.data.contextMenuEventTimer),e.data.contextMenuEventTimer=null),e.data.self&&e.data.self.state&&e.data.self.state.$contextMenuDropdown&&(e.data.self.state.$contextMenuDropdown.parents(".alopexgrid-contextmenu-wrapper").remove(),e.data.self.state.$contextMenuDropdown.remove(),e.data.self.state.$contextMenuDropdown=null)})):M.$root.on(M.option.contextMenuEvent+T,D,function(e){var t=e.data.self;w(t,e,e.data.contextMenuEventNS)})),M.option.pager&&(M.$pager.on("click"+T,".page-set",D,function(t){var a=t.data.self,n=this.getAttribute("href").split("#").pop();e(this).parent().removeClass("hovering"),a.pageSet(n),t.preventDefault()}).on("mouseover"+T,".page-button",function(){var t=e(this);t.siblings().removeClass("hovering"),t.addClass("hovering")}).on("mouseout"+T,".page-button",function(){e(this).removeClass("hovering").siblings().removeClass("hovering")}),M.$pager.on("change"+T,".perPage",D,function(t){var a=t.data.self,n=parseInt(e(this).val()),r=a.pageInfo(),o=r.current;if(a._triggerGridEvent("perPageChange",{pageinfo:r,perPage:n})!==!1){var l=Math.ceil(a.pageInfo().rowCount/n);r.current>l&&(o=l),a.updateOption({pager:!0,paging:{perPage:n,current:o}}),a._triggerGridEvent("perPageChangeEnd",{perPage:n,pageinfo:a.pageInfo()})}})),M.option.autoResize&&vt.on("resize"+T+M.key+M.eventns,{self:M,timer:null,winw:null,winh:null},function(e){var t=e.data.self,a=vt.height(),n=vt.width();if(e.data.winw!==n||e.data.winh!==a){e.data.winw=n,e.data.winh=a;var r=t.option&&t.option.autoResizeDelay?t.option.autoResizeDelay:0,o=e.data;e.data.timer&&clearTimeout(e.data.timer),e.data.timer=setTimeout(function(){t.viewUpdate(),o.timer=null},r)}}),M._activateBoardScrollEvent(),M.option.tree&&M.option.tree.useTree&&M.$root.on("click"+T,".alopexgrid-treecolumn-icon",D,function(t){var a=t.data.self;if(a.state.treeInfo&&a.state.treeInfo.childCountByIdValueMap&&!e.isEmptyObject(a.state.treeInfo.childCountByIdValueMap)){var n=e(this),r=n.closest(".alopexgrid-cell"),o=f(a,r[0]);if(r.hasClass("headercell")){t.stopPropagation();var l=a.state.treeHeaderExpandAllState;a.state.treeHeaderExpandAllState=!a.state.treeHeaderExpandAllState,l?(n.removeClass("expanded"),a.collapseTreeNode({})):(n.addClass("expanded"),a.expandTreeNode({}))}else if(o&&!a._isTreeLeafNode(o)){parseInt(r.attr("data-alopexgrid-rowindex")),parseInt(r.attr("data-alopexgrid-columnindex"));t.stopPropagation(),a.toggleTreeNode(o),i(),t.preventDefault()}}}),M.option.useClassHovering){var j={self:M};M.$root.on("mouseenter"+T,".bodycell",j,function(t){var a=t.data.self,n=f(a,this);if(n){var r=[n];if(a.state.groupRowspanned&&(a.option.rowspanGroupHovering===!0||"number"==typeof a.option.rowspanGroupHovering||"string"==typeof a.option.rowspanGroupHovering)){var o=a.option.grouping.by[0];"number"==typeof a.option.rowspanGroupHovering?o=a.option.grouping.by[a.option.rowspanGroupHovering]:"string"==typeof a.option.rowspanGroupHovering?o=a.option.rowspanGroupHovering:a.option.rowspanGroupHovering===!0&&(o=a.state.topmostGroupRowspanKey);var l=a._getGroupingRange(n._index.data,o);if(l){var i=l.from,d=l.to;r=[];for(var s=i;s<=d;s++)r.push(a.state.data[s])}}for(var p=[],u=0,c=r.length;u<c;u++){var n=r[u];p=p.concat(e.makeArray(a.rowElementGet({_index:{id:n._index.id}},Ht.cache)))}for(var u=0,c=p.length;u<c;u++)kt.renderUtil.addClass(p[u],"cell-hoveringrow")}}),M.$root.on("mouseleave"+T,".bodycell",j,function(t){var a=t.data.self,n=f(a,this);if(n){var r=[n],o=[];if(a.state.groupRowspanned&&(a.option.rowspanGroupHovering===!0||"number"==typeof a.option.rowspanGroupHovering||"string"==typeof a.option.rowspanGroupHovering)){var l=a.option.grouping.by[0];"number"==typeof a.option.rowspanGroupHovering?l=a.option.grouping.by[a.option.rowspanGroupHovering]:"string"==typeof a.option.rowspanGroupHovering&&(l=a.option.rowspanGroupHovering);var i=a._getGroupingRange(n._index.data,l);if(i){var d=i.from,s=i.to;r=[];for(var p=d;p<=s;p++)r.push(a.state.data[p])}}for(var u=0,c=r.length;u<c;u++){var n=r[u];o=o.concat(e.makeArray(a.rowElementGet({_index:{id:n._index.id}},Ht.cache)))}for(var u=0,c=o.length;u<c;u++)kt.renderUtil.removeClass(o[u],"cell-hoveringrow")}})}var q=!!(M.option.grouping&&M.option.grouping.useGrouping&&M.option.grouping.by&&M.option.grouping.by.length),Z=!(!q||!M.option.grouping.useGroupHeader),J=!(!q||!M.option.grouping.useGroupFooter);if((Z||J)&&M.$root.on("click"+T,".alopexgrid-groupfolding-icon",D,function(t){var a=t.data.self;if(e(t.target).closest(".headercell").length){var n=kt.parseEvent(t),r=n.mapping,o=this.getAttribute("data-alopexgrid-groupfolding-depth");e.isNumeric(o)?o=parseInt(o):"true"===o&&(o=null),a._applyGroupFoldingStateToHeader([r.key],"toggle");var l=!a.state.headerGroupFoldingIconCollapsed[r.id],d=[];return"number"!=typeof o&&"string"!=typeof o||d.push(o),void(l?a.expandGroup.apply(a,d):a.collapseGroup.apply(a,d))}var s=this.getAttribute("data-alopexgrid-rangeid"),p=a.state.groupingLookupTableMapById[s];p&&(t.preventDefault(),a._toggleCollapseGroupRange(p),a.filterAndRedraw(),i())}),M.state.hasColumnFoldingColumn){var ee="click";yt&&(ee="touchstart"),M.$root.on(ee+T,".header-columnfolding-icon",D,function(t){var a=t.data.self,n=kt.parseEvent(t),r=n.mapping;if(r){var o,l,i=r.columnIndex,d=[];if(e.isArray(r.columnFoldingColumn))var o=a._columnIndexKeyToMappingList(r.columnFoldingColumn[0]),l=a._columnIndexKeyToMappingList(r.columnFoldingColumn[1]);else{var s,o=a._columnIndexKeyToMappingList(r.columnFoldingColumn.fromIndex),l=a._columnIndexKeyToMappingList(r.columnFoldingColumn.toIndex),p=r.columnFoldingColumn.exceptionColList;if(p&&p.length>0)for(var u=0,c=p.length;u<c;u++)s=a._columnIndexKeyToMappingList(p[u]),s&&s.length&&d.push(s[0].columnIndex)}if(o&&o.length){var g=o[0],f=g.columnIndex;if(l&&l.length){var h=l[0],m=h.columnIndex,v=!0;null!=r.columnFoldingHiddenType&&(v=r.columnFoldingHiddenType),a._toggleColumnFold(f,m,i,d,v),e.isArray(r.columnFoldingColumn)?a._triggerGridEvent("columnFolding",{mapping:r,columnFolded:r.columnFolded,fromIndex:f,toIndex:m}):a._triggerGridEvent("columnFolding",{mapping:r,columnFolded:r.columnFolded,fromIndex:f,toIndex:m,exceptionColList:d})}}}})}},kt.prototype._columnIndexKeyToIndexArray=function(t,a,n){var r,o=this;if(null==a&&(a=[]),null!=t&&t.length>0)for(var l=0;l<t.length;l++)if(r=t[l],null!=r)if("string"==typeof r)if(n){var i=o.state.keyMappedToMultipleColumn[r];if(null!=i&&i.length>0)for(var d,s=0;s<i.length;s++){var d=i[s].columnIndex;e.inArray(d,a)===-1&&a.push(d)}else a.push(o.state.columnKeyToIndexMap[r])}else a.push(o.state.columnKeyToIndexMap[r]);else a.push(r);return a},kt.prototype._addTreeChildToList=function(t,a,n){var r=this;t&&d(t)&&(t=[t]),t=[].concat(t);var o=[];if(r.option.tree&&r.option.tree.useTree&&e.isArray(t)&&t.length){for(var l={},i=0,s=t.length;i<s;i++)l[t[i]._index.id]=!0;for(var i=t.length-1;i>=0;i--){for(var p=t[i],u=p._state.treeNodeDepth,c=p._index.data+1,g=[];c<r.state.data.length;){var f=parseInt(r.state.data[c]._state.treeNodeDepth)-u;if(f<=0)break;l[r.state.data[c]._index.id]||(!a||a&&1===f)&&(l[r.state.data[c]._index.id]=!0,g.push(r.state.data[c])),c++}n||g.unshift(p),Array.prototype.unshift.apply(o,g)}}return o},kt.prototype._addTreeParentToList=function(t,a,n){var r=this;if(!r.option.tree||!r.option.tree.useTree)return t;t&&d(t)&&(t=[t]),t=[].concat(t);var o=[];if(e.isArray(t)&&t.length){for(var l={},i=0,s=t.length;i<s;i++)l[t[i]._index.id]=!0;for(var i=t.length-1;i>=0;i--){var p=t[i];if(p._index.parentid){for(var u=r._dataGetByIndex({id:p._index.parentid}),c=[];u&&(l[u._index.id]||(l[u._index.id]=!0,c.unshift(u)),u._index.parentid)&&!a;)u=r._dataGetByIndex({id:u._index.parentid});n||c.push(p),Array.prototype.unshift.apply(o,c)}}}return o},kt.prototype._getTreeNodeDepth=function(e){return this.state.treeInfo&&e?this.state.treeInfo.depthByIdValueMap[e[this.option.tree.idKey]]||0:null},kt.prototype._isTreeParentNodeExpanded=function(e){for(var t=this,a=e,n=!0;(a=t._dataGetByIndex({id:a._index.parentid}))&&a._index.id!==a._index.parentid;)if(!a._state.expandedTreeNode){n=!1;break}return n},kt.prototype._isTreeNodeExpanded=function(e){return!!e._state.expandedTreeNode},kt.prototype._isTreeLeafNode=function(e){return e._state.treeNodeLeaf},kt.prototype._toggleTreeNode=function(e){this._isTreeLeafNode(e)||(e._state.expandedTreeNode=!e._state.expandedTreeNode)},kt.prototype._setExpandedTreeNodeState=function(e){"boolean"!=typeof e._state.expandedTreeNode&&(e._state.expandedTreeNode=!(!this.option.tree.expandedKey||!e[this.option.tree.expandedKey]||String(e[this.option.tree.expandedKey])===String(this.state.treeOption.expandedValue[1])))},kt.prototype._expandTreeNode=function(e){e&&!this._isTreeLeafNode(e)&&(e._state.expandedTreeNode=!0,e._index.parentid&&this._expandTreeNode(this._dataGetByIndex({id:e._index.parentid})))},kt.prototype._collapseTreeNode=function(e){this._isTreeLeafNode(e)||(e._state.expandedTreeNode=!1)},kt.prototype.expandTreeNode=function(t){for(var a=this._dataGet(t),n=0,r=a.length;n<r;n++)this._expandTreeNode(a[n]);(!t||e.isEmptyObject(t)||t._index&&t._index.row===!0)&&(this.state.treeHeaderExpandAllState=!0),this.filterAndRedraw()},kt.prototype.collapseTreeNode=function(t){for(var a=this._dataGet(t),n=0,r=a.length;n<r;n++)this._collapseTreeNode(a[n]);(!t||e.isEmptyObject(t)||t._index&&t._index.row===!0)&&(this.state.treeHeaderExpandAllState=!1),this.filterAndRedraw()},kt.prototype.toggleTreeNode=function(e){for(var t=this._dataGet(e),a=0,n=t.length;a<n;a++)this._toggleTreeNode(t[a]);this.filterAndRedraw()},kt.prototype._getUniqueIdValueForTreeNode=function(t){var a=this,n=t[a.option.tree.idKey];if(!a.state.treeInfo)return n;var r=s(a.option.tree.idGenerator);null!=n||r||(n=a.option.tree.initialIdValue);var o=null,l=null;r&&(t._index.parentid||null!=t[a.option.tree.parentIdKey])&&(o=a._dataGetByIndex({id:t._index.parentid}),o||(o=a._dataGetByIndex({id:a.state.treeInfo.idValueToDataIdMap[t[a.option.tree.parentIdKey]]})),o&&(l=o[a.option.tree.idKey]));for(var i=0;null==n||a.state.treeInfo.idValueToDataIdMap[n];){if(r){var d=a.option.tree.idGenerator.call(a,n,l,t,o,a.state.treeInfo.idValueToDataIdMap);if(d===n||null==d)throw new Error("option.tree.idGenerator function should return modified id value("+n+"->"+d+").");n=d}else{var p=n.split("_");(p.length<=1||!e.isNumeric(p[p.length-1]))&&p.push(0),p[p.length-1]=parseInt(p[p.length-1])+1,n=p.join("_")}if(i++,i>a.state.data.length)throw new Error("option.tree.idGenerator runs more than data length.")}return n},kt.prototype.treeDataMove=function(e,t,a){var n=this;if(!n._noData()&&n.state.treeInfo){var r=n._dataGet(e);if(r&&r.length){r.sort(function(e,t){return e._index.data-t._index.data});var o=t?n._dataGet(t)[0]:null,l=null,i="number"===n.option.tree.depthValueType?0:"",d=n.state.treeOption.expandedValue[n.state.treeOption.initialExpandedValue?0:1];o&&(l=o[n.option.tree.idKey]);var s=n.state.data.length;if(a){var p=n._dataGet(a)[0];p&&(s=p._index.data)}var u=0,c=[],g={};o?(g[n.option.tree.parentIdKey]=l,n.option.tree.depthKey&&(g[n.option.tree.depthKey]=parseInt(o[n.option.tree.depthKey])+1+i),n.option.tree.leafKey&&(g[n.option.tree.leafKey]=n.state.treeOption.leafValue[0]),n.option.tree.expandedKey&&(g[n.option.tree.expandedKey]=d)):(g[n.option.tree.parentIdKey]=n.option.tree.rootNodeParentIdValue,n.option.tree.depthKey&&(g[n.option.tree.depthKey]=0+i),n.option.tree.leafKey&&(g[n.option.tree.leafKey]=n.state.treeOption.leafValue[0]),n.option.tree.expandedKey&&(g[n.option.tree.expandedKey]=d));for(var f=0,h=r.length;f<h;f++){r[f]._index.data<s&&(u-=1);var m=n._isTreeNodeIncludeChild(r[f],o);if(m)return!1;var v=n.state.data.splice(r[f]._index.data,1)[0];v&&(n._dataEdit(v,g),c.push(v))}s+=u,s=Math.min(s,n.state.data.length),c.unshift(s,0),Array.prototype.splice.apply(n.state.data,c),n.sortClear(),n.calcAndRedraw()}}},kt.prototype.treeGetParent=function(t,a){var n=this,r=n._treeGetParent.apply(n,arguments);return n.option.deepCopyOnDataGet&&e.isArray(r)&&(r=e.extend(!0,[],r)),r},kt.prototype.treeGetChild=function(t,a){var n=this,r=n._treeGetChild.apply(n,arguments);return n.option.deepCopyOnDataGet&&e.isArray(r)&&(r=e.extend(!0,[],r)),r},kt.prototype._isTreeNodeIncludeChild=function(e,t){var a=this;if(!t)return!1;for(var n=a._treeGetChild(e,{recursive:!0,inclusive:!0}),r=0,o=n.length;r<o;r++)if(n[r]._index.id===t._index.id)return!0;return!1},kt.prototype._treeGetParent=function(e,t){var a=this;if(!a.state.treeInfo)return[];var n=a._dataGet(e);if(!n||!n.length)return[];var r=!(!t||t.recursive!==!0),o=!(!t||t.inclusive!==!0),l=a._addTreeParentToList(n,!r,!o);return l},kt.prototype._treeGetChild=function(e,t){var a=this,n=null;if(!a.state.treeInfo)return[];if(!e){if(!a.state.treeInfo.rootChildIdValueList||!a.state.treeInfo.rootChildIdValueList.length)return[];n=[];for(var r=0,o=a.state.treeInfo.rootChildIdValueList.length;r<o;r++){var l=a.state.treeInfo.rootChildIdValueList[r],i=a.state.treeInfo.idValueToDataIdMap[l],d=a._dataGetByIndex({id:i});d&&n.push(d)}var s=!(!t||t.recursive!==!0);return s?a._addTreeChildToList(n,!1,!1):n}if(n=a._dataGet(e),!n||!n.length)return[];var s=!(!t||t.recursive!==!0),p=!(!t||t.inclusive!==!0),u=a._addTreeChildToList(n,!s,!p);return u},kt.prototype.addContextMenu=function(t,a){d(t)&&t.hasOwnProperty("title")&&(e.isNumeric(a)?this.option.contextMenu.splice(a,0,t):this.option.contextMenu.push(t))},kt.prototype.deleteContextMenu=function(e){this.option.contextMenu.splice(e,1)},kt.prototype._calculateColumnWidthProperty=function(){var e=this;e.state.columnWidth=0,e.state.columnWidthMap={},e.state.columnWidthExceptFixed=0,e.state.columnWidthExceptFixedMap={},e.state.columnIndexArr=[],e.state.columnIndexArrOrderMap={};var t=0,a=0;e._columnShowFromEnabled()&&null!=e.state.columnFixShowFromColumnIndex&&(a=e.state.columnFixShowFromColumnIndex);for(var n=0;n<e.option.columnMapping.length;n++){var r=e.option.columnMapping[n];r&&null!=r.columnIndex&&r.columnIndex<a||r&&r.columnIndex>=0&&r.hidden!==!0&&"conceal"!==r.hidden&&(r.fixed===!0&&r.columnIndex<=e.state.fixupto||(r.fixed===!0&&(r.fixed=!1),e.state.columnWidthExceptFixedMap[r.columnIndex]=parseInt(r.width),e.state.columnWidthExceptFixed+=parseInt(r.width)),e.state.columnWidthMap[r.columnIndex]=parseInt(r.width),e.state.columnWidth+=parseInt(r.width),e.state.columnIndexArrOrderMap[r.columnIndex]=t++,e.state.columnIndexArr.push(parseInt(r.columnIndex)))}e.state.standardColumnWidth=0,e.state.standardColumnWidthMap={},e.state.fixedColumnMapping.length>0?(e.state.standardColumnWidth=e.state.columnWidthExceptFixed,e.state.standardColumnWidthMap=e.state.columnWidthExceptFixedMap):(e.state.standardColumnWidth=e.state.columnWidth,e.state.standardColumnWidthMap=e.state.columnWidthMap)},kt.prototype.setScroll=function(e){var t=this;null!=e&&(null!=e.column&&(t.state.renderFromColumnIndex=e.column),null!=e.columnScrollEnd&&(t.state.scrollxEnd=e.columnScrollEnd),null!=e.row&&(t.state.renderFromRenderedIndex=e.row),null!=e.rowScrollEnd&&(t.state.scrollyEnd=e.rowScrollEnd),t.viewUpdate())},kt.prototype.scrollOffset=function(){var e=this,t={};return t.row=e.state.renderFromRenderedIndex,t.column=e.state.renderFromColumnIndex,t.rowScrollEnd=e.state.scrollyEnd,t.columnScrollEnd=e.state.scrollxEnd,t},kt.prototype._getGroupingRangeByGroupId=function(e){return this.state.groupingLookupTableMapById?this.state.groupingLookupTableMapById[e]||null:null},kt.prototype._getGroupingRange=function(e,t){var a=this.state.groupingLookupTable;if(!a)return null;var n=a[t];if(!n)return null;var r=n[e];return r?r:null},kt.prototype._getGroupingRangeByMapping=function(e,t){var a=t.key,n=this;return t.rowspan&&"string"==typeof t.rowspan.by?a=t.rowspan.by:t.rowspan&&"number"==typeof t.rowspan.by&&(a=n.state.columnIndexToKeyMap[t.rowspan.by]),this._getGroupingRange(e,a)},kt.prototype._getGroupingRangeByData=function(e,t){if(!e)return null;var a=this;if(!a.state.groupingLookupTable||!a.state.groupingLookupTableMapById)return null;var n=null;if(n=a.state.groupingLookupTableMapById[e._state.groupFooter||e._state.groupHeader])return n||null;if(!t)return null;var r=t.key;return t.rowspan&&"string"==typeof t.rowspan.by?r=t.rowspan.by:t.rowspan&&"number"==typeof t.rowspan.by&&(r=a.state.columnIndexToKeyMap[t.rowspan.by]),a._getGroupingRange(e._index.data,r)},kt.prototype._getGroupRangeByQuery=function(e,t){var a=this,n=a._dataGet(e);if(!n||!n.length)return null;var r=n[0],o=null;return(o=a.state.groupingLookupTableMapById[r._state.groupFooter||r._state.groupHeader])?o||null:a._getGroupingRange(r._index.data,t)},kt.prototype._getGroupDataListByQuery=function(e,t){var a=this,n=a._getGroupRangeByQuery(e,t);return n?n.member:[]},kt.prototype.groupRangeGet=function(e,t){return this._getGroupRangeByQuery.apply(this,arguments)},kt.prototype.groupDataGet=function(e,t){return this._getGroupDataListByQuery.apply(this,arguments)},kt.prototype._filterDataToFunction=function(e){var t=e.type;if(null==t||""===t)return null;var a=e.key,n=e.value;return function(e){return kt.filterFunction[t](e[a],n)}},kt.prototype._filterWrapDragStart=function(t,a,n){var r=this,o=e("#"+n),l=e.event.fix(t);"touchstart"===t.type&&(l=t.touches[0]),t.preventDefault();var d=".alopexgridFilterDragEvnetNS",s={};s.self=r,s.$filterWrap=o,s.filterDragEvnetNS=d,s.prevX=l.pageX,s.prevY=l.pageY;var p=o.offset();s.gapX=l.pageX-p.left,s.gapY=l.pageY-p.top,xt.off(d+r.key),xt.on("mousemove"+d+r.key+" touchmove"+d+r.key,s,function(e){var t=e;if("touchmove"===e.type&&(t=e.originalEvent.touches[0]),e.data.prevX!==t.pageX||e.data.prevY!==t.pageY){e.data.prevX=t.pageX,e.data.prevY=t.pageY;var a=(e.data.self,e.data.$filterWrap);e.preventDefault(),i(),a.css({left:e.data.prevX-e.data.gapX+"px",top:e.data.prevY-e.data.gapY+"px"})}}).on("mouseup"+d+r.key+" touchend"+d+r.key+" touchcancel"+d+r.key,s,function(e){xt.off(d+r.key)})},kt.prototype._filterTextFoldingEvent=function(t,a){var n=this,r=t.which?t.which:t.keyCode;1!==r&&13!==r&&32!==r||(t.target.className.indexOf("folded")===-1?(e(t.target).addClass("folded"),e("#"+n.key+"_filterTextRadioArea").hide(),e("#"+n.key+"_filterTextSelectArea").hide()):(e(t.target).removeClass("folded"),e("#"+n.key+"_filterTextRadioArea").show(),e("#"+n.key+"_filterTextSelectArea").show()))},kt.prototype._drawFilterUnit=function(t,a){var n=this,r=[],o=(t?t.type:null)||"",l=(t?t.value:null)||"",i=(t?t.rule:"and")||"and",d=n.state.columnIndexToMapping[a];"checkedList"===o&&(o="",l="",i="and");var s,p=d.key,u=/[\\'\"]/gi;return e.isArray(o)?(l[0]=l[0].replace(u,""),l[1]=l[1].replace(u,""),s=[ut+".run('",n.key,"','_filterBtnEventhandler','",p,"','",a,"','",o[0],"','",l[0],"','",o[1],"','",l[1],"','",i,"',event);"].join("")):(l=l.replace(u,""),s=[ut+".run('",n.key,"','_filterBtnEventhandler','",p,"','",a,"','",o,"','",l,"','",,"','",,"','",i,"',event);"].join("")),r.push('<input type="hidden" class="alopexgrid-filter-key" name="alopexgrid-filter-key" value="',p,'"/>'),r.push('<button class="alopexgrid-filter-dropdownbutton '+(t?"filtered":"")+'" type="button"'),r.push(' onkeydown="',s,'"'),r.push(' onmousedown="',s,'"'),r.push(">&nbsp;</button>"),r.join("")},kt.prototype.isFilteredColumn=function(e){var t=this;if(null==t.state.filterColumnMappingList)return!1;var a=t._columnIndexKeyToMappingList(e);return!(!a||!a.length)&&(a=a[0],t._hasColumnFilter(a))},kt.prototype._closeFilterDropdown=function(){var e=this;e.state.filterDropdownWrapper&&e.state.filterDropdownWrapper.hide()},kt.prototype._removeFilterDropdown=function(){var t=this;if(t.state.filterDropdownWrapper&&(t.state.filterDropdownWrapper.removeAlopexGrid(),t.state.filterDropdownWrapper.remove(),t.state.filterDropdownWrapper=null,xt.off(".alopexgridFilterdropdownWrapper"+t.key),e(".alopexgrid-filterdropdown-wrapper li.remove").off("mousedown.alopexgridFilterdropdownWrapper"+t.key),null!=t.state.filterFocusedColIdx)){var a=t.$wrapper.find('.filter-cell-unit[data-alopexgrid-columnindex="'+t.state.filterFocusedColIdx+'"] button');a.length>0&&a.focus()}},kt.prototype.removeFilterDropdown=function(){var e=this;e._closeFilterDropdown(),e._removeFilterDropdown()},kt.prototype.showFilterDropdown=function(t){var a=this,n=a._columnIndexKeyToMappingList(t);if(n&&n.length){var r=n[0],o=r.columnIndex,l=r.filterOption||{};null==l?(type="",value="",rule="and"):(type=l.type||"",value=l.value||"",rule=l.rule||"and","checkedList"===type&&(type="",value="",rule="and"));var i=a.$wrapper.find(".headercell").filter('[data-alopexgrid-columnindex="'+o+'"]')[0];e.isArray(type)?a._filterBtnEventhandler(r.key,o,type[0],value[0],type[1],value[1],rule,null,i,!0):a._filterBtnEventhandler(r.key,o,type,value,"","",rule,null,i,!0)}},e.fn._alopexgridDelayKeyUp=function(e,t,a,n,r,o){var l=0,i=this;return i.on("keyup mouseup",function(d){clearTimeout(l),l=setTimeout(function(){e(i,a,n,r,o,d)},t)}),i},kt.prototype._filterBtnEventhandler=function(t,a,n,r,l,i,s,p,u,c){var g=this;if(null!=p){var f=p.which?p.which:p.keyCode;if(1!==f&&13!==f&&32!==f)return}g.showProgress(function(){var f;if(p?(p=e.event.fix(p),f=e(p.target?p.target:p.currentTarget)):f=e(u),0!==f.length){"BUTTON"===f[0].nodeName?g.state.filterFocusedColIdx=a:g.state.filterFocusedColIdx=null;var h=f.offset();g._removeFilterDropdown();var m=g.columnInfo(a),v=document.createElement("div");v.id=o(),v.className=pt+" alopexgrid-filterdropdown-wrapper";var x=e(v);x.css({position:"absolute",left:h.left+"px",top:h.top+f.height()+"px"});var y={closeOuterClick:g.option.closeFilterOuterClick,saveFilterSize:g.option.saveFilterDropdownSize,scrollResetAfterFilter:g.option.scrollResetAfterFilter,typeList:g.option.filterTypeList,useRenderToFilter:m.useRenderToFilter};d(g.option.filteringHeader)&&(y.minHeight=g.option.filteringHeader.minHeight,y.minWidth=g.option.filteringHeader.minWidth);var C=e.extend({},g.option.filter,y,m.filter),I=document.createElement("div");I.id=o();var _=o()+"_"+g.key,w=e(ne(g,{key:t,wrapId:v.id,filteredTypeTop:n,filteredTypeBottom:l,filteredValueTop:r,filteredValueBottom:i,filterRule:s,filterGridId:_,columnIndex:a,isApiCall:c,columnInfo:m,mergedFilterOption:C})),b=w.find(".filtertext"),M=w.find(".filterselect");b[0].oldVal=r;var S=450;null!=C.textFilterDelay&&(S=C.textFilterDelay),b._alopexgridDelayKeyUp(function(e,t,a,n,r,o){var l=e[0],i=l.value,d=M.val();l.oldVal!==i&&null!=d&&""!==d&&(kt.trimString(i).length>0?t._parseFilterHeader(o,a,n,r,!1,!0,!1):t._parseFilterHeader(o,a,n,r,!1,!0,"top")),l.oldVal=i},S,g,_,a,c);var E=w.find(".filtertextbottom"),T=w.find(".filterselectbottom");E[0].oldVal=i,E._alopexgridDelayKeyUp(function(e,t,a,n,r,o){var l=e[0],i=l.value,d=T.val();l.oldVal!==i&&null!=d&&""!==d&&(kt.trimString(i).length>0?t._parseFilterHeader(o,a,n,r,!1,!0,!1):t._parseFilterHeader(o,a,n,r,!1,!0,"bottom")),l.oldVal=i},S,g,_,a,c),w.find('input[type="radio"]').on("change",function(t,a){var n=e("#alopexgrid_andradio"),r=n.parent(),o=e("#alopexgrid_orradio"),l=o.parent();n.prop("checked")===!0?(n.attr("checked","checked"),r.addClass("checked"),o.removeAttr("checked"),l.removeClass("checked")):(o.attr("checked","checked"),l.addClass("checked"),n.removeAttr("checked"),r.removeClass("checked"))});var D=document.createElement("div");D.id=_;var R=e(D),F=document.createElement("div");F.className="checkboxarea";var k=e(F),L=document.createElement("li");L.className="buttonarea";var A=e(L),O=document.createElement("input");O.type="button",O.className="filtersubmit",O.value=kt.i18n("apply");var P=[ut+".run('",g.key,"','_setCheckedListFilter',event,'",_,"','",a,"','",c,"','",C.scrollResetAfterFilter,"');"].join("");O.setAttribute("onmousedown",P),O.setAttribute("data-alopexgrid-key",t);var B=e(O),G=document.createElement("input");G.type="button",G.className="filterclose",G.value=kt.i18n("close");var H=[ut+".run('",g.key,"','removeFilterDropdown', event);"].join("");G.setAttribute("onmousedown",H),A.append(B,G),k.append(R,A),w.append(k),x.append(I,w),e(document.body).append(x),yt===!1&&(b.focus(),b.val().length>0&&b[0].select());var N=200,$=275;null!=C.minHeight&&(N=Math.max(N,C.minHeight)),null!=C.minWidth&&($=Math.max($,C.minWidth));var W={};W.minHeight=Math.max(N,x.height()-w.height()),W.minWidth=Math.max($,x.width()),le(g,R,t,a,B,W,C);var K=Number(x.css("left").split("px")[0]),U=Number(x.css("top").split("px")[0]),Y=x.width()+Number(x.css("margin-left").split("px")[0])+Number(x.css("margin-right").split("px")[0]),V=x.height()+Number(x.css("margin-top").split("px")[0])+Number(x.css("margin-bottom").split("px")[0]),X=x.offset().left-vt.scrollLeft()+Y,z=vt.width();X>z&&(K-=X-z+10,K<0&&(K=0));var j=x.offset().top-vt.scrollTop()+V,q=vt.height();j>q&&(U-=j-q+10,U<0&&(U=0)),x.css({left:K+"px",top:U+"px"});var Z=document.createElement("div");Z.className="box-resizing-handle",Z.style.right="0px",Z.style.bottom="0px",x.append(Z);var Q=document.createElement("div");Q.className="box-resizing-align",Q.style.display="none",x.append(Q);var J={};J.self=g,J.bar=Q,J.$wrap=x,J.mergedFilterOption=C,J.$filterGrid=R,J.columnInfo=m,J.gridSize=W,x.on("mousedown touchstart",".box-resizing-handle",J,function(e){var t=e;"touchstart"===e.type&&(t=e.originalEvent.touches[0]);var a=e.data.self;e.data.bar.style.display="block",e.data.bar.style.height=(e.data.startHeight=x.outerHeight())+"px",e.data.bar.style.width=(e.data.startWidth=x.outerWidth())+"px",e.data.startPageX=t.pageX,e.data.startPageY=t.pageY,e.data.diffx=0,e.data.diffy=0,e.data.$filterGrid.hide();var n=it(e.data.$filterGrid);e.data.gridMinHeight=Math.max(n.state.headerHeight,W.minHeight),e.data.gridMinWidth=W.minWidth,e.data.minWidth=Math.max(W.minWidth,e.data.$wrap.outerWidth()),e.data.minHeight=e.data.$wrap.outerHeight()+e.data.gridMinHeight,e.data.$filterGrid.show();var r=".alopexgridFilterdropdownWrapper.alopexgridFilterdropdownWrapperResize"+a.key+a.eventns;e.data.ns=r,xt.off(r),xt.on("selectstart"+r,function(e){e.preventDefault()}),xt.on("mousemove"+r+" touchmove"+r,e.data,function(e){e.preventDefault();var t=e;"touchmove"===e.type&&(t=e.originalEvent.touches[0]),e.data.diffx=t.pageX-e.data.startPageX,e.data.diffy=t.pageY-e.data.startPageY,e.data.bar.style.width=Math.max(e.data.minWidth,e.data.startWidth+e.data.diffx)+"px",e.data.bar.style.height=Math.max(e.data.minHeight,e.data.startHeight+e.data.diffy)+"px"}),xt.on("mouseup"+r+" touchend"+r+" touchcancel"+r,e.data,function(e){e.data.self;xt.off(e.data.ns);var t=it(e.data.$filterGrid);e.data.bar.style.display="none",e.preventDefault();var a=Math.max(e.data.gridMinWidth,t.option.width+e.data.diffx),n=Math.max(e.data.gridMinHeight,t.option.height+e.data.diffy);if(t.updateOption({width:a,height:n}),e.data.mergedFilterOption.saveFilterSize){var r=e.data.columnInfo;r&&r.filter!==!1&&(d(r.filter)||(r.filter={}),r.filter.width=a,r.filter.height=n)}})}),it(R).viewUpdate(),g.state.filterDropdownWrapper=x,g.state.filterDropdown=w,xt.on("keydown.alopexgridFilterdropdownWrapper"+g.key+g.eventns,{self:g},de),C.closeOuterClick===!0&&xt.on("mousedown.alopexgridFilterdropdownWrapper"+g.key+g.eventns,{self:g},ie)}})},kt.prototype._setCheckedListFilter=function(t,a,n,o,l){function i(){var e={filterMap:(d.option.rowOption?d.option.rowOption.filter:null)||null,filterColumnMappingList:(d.state.filterColumnMappingList&&d.state.filterColumnMappingList.length?d.state.filterColumnMappingList:null)||null,changeType:v,targetColumnMapping:m,targetColumnFilterOption:(c[0]?c[0].f:null)||null,targetFilterMap:null};return e}var d=this;t&&(t=e.event.fix(t));var s,p=it(e("#"+a)),u=!!p.state.selectAll,c=[],g=d._filterGetCheckedList(a);if(s=It?r(g):Object.keys(g).length,0===s)return void d._closeFilterDropdown();if("true"===o){var f=d._parseFilterUnitForCheckListByApi(g,u,n,t);null!==f&&c.push({c:n,f:f})}else{var h=d.$wrapper.find(".filter-cell-unit");c=c.concat(h.map(function(e,a){var r=d._parseFilterUnitForCheckList(a,g,u,n,t);return r?{c:n,f:r}:void 0}).toArray())}var m=d.state.columnIndexToMapping[n]||null,v=u?"columnFilterDelete":"columnFilterSet";d._triggerGridEvent("filterChangeStart",i())!==!1&&d.showProgress(function(){d._closeFilterDropdown(),e.each(c,function(e,t){d._setColumnFilter(d.state.columnIndexToMapping[t.c],t.f)}),"true"===l&&d._scrollerReset(),d.filterAndRedraw(),d._removeFilterDropdown();var t=(d.option.rowOption?d.option.rowOption.filter:null)||null,a=(d.state.filterColumnMappingList&&d.state.filterColumnMappingList.length?d.state.filterColumnMappingList:null)||null;d._triggerGridEvent("filterChange",{filterMap:t,filterColumnMappingList:a,filterColumnMapping:m}),d._triggerGridEvent("UIFilterChange",{filterMap:t,filterColumnMappingList:a,filterColumnMapping:m}),d._triggerGridEvent("filterChangeEnd",i())})},kt.prototype._parseFilterUnitForCheckListByApi=function(e,t,a,n){var r=this,o={rule:"and"},l=n.target?n.target:n.currentTarget;l.getAttribute("data-alopexgrid-key");return t?(r._hasColumnFilter(r.state.columnIndexToMapping[a])&&r._removeColumnFilter(r.state.columnIndexToMapping[a]),null):(o.value=e,o.type="checkedList",null==o.value||0===o.value.length?null:o)},kt.prototype._parseFilterUnitForCheckList=function(e,t,a,n,r){var o=this,l={rule:"and"},i=r.target?r.target:r.currentTarget,d=i.getAttribute("data-alopexgrid-key"),s=e.getElementsByTagName("input")[0].value;return d!==s?null:a?(o._hasColumnFilter(o.state.columnIndexToMapping[n])&&o._removeColumnFilter(o.state.columnIndexToMapping[n]),null):(l.value=t,l.type="checkedList",null==l.value||0===l.value.length?null:l)},kt.prototype._filterGetCheckedList=function(t,a){for(var n,r=this,o={},l=it(e("#"+t)),i=l._dataGet({_state:{selected:!0}}),d=0;d<i.length;d++)if(n=i[d],n.label!==kt.i18n("filterList")){o[n.label]=!0;var s="";if(r.state.isFilterRendered){if(l.state.filterRenderFuntion&&l.state.isDefaultRenderType)s=l.state.filterRenderFuntion(l.state.filterRenderObj,n.label);else if(l.state.filterRenderFuntion&&null!==l.state.isDefaultRenderType){var p=r._dataGetByIndex({id:n.dataid}),u=l.state.filterRenderMapping;s=l.state.filterRenderFuntion.call(r,n.label,p,u.render||{type:"string"},u,r)}(s&&s.nodeType||s.jquery)&&(s=e(s).text()),null!=l.state.filterDuplicateMap[s]&&e.extend(!0,o,l.state.filterDuplicateMap[s])}}else o[void 0]=!0;return l.state.filterDuplicateMap=null,o},kt.prototype._parseFilterUnit=function(e,t,a,n,r){var o=this,l={rule:"and"},i=e.target?e.target:e.currentTarget;n&&(i=i.nextElementSibling);var d=i.getAttribute("value");if("SELECT"===i.nodeName&&null==d&&(d=i.value),null!=t){var s=i.getAttribute("data-alopexgrid-key"),p=t.getElementsByTagName("input")[0].value;if(s!==p)return null}return l=se(o,d,l,i,r)},kt.prototype._parseFilterHeader=function(t,a,n,r,o,l,i){function d(){var e={filterMap:(s.option.rowOption?s.option.rowOption.filter:null)||null,filterColumnMappingList:(s.state.filterColumnMappingList&&s.state.filterColumnMappingList.length?s.state.filterColumnMappingList:null)||null,changeType:v,targetColumnMapping:m,targetColumnFilterOption:(c[0]?c[0].f:null)||null,targetFilterMap:null};return e}var s=this;if(t&&(t=e.event.fix(t)),"true"===o)s._closeFilterDropdown();else if(t.target&&"filter-radio"===t.target.className){var p=s.state.filterDropdownWrapper.find(".filterselect").val(),u=s.state.filterDropdownWrapper.find(".filterselectbottom").val();if(null==p||""===p||null==u||""===u)return}var c=[],g=!1;if("true"===o)s._hasColumnFilter(s.state.columnIndexToMapping[n])&&s._removeColumnFilter(s.state.columnIndexToMapping[n]);else if("top"===i)s._hasColumnFilter(s.state.columnIndexToMapping[n])&&s._removeColumnFilter(s.state.columnIndexToMapping[n]),
g=!0;else{if(r&&"undefined"!==r){var f=s._parseFilterUnit(t,null,n,l,i);null!==f&&c.push({c:n,f:f})}else{var h=s.$wrapper.find(".filter-cell-unit");c=c.concat(h.map(function(e,a){var r=s._parseFilterUnit(t,a,n,l,i);if(null!==r)return{c:n,f:r}}).toArray())}if(0===c.length)return;if(c&&"remove"===c[0].f){if(!s._hasColumnFilter(s.state.columnIndexToMapping[n]))return;s._removeColumnFilter(s.state.columnIndexToMapping[n]),c=[],g=!0}}var m=s.state.columnIndexToMapping[n]||null;s.state.removeFilterColumnMapping[m.id]=!0;var v="true"===o?"columnFilterDelete":"columnFilterSet";s._triggerGridEvent("filterChangeStart",d())!==!1&&s.showProgress(function(){e.each(c,function(e,t){s._setColumnFilter(s.state.columnIndexToMapping[t.c],t.f)}),"true"===o&&s._removeFilterDropdown(),s.calcAndRedraw();var t=e("#"+a).__alopexgrid();if(g)t._rowSelectAllCheck(),t.state.selectAll=!0,t.rowSelect({},!0),t.dataSort("label");else if("true"!==o){var r=s.state.columnIndexToKeyMap[n],l=[];if(e.map(s.state.filteredDataList,function(t,a){e.inArray(""+t[r],l)===-1&&l.push(""+t[r])}),t.state.data.length!==l.length){t._rowSelectAllUncheck(),t.state.selectAll=!1,t.rowSelect({},!1);for(var i=0;i<l.length;i++){var p=l[i],u={label:p};t.rowSelect(u,!0)}t.dataSort("label")}else t._rowSelectAllCheck(),t.state.selectAll=!0,t.rowSelect({},!0),t.dataSort("label")}var f=(s.option.rowOption?s.option.rowOption.filter:null)||null,h=(s.state.filterColumnMappingList&&s.state.filterColumnMappingList.length?s.state.filterColumnMappingList:null)||null;s._triggerGridEvent("filterChange",{filterMap:f,filterColumnMappingList:h,filterColumnMapping:m}),s._triggerGridEvent("UIFilterChange",{filterMap:f,filterColumnMappingList:h,filterColumnMapping:m}),s._triggerGridEvent("filterChangeEnd",d())})},kt.prototype._filterCellRender=function(e,t){var a=this,n=e.columnIndex,r=document.createElement("div");if(r.className="cell filtercell"+(n===a.state.maxColumnIndex?" lastcell":""),a.state.forceRenderAll||r.setAttribute("data-alopexgrid-columnindex",n),e.key&&e.filter!==!1){var o=e.filterOption,l=document.createElement("div");if(l.className="filter-cell-unit",l.innerHTML=a._drawFilterUnit(o,n),a.state.forceRenderAll||l.setAttribute("data-alopexgrid-columnindex",n),t)return l;r.appendChild(l)}return r},kt.prototype._hasFooter=function(){var e=this,t=e.option;return!!(t.footer&&t.footer.footerMapping&&t.footer.footerMapping.length)&&t.footer.useFooter!==!1};var Nt={sum:function(e){for(var t=this,a=pe(t,e),n=0,r=0,o=t.option.footer&&t.option.footer.usePageData?t.state.renderTargetDataList:t.state.data,l=0,i=o.length;l<i;l++){var d=o[l];if(!t.state.filteredDataList||d._state.filtered){var s=d[a];isNaN(Number(s))||(n+=Number(s),r=g(r,(String(s).split(".")[1]||"").length))}}return kt.renderUtil.addCommas(parseFloat(n).toFixed(r))},average:function(e){for(var t=this,a=pe(t,e),n=0,r=0,o=t.option.footer&&t.option.footer.usePageData?t.state.renderTargetDataList:t.state.data,l=0,i=o.length;l<i;l++){var d=o[l];if(!t.state.filteredDataList||d._state.filtered){var s=d[a];isNaN(Number(s))||(n+=Number(s),r++)}}return kt.renderUtil.addCommas(r?Math.round(n/r*10)/10:0)},stdev:function(e){for(var t=this,a=pe(t,e),n=0,r=0,o=0,l=t.option.footer&&t.option.footer.usePageData?t.state.renderTargetDataList:t.state.data,i=0,d=l.length;i<d;i++){var s=l[i];if(!t.state.filteredDataList||s._state.filtered){var p=s[a];isNaN(Number(p))||(r+=Number(p),n+=Number(p)*Number(p),o++)}}var u=o?Math.round(10*Math.sqrt(n/o-r/o*(r/o)))/10:0;return kt.renderUtil.addCommas(u)},count:function(e){for(var t=this,a=pe(t,e),n=0,r=t.option.footer&&t.option.footer.usePageData?t.state.renderTargetDataList:t.state.data,o=0,l=r.length;o<l;o++){var i=r[o];if(!t.state.filteredDataList||i._state.filtered){var d=i[a];u(d)&&d&&n++}}return kt.renderUtil.addCommas(n)},countif:function(e,t){for(var a=this,n=pe(a,e),r=0,o=a.option.footer&&a.option.footer.usePageData?a.state.renderTargetDataList:a.state.data,l=0,i=o.length;l<i;l++){var d=o[l];if(!a.state.filteredDataList||d._state.filtered){var s=d[n];void 0!==s&&null!==s&&s===t&&r++}}return kt.renderUtil.addCommas(r)},min:function(e){for(var t=this,a=pe(t,e),n=void 0,r=t.option.footer&&t.option.footer.usePageData?t.state.renderTargetDataList:t.state.data,o=0,l=r.length;o<l;o++){var i=r[o];if(!t.state.filteredDataList||i._state.filtered){var d=i[a];(void 0===n||Number(d)<Number(n))&&(n=Number(d))}}return(isNaN(n)||void 0===n)&&(n=0),kt.renderUtil.addCommas(n)},max:function(e){for(var t=this,a=pe(t,e),n=0,r=t.option.footer&&t.option.footer.usePageData?t.state.renderTargetDataList:t.state.data,o=0,l=r.length;o<l;o++){var i=r[o];if(!t.state.filteredDataList||i._state.filtered){var d=i[a];Number(d)>Number(n)&&(n=Number(d))}}return kt.renderUtil.addCommas(n)},getValue:function(e){var t=this,a=t.state.footerData[e];return u(a)?a:""}};kt.prototype._footerValueByMapping=function(e){if("string"==typeof e.title)return e.title;var t=this,a=[];if(e.render){var n=e.render,r=typeof n;"string"!==r&&"function"!==r||(n=[n]);for(var o=0,l=n.length;o<l;o++){var i=n[o];if(s(i))a.push(i.call(t,t.option.footer&&t.option.footer.usePageData?t.state.renderTargetDataList:t.state.data));else{var d=(i.match(/((^\w+)[(].+[)])/i)||[null]).pop(),p=(i.match(/[^(]*\(([^)]*)\)/)||["",null])[1],u=p?p.match(/(".*?"|[^",\s]+)(?=\s*,|\s*$)/g):null;d?s(Nt[d])&&a.push(Nt[d].apply(t,u)):a.push(i)}}}var c=a.join("");return e.key&&(t.state.footerData[e.key]=c),c&&c.length?c:"&nbsp;"},kt.prototype._footerData=function(e,t){null==t?delete this.state.footerData[e]:this.state.footerData[e]=t},kt.prototype._refreshFooterMappedKey=function(e){var t=this;if(t.option.footer&&t.option.footer.footerMapping)for(var a=0,n=t.option.footer.footerMapping.length;a<n;a++)t.option.footer.footerMapping[a].key!==e&&0!==arguments.length||t._footerValueByMapping(t.option.footer.footerMapping[a])},kt.prototype.footerData=function(){var t=this,a=e.makeArray(arguments),n=!1;if(d(a[0]))for(var r in a[0])a[0].hasOwnProperty(r)&&(t._footerData(r,a[0][r]),n=!0);else if("string"==typeof a[0]){var o=a[0],l=a[1];if(a.length<2)return t._refreshFooterMappedKey(o),l=t.state.footerData[o],u(l)?l:null;t._footerData(o,l),n=!0}if(n&&t._refreshBoard(!0),!a.length)return t._refreshFooterMappedKey(),t.state.footerData},kt.prototype.sortClear=function(e){var t=this;t.state.sortingInfo&&t.state.sortingInfo.length&&(t.$wrapper.find(".headercell.sorting").removeClass("asc desc").find(".sorting-handle").empty(),t.state.sortingInfo=[],e&&e.noEventTriggering||t._triggerGridEvent("sortClear",{pageinfo:t.pageInfo()}))},kt.prototype._noData=function(){return!this.state.data||!this.state.data.length},kt.prototype._sortInternalData=function(){var t=this,a=this.option;this.state.data=this.state.data||[];var n=this.state.data,r=[],l=!1,i=!1,d=[],p=0;t.state.groupRowspanned=!1,t.state.columnRowspanned=!1,delete t.state.columnRowspanIndex,t.state.columnRowspanIndex=null;for(var u=0,c=a.columnMapping.length;u<c;u++){var g=a.columnMapping[u];null!=g&&(!isNaN(Number(g.columnIndex))&&g.key&&p++,g.sorting&&r.push(g),g.rowspan&&(i=!0),g.rowspan!==!0&&"always"!==g.rowspan||d.push(g))}if(t.state.sortingInfo&&t.state.sortingInfo.length)for(var u=0,c=t.state.sortingInfo.length;u<c;u++)t.state.sortingInfo[u].sortedOrder=u+1;var f=!1;t.state.sortingInfoKeyMap={};var h=!(!t.state.dynamicBinding||t.option.clientSortingOnDynamicDataSet);if(t.state.sortingInfo&&t.state.sortingInfo.length&&!h){for(var m={},v=function(e){return"number"==typeof e?e:parseFloat(String(e).replace(",",""))},u=0,c=t.state.sortingInfo.length;u<c;u++){var g=t.state.columnMappingMapById[t.state.sortingInfo[u].mappingId];null!=g&&(t.state.sortingInfoKeyMap[g.key]=t.state.sortingInfo[u])}if(t.option.autoSortingType)for(var x=0,y=r.length;x<y;x++){var C=!1;if(r[x].sorting===!0)for(var u=0,c=Math.min(n.length,50);u<c;u++){var I=n[u][r[x].key];if(I){if(!e.isNumeric(I)){C=!1;break}C=!0}else 0===I&&(C=!0)}else"number"===r[x].sorting&&(C=!0);C?m[r[x].columnIndex]=v:m[r[x].columnIndex]=String}else for(var x=0,y=r.length;x<y;x++)"number"===r[x].sorting?m[r[x].columnIndex]=v:m[r[x].columnIndex]=String;for(var _={},u=0,c=t.state.sortingInfo.length;u<c;u++){var g=t.state.columnMappingMapById[t.state.sortingInfo[u].mappingId];g&&s(g.sorting)&&(_[u]=!0)}var w=0;"bottom"===t.option.sortingNullNumberPosition?w=-1:"top"===t.option.sortingNullNumberPosition&&(w=1);var b=0;"bottom"===t.option.sortingNullStringPosition?b=-1:"top"===t.option.sortingNullStringPosition&&(b=1),t.state.sortingCompareFunction=function(e,a){for(var n=0,r=t.state.sortingInfo.length;n<r;n++){var o=t.state.columnMappingMapById[t.state.sortingInfo[n].mappingId];if(o){o.sorting||(f=!0);var l=t.state.sortingInfo[n].sortingDirection||"asc",i="asc"===l?1:-1,d=o.key;if(_[n])return o.sorting.call(t,e[d],a[d],e,a)*i||e._index.data-a._index.data||0;var s=(m[o.columnIndex]||String)(e[d]),p=(m[o.columnIndex]||String)(a[d]);if(m[o.columnIndex]===v?((null==e[d]||isNaN(s))&&(s=Number.NEGATIVE_INFINITY,i=w||i),(null==a[d]||isNaN(p))&&(p=Number.NEGATIVE_INFINITY,i=w||i)):m[o.columnIndex]===String&&(null!=e[d]&&""!=e[d]||(s="",i=b||i,""==a[d]&&(i=-1*i)),null!=a[d]&&""!=a[d]||(p="",i=b||i)),s<p)return-1*i;if(s>p)return 1*i}}return e._index.data-a._index.data||0},n.sort(t.state.sortingCompareFunction),l=!0}else t.state.sortingCompareFunction=null;if(f&&t.sortClear({noEventTriggering:!0}),t.option.tree&&t.option.tree.useTree){if(t.option.tree.idKey&&t.option.tree.parentIdKey){for(var M={},S={},E={},T="number"===t.option.tree.depthValueType?0:"",u=0,c=n.length;u<c;u++){var D=n[u];D._index.data=u,t._setExpandedTreeNodeState(D),M[D[t.option.tree.idKey]]=D._index.id,S[D[t.option.tree.parentIdKey]]=S[D[t.option.tree.parentIdKey]]||[],S[D[t.option.tree.parentIdKey]].push(D[t.option.tree.idKey])}var R=[];for(var F in S)M[F]||(R=R.concat(S[F]),delete S[F]);for(var F in S)fe(F,S,E);t.state.treeInfo={},t.state.treeInfo.idValueToDataIdMap=M,t.state.treeInfo.childCountByIdValueMap=S,t.state.treeInfo.depthByIdValueMap=E,t.state.treeInfo.rootChildIdValueList=R;var L=t.state.treeOption.depthStartValue;if(t.option.disableTreeEdit)for(var u=0,c=n.length;u<c;u++){var D=n[u];D._index.parentid=M[D[t.option.tree.parentIdKey]]||null,D._state.treeNodeDepth=(E[D[t.option.tree.idKey]]||0)+L,D._state.treeNodeLeaf=!S[D[t.option.tree.idKey]]}else for(var u=0,c=n.length;u<c;u++){var D=n[u];D._index.parentid=M[D[t.option.tree.parentIdKey]]||null;var A=((E[D[t.option.tree.idKey]]||0)+L,!S[D[t.option.tree.idKey]],t.state.treeOption.leafValue[S[D[t.option.tree.idKey]]?1:0]),O=(E[D[t.option.tree.idKey]]||0)+L+T;if(D._state.treeNodeDepth=(E[D[t.option.tree.idKey]]||0)+L,D._state.treeNodeLeaf=!S[D[t.option.tree.idKey]],(t.option.tree.leafKey||t.option.tree.depthKey)&&(t.option.tree.leafKey&&D[t.option.tree.leafKey]!==A||t.option.tree.depthKey&&D[t.option.tree.depthKey]!==O)){var P={};t.option.tree.leafKey&&(P[t.option.tree.leafKey]=A),t.option.tree.depthKey&&(P[t.option.tree.depthKey]=O),t._dataEdit(D,P)}}}else t.option.tree.leftKey&&t.option.tree.rightKey;n.sort(function(e,a){var n=e._state.treeNodeDepth,r=a._state.treeNodeDepth,o=parseInt(n),l=parseInt(r),i=e,d=a;if(o<l)for(;d._index.parentid&&(d=t._dataGetByIndex({id:d._index.parentid}));){if(d[t.option.tree.idKey]===e[t.option.tree.idKey])return-1;if(d._state.treeNodeDepth===o)break}else if(l<o)for(;i._index.parentid&&(i=t._dataGetByIndex({id:i._index.parentid}));){if(i[t.option.tree.idKey]===a[t.option.tree.idKey])return 1;if(i._state.treeNodeDepth===l)break}for(;d[t.option.tree.parentIdKey]!==i[t.option.tree.parentIdKey];){var s=t._dataGetByIndex({id:i._index.parentid}),p=t._dataGetByIndex({id:d._index.parentid});if(!s||!p)break;i=s,d=p}return i._index.data-d._index.data})}else delete t.state.treeInfo;if(t.option.grouping&&t.option.grouping.by&&t.option.grouping.by.length&&t.option.grouping.useGrouping){var B=t.option.grouping.by;B=e.isArray(B)?B:[B],B[0]===!0&&(B=B.slice(1));for(var G={},H={},N={},$=0;$<B.length;$++){var W=B[$],K=N[W]={};G[W]=parseInt($);for(var U=0,Y=[],V=0,X=n.length;V<X;V++){var I=n[V][W];void 0===K[I]&&(K[I]=U++,void 0!==I&&Y.push(I))}H[W]=Y}var z=B.length;t.option.grouping.useGroupRearrange&&n.sort(function(e,t){for(var a=0;a<z;a++){var n=B[a],r=e[n],o=t[n],l=N[n][r],i=N[n][o];if(l<i)return-1;if(l>i)return 1}return e._index.data-t._index.data}),t.state.groupRowspanned=!!t.option.grouping.useGroupRowspan,t.state.groupingLookupTable={},t.state.groupingLookupTableMapById={},t.state.groupOccurrenceMap=H,t.state.groupOccurrenceOrder=N,t.state.groupKeyOrderMap=G;var j=null;if(t.state.topmostGroupRowspanKey=null,t.option.grouping.useGroupRowspan){for(var u=0,c=t.option.grouping.by.length;u<c;u++){var q=t.option.grouping.by[u];if(null!=t.state.visibleIndexMapByKey[q]){var g=t.state.columnKeyToMapping[q];if(g&&g.rowspan===!0){t.state.topmostGroupRowspanKey=q,j=u;break}}}for(var u=0,c=t.state.visibleColumnMappingList.length;u<c;u++){var g=t.state.visibleColumnMappingList[u];if(g.rowspan&&null!=g.rowspan.by){var q=g.rowspan.by,Z=G[q];null!=Z&&(Z<j||null==j)&&(t.state.topmostGroupRowspanKey=q,j=Z)}}}delete t.state.groupHeaderDataMapById,delete t.state.groupFooterDataMapById;for(var Q=B.length,J=t.state.groupingLookupTable,ee=[],u=0;u<Q;u++)J[B[u]]=[];for(var u=0,c=n.length;u<c;u++){for(var D=n[u],te=n[u+1],ae=[],ne=[],V=0;V<Q;V++){var q=B[V];ae.push(q===!0?void 0:D[q]),ne.push(te?te[q]:null),ee[V]||(ee[V]={id:o(),from:u,groupKey:q,groupDepth:V,value:D[q],member:[],memberIdMap:{}},t.state.groupingLookupTableMapById[ee[V].id]=ee[V]),J[q][u]=ee[V]}for(var V=Q-1;V>=0;V--){var re=!1;for(k=V;k>=0;k--)if(ae[k]!==ne[k]){re=!0;break}u===(t.state.pinnedDataIdList||[]).length-1&&(re=!0),ee[V].member.push(D),ee[V].memberIdMap[D._index.id]=D,re&&(ee[V].to=u,ee[V]=null)}}}else t.state.groupRowspanned=!1,t.state.groupingLookupTable=null,t.state.groupingLookupTableMapById=null,t.state.groupOccurrenceMap=null,t.state.groupOccurrenceOrder=null,t.state.topmostGroupRowspanKey=null,t.state.groupKeyOrderMap=null;for(var u=n.length;u>=0;u--)n[u]||n.splice(u,1);if(t._generateDataIndex(n),t._hasPinnedData()&&t.state.pinnedDataIdList.sort(function(e,a){return t.state.dataIdToIndexMap[e]-t.state.dataIdToIndexMap[a]||0}),t.option.grouping&&t.option.grouping.useGrouping&&t.option.grouping.by);else if(i&&t.option.useColumnRowspan){for(var oe=[],u=0;u<p;u++)oe.push(void 0);var le=1;e.each(d,function(e,t){var a=0,r=n.length;oe[Number(t.columnIndex)]=[];for(var o=oe[Number(t.columnIndex)],l=[];a<r;){for(var i=a,d=a+1;d<r&&n[i][t.key]===n[d][t.key];)d++;for(var s={from:i,to:d,index:le++},p=i;p<d;p++)l[p]=s;o.push(s),a=d}o.push(l)});for(var u=0,c=a.columnMapping.length;u<c;u++){var g=a.columnMapping[u];if(g.rowspan&&"number"==typeof g.rowspan.by)if(g.rowspan.under){var ie=oe[g.rowspan.by];ie=ie[ie.length-1];var de=0,se=n.length;oe[Number(g.columnIndex)]=[];for(var pe=oe[Number(g.columnIndex)],ue=[];de<se;){for(var ce=de,ge=de+1;ge<se&&n[ce][g.key]===n[ge][g.key]&&!(ge+1>ie[ce].to);)ge++;for(var he={from:ce,to:ge,index:le++},u=ce;u<ge;u++)ue[u]=he;pe.push(he),de=ge}pe.push(ue)}else oe[g.columnIndex]=oe[g.rowspan.by]}delete this.state.columnRowspanIndex;for(var me=!1,u=0,c=oe.length;u<c;u++)oe[u]&&(me=!0);me?(this.state.columnRowspanIndex=oe,this.state.columnRowspanned=!0):(this.state.columnRowspanIndex=void 0,this.state.columnRowspanned=!1)}else this.state.columnRowspanIndex=void 0,this.state.columnRowspanned=!1;return this.state.sortingRequired=!1,l},kt.prototype._dataMoveByDataindex=function(e,t){if(this.state.data&&this.state.data.length){var a=this.state.data;a.splice(t+(t>e?-1:0),0,a.splice(e,1)[0])}},kt.prototype.dataMove=function(e,t,a){var n=this;if(!n._noData()&&!ue(e)&&!ue(t)){var r=n._dataGet(e),o=n._dataGet(t);if(r&&o&&r.length&&o.length&&o[0]&&o[0]._index){var l=o[0]._index.data;if(u(l)){for(var i=he(n,r,!0),d=0;d<n.state.data.length;d++){var s=n.state.data[d];if(s&&s._index&&l<=s._index.data){var p=0;a===!0&&l===s._index.data&&p++,l=d+p;break}}l>=0&&n.state.data.splice.apply(n.state.data,[l,0].concat(i)),n.sortClear(),n.calcAndRedraw()}}}},kt.prototype._generateXOffsetOnContinuousScroll=function(){var e=this;e.option.useContinuousXScroll&&e.state.refreshbodycell&&(e.state.refreshbodycell.scrollEndXOffset=-Math.abs((e.state.translateX-e._generateTranslatex(e.state.renderFromColumnIndex)*e.state.scrollxRatio)/e.state.scrollxRatio))},kt.prototype._generateYOffsetOnContinuousScroll=function(){var e=this;if(e.option.useContinuousYScroll&&e.state.refreshbodycell){var t=e.__getRowHeightByRenderedIdx(e.state.renderFromRenderedIndex);e.state.refreshbodycell.scrollEndYOffset=-Math.abs((e.state.translateY-t*e.state.scrollyRatio)/e.state.scrollyRatio)}},kt.prototype.dataScroll=function(t,a,n){function r(e,t,a){var n={left:0,center:50,right:100,middle:50};a&&(n={top:0,middle:50,bottom:100});var r=null;return n.hasOwnProperty(t)?r=n[t]:"string"==typeof t&&t.indexOf("%")>=0?r=Number(t.split("%")[0]):isNaN(Number(t))||(r=Number(t)),r}function o(e,t,a,n){var r=e.state.fixedColumnMapping.length;e.state.scrollxEnd=!1;var o=0,l=0;if("string"==typeof n)"left"===n?(l=0,e.state.renderFromColumnIndex=e.state.visibleColumnIndexArr[0]):"center"===n?(l=.5*(e.state.scrollbarxTrackLength-e.state.scrollbarxWidth),e.state.renderFromColumnIndex=e._getColumnIndexByBlankWidth(l)):"right"===n&&(e.state.scrollxEnd=!0,l=e.state.scrollbarxTrackLength-e.state.scrollbarxWidth,e.state.renderFromColumnIndex=e._getColumnIndexByBlankWidth(l));else if(100===a||50===a){for(var i=e.state.wrapperWidth*(a/100),d=r>0?e.state.fixedColumnWidth:0,s=t;s>=0;s--)if(null!=e.state.columnWidthMap[s]&&(e.state.renderFromColumnIndex=s,d+=e.state.columnWidthMap[s],d>i)){100===a&&(e.state.renderFromColumnIndex=s+1);break}r>0&&(e.state.renderFromColumnIndex=e.state.renderFromColumnIndex-r),l=e._generateTranslatex(e.state.renderFromColumnIndex)*e.state.scrollxRatio,l>=e.state.scrollbarxTrackLength-e.state.scrollbarxWidth&&(e.state.scrollxEnd=!0,l=e.state.scrollbarxTrackLength-e.state.scrollbarxWidth,e.state.renderFromColumnIndex=e._getColumnIndexByBlankWidth(l))}else e.state.renderFromColumnIndex=Math.max(0,e.state.columnIndexArr[e._columnIndexOrder(t)-r]),l=e._generateTranslatex(o)*e.state.scrollxRatio,l>=e.state.scrollbarxTrackLength-e.state.scrollbarxWidth&&(e.state.scrollxEnd=!0,l=e.state.scrollbarxTrackLength-e.state.scrollbarxWidth,e.state.renderFromColumnIndex=e._getColumnIndexByBlankWidth(l));e.state.translateX=l,e.option.useContinuousXScroll&&e._generateXOffsetOnContinuousScroll()}function l(e,t,a,n){var r=e.option.rowFixCount;e.state.scrollyEnd=!1;var o=0;if(e.state.refreshbodycell.scrollEndYOffset=0,"string"==typeof n){if("top"===n)o=0,e.state.renderFromRenderedIndex=0,e.state.scrollyEnd=!1;else if("middle"===n)o=.5*(e.state.scrollbaryTrackLength-e.state.scrollbaryHeight),e.state.renderFromRenderedIndex=e.__getRenderedIndexByBlankHeight(o);else if("bottom"===n)e.state.scrollyEnd=!0,o=e.state.scrollbaryTrackLength-e.state.scrollbaryHeight,e.state.renderFromRenderedIndex=e.__getRenderedIndexByBlankHeight(o);else if(n.indexOf("%")>0){var l=parseInt(n.split("%")[0]);o=(e.state.scrollbaryTrackLength-e.state.scrollbaryHeight)*(l/100),e.state.renderFromRenderedIndex=e.__getRenderedIndexByBlankHeight(o)}}else if(100===a||50===a){var i=Math.ceil(e.state.refreshbodycell.renderedDataList.length*(a/100));e.state.renderFromRenderedIndex=Math.max(0,t-i),100===a&&(e.state.renderFromRenderedIndex+=1);var d=e.__getRowHeightByRenderedIdx(e.state.renderFromRenderedIndex);o=Math.ceil(e.state.scrollyRatio*d*e.state.scrollRatioConst)/e.state.scrollRatioConst,(o>=e.state.scrollbaryTrackLength-e.state.scrollbaryHeight||e.state.pagingInfo.pageRowCount-1===t)&&(e.state.scrollyEnd=!0,o=e.state.scrollbaryTrackLength-e.state.scrollbaryHeight,e.state.renderFromRenderedIndex=e.__getRenderedIndexByBlankHeight(o))}else{e.state.renderFromRenderedIndex=Math.max(0,t-r);var d=e.__getRowHeightByRenderedIdx(e.state.renderFromRenderedIndex);o=Math.ceil(e.state.scrollyRatio*d*e.state.scrollRatioConst)/e.state.scrollRatioConst,o>=e.state.scrollbaryTrackLength-e.state.scrollbaryHeight&&(e.state.scrollyEnd=!0,o=e.state.scrollbaryTrackLength-e.state.scrollbaryHeight,e.state.renderFromRenderedIndex=e.__getRenderedIndexByBlankHeight(o))}e.state.translateY=o,e.option.useContinuousYScroll&&e._generateYOffsetOnContinuousScroll()}var i=this;s(a)&&(n=a,a=null);var p=0,c=0,g=!1,f=!1;if(d(t)&&t._index){var h=t._index.column;if("string"==typeof h?(p=i.state.columnKeyToIndexMap[h],g=!0):e.isNumeric(h)&&(p=parseInt(h),g=!0),c=t._index.row,u(c))f=!0;else{var m=t._index.data;null==m&&t._index.id&&(m=i.state.dataIdToIndexMap[t._index.id]);var v=i.state.data[m];v&&(c=v._index.row,f=!0)}}else if("string"!=typeof t)return;var x=0,y=0;null!=a&&(x=null!=a.scrollX?r(i,a.scrollX):0,y=null!=a.scrollY?r(i,a.scrollY,!0):0),"string"==typeof t&&("left"==t||"right"==t||"center"==t?g=!0:("top"==t||"middle"==t||"bottom"==t||t.indexOf("%")>0)&&(f=!0)),i.state.scrollxMoveable&&g&&o(i,p,x,t),i.state.scrollyMoveable&&f&&l(i,c,y,t),(g||f)&&i.redraw(),s(n)&&setTimeout(function(){n()},10)},kt.prototype._getFilterMapObject=function(){},kt.prototype._getColumnFilterFunction=function(t){if(!t)return null;if(t.filter!==!1&&t.filterOption){if(s(t.filterOption))return t.filterOption;var a,n;if(e.isArray(t.filterOption.type))return a=kt.filterFunction[t.filterOption.type[0]],n=kt.filterFunction[t.filterOption.type[1]],s(a)&&s(n)?ve:null;if(a=kt.filterFunction[t.filterOption.type],s(a))return me}return null},kt.prototype._hasColumnFilter=function(e){return!(!e||e.filter===!1||!e.filterOption)},kt.prototype._setColumnFilter=function(e,t){e.filterOption=t},kt.prototype._removeColumnFilter=function(e){delete e.filterOption},kt.prototype._hasFilterNamed=function(e){var t=this;return t.option.rowOption&&t.option.rowOption.filter&&t.option.rowOption.filter[e]||!1},kt.prototype.setFilter=function(t,a,n){function r(){var e={filterMap:(l.option.rowOption?l.option.rowOption.filter:null)||null,filterColumnMappingList:(l.state.filterColumnMappingList&&l.state.filterColumnMappingList.length?l.state.filterColumnMappingList:null)||null,changeType:p,targetColumnMapping:null,targetColumnFilterOption:null,targetFilterMap:s};return e}var l=this;a||(a=t,t=o());var i=d(t);u(t)||(t=o());var s={};i?e.extend(s,t):s[t]=a;var p="filterSet";if(l._triggerGridEvent("filterChangeStart",r())===!1)return!1;l.option.rowOption=l.option.rowOption||{},l.option.rowOption.filter=e.extend({},l.option.rowOption.filter),i?(n=a,e.each(t,function(e,t){l.option.rowOption.filter[e]=t})):l.option.rowOption.filter[t]=a,n!==!0&&(l.showProgress(),l.calcAndRedraw(),l.hideProgress()),i?e.each(t,function(e,t){l._triggerGridEvent("filterSet",{filterMap:l.option.rowOption.filter,filterName:e,filter:t})}):l._triggerGridEvent("filterSet",{filterMap:l.option.rowOption.filter,filterName:t,filter:a});var c=(l.option.rowOption?l.option.rowOption.filter:null)||null,g=(l.state.filterColumnMappingList&&l.state.filterColumnMappingList.length?l.state.filterColumnMappingList:null)||null;return l._triggerGridEvent("filterChange",{filterMap:c,filterColumnMappingList:g,filterColumnMapping:null}),l._triggerGridEvent("filterChangeEnd",r()),t},kt.prototype.deleteFilter=function(t,a){function n(){var e={filterMap:(r.option.rowOption?r.option.rowOption.filter:null)||null,filterColumnMappingList:(r.state.filterColumnMappingList&&r.state.filterColumnMappingList.length?r.state.filterColumnMappingList:null)||null,changeType:i,targetColumnMapping:null,targetColumnFilterOption:null,targetFilterMap:l};return e}var r=this,o=!1;null==t||e.isArray(t)||(t=[t]);var l={};e.each(t,function(e,t){r.option.rowOption&&r.option.rowOption.filter&&r.option.rowOption.filter[t]&&(l[t]=r.option.rowOption.filter[t])});var i="filterDelete";if(!e.isEmptyObject(l)&&r._triggerGridEvent("filterChangeStart",n())===!1)return!1;if(e.isArray(t)&&t.length&&r.option.rowOption&&r.option.rowOption.filter){for(var d=0,s=t.length;d<s;d++){var p=t[d],u=r.option.rowOption.filter[p];u&&(o=o||{},o[p]=u,delete r.option.rowOption.filter[p])}e.isEmptyObject(r.option.rowOption.filter)&&(delete r.option.rowOption.filter,r.option.rowOption.filter=null)}if(o){a||(r.showProgress(),r.calcAndRedraw(),r.hideProgress()),e.each(o,function(e,t){r._triggerGridEvent("filterDelete",{filterMap:r.option.rowOption.filter||null,filterName:e,filter:t})});var c=(r.option.rowOption?r.option.rowOption.filter:null)||null,g=(r.state.filterColumnMappingList&&r.state.filterColumnMappingList.length?r.state.filterColumnMappingList:null)||null;return r._triggerGridEvent("filterChange",{filterMap:c,filterColumnMappingList:g,filterColumnMapping:null}),r._triggerGridEvent("filterChangeEnd",n()),!0}return!1},kt.prototype.clearFilter=function(e){function t(){var e={filterMap:(a.option.rowOption?a.option.rowOption.filter:null)||null,filterColumnMappingList:(a.state.filterColumnMappingList&&a.state.filterColumnMappingList.length?a.state.filterColumnMappingList:null)||null,changeType:"filterClear",targetColumnMapping:null,targetColumnFilterOption:null,targetFilterMap:null};return e}var a=this,n=!1;if(!(a.option.rowOption&&a.option.rowOption.filter||a.state.filterColumnMappingList&&a.state.filterColumnMappingList.length)||a._triggerGridEvent("filterChangeStart",t())!==!1){if(a.option.rowOption&&a.option.rowOption.filter&&(delete a.option.rowOption.filter,a.option.rowOption.filter=null,n=!0),a.state.filterColumnMappingList&&a.state.filterColumnMappingList.length){n=!0;for(var r=0,o=a.state.filterColumnMappingList.length;r<o;r++){var l=a.state.filterColumnMappingList[r];a._removeColumnFilter(l)}a._generateFilterColumnList()}if(e!==!0&&n&&(a.showProgress(),a.calcAndRedraw(),a.hideProgress()),n){a._triggerGridEvent("filterClear");var i=(a.option.rowOption?a.option.rowOption.filter:null)||null,d=(a.state.filterColumnMappingList&&a.state.filterColumnMappingList.length?a.state.filterColumnMappingList:null)||null;a._triggerGridEvent("filterChange",{filterMap:i,filterColumnMappingList:d,filterColumnMapping:null}),a._triggerGridEvent("filterChangeEnd",t())}}},kt.prototype.startSearch=function(t,a){var n=this;if(null==t)return!1;if("string"!=typeof t&&"number"!=typeof t&&"function"!=typeof t)return!1;n.endSearch();var r=e.extend({},kt.defaultOption.searchOption,n.option.searchOption);if(d(a))for(var o in a)a.hasOwnProperty(o)&&(r[o]=a[o]);var l=r.useFilter===!0,i="cell-search-highlight-row",s="cell-search-highlight-column",p="cell-search-match-row",u="cell-search-match-column",c=r.caseSensitive===!0,g=r.ignoreWhiteSpace===!0,f=r.useRegex===!0,h=r.useRenderToSearch===!0,m=r.byColumn===!0,v="function"==typeof t;v||(t=t.toString());var x=v?"":t.toLowerCase(),y=e.grep(n.state.visibleColumnMappingList,function(e){return h||!e.key&&!e.multi?h?e:void 0:e}),C=y.length,I=[],_=[],w="alopexGridSearch";l&&n._hasFilterNamed(w)&&n.deleteFilter(w);var b=c?t:x;!v&&g&&(b=b.replace(/\s/g,""));for(var M=function(e){for(var a=[],r=0;r<C;r++){var o=y[r];if(o.rowspan){var l=n._getRowspanInfoForCell(e._index.row,o.columnIndex);if(l&&e._index.row!==l.from)continue}if(n.state.hasColspan){var i=n._getColspanInfoForCell(e._index.row,o.columnIndex);if(i&&o.columnIndex!==i.from)continue}var d=e[o.key];h?d=kt.renderUtil.getTextFromElement(n._createCell(e,o)):null==d&&(d="",o.multi&&n._iterateMultiMapping(e,o,function(t,a){a.key&&(d+=e[a.key])})),d=d.toString();var s=!1;v?s=t(d)===!0:(g&&(d=d.replace(/\s/g,"")),f&&d.match(new RegExp(t,"i"))?s=!0:c&&d.indexOf(b)>=0?s=!0:d.toLowerCase().indexOf(b)>=0&&(s=!0)),s&&a.push(o)}return!!a.length&&a},S=0,E=n.state.renderTargetDataList.length;S<E;S++){var T=M(n.state.renderTargetDataList[S]);T!==!1&&(I.push(n.state.renderTargetDataList[S]),_.push(T))}for(var D={},R={},S=0,E=I.length;S<E;S++){var F=I[S],k=_[S];D[F._index.id]=D[F._index.id]||{};for(var L=0,A=k.length;L<A;L++)R[F._index.id]=R[F._index.id]||{},R[F._index.id][k[L].id]=!0}l&&n.setFilter(w,function(e){return!!M(e)}),n.state.searchStatus={},n.state.searchStatus.useFilter=l,n.state.searchStatus.filterName=l?w:null,n.state.searchStatus.highlightRowClassName=i,n.state.searchStatus.highlightColumnClassName=s,n.state.searchStatus.matchRowClassName=p,n.state.searchStatus.matchColumnClassName=u,n.state.searchStatus.keyword=t,n.state.searchStatus.caseSensitive=c,n.state.searchStatus.ignoreWhiteSpace=g,n.state.searchStatus.useRegex=f,n.state.searchStatus.matchDataList=I,n.state.searchStatus.matchMappingList=_,n.state.searchStatus.highlightAtMatchDataList=null,n.state.searchStatus.highlightAtMatchMappingList=null,n.state.searchStatus.byColumn=m,n.state.searchStatus.option=r,n.state.searchStatus.userOption=a,n.state.searchStatus.matchCount=n._getFocusableSearchMatchCount(),n.state.searchStatus.highlightPointer=null,n.state.searchStatus.accumulatedMappingCountList=null,n.state.searchStatus.matchDataIdMap=D,n.state.searchStatus.matchMappingIdMapByDataId=R,n._refreshBoard(!0),n.searchNext();var O=n.searchInfo();return n._triggerGridEvent("searchStart",O),O},kt.prototype.endSearch=function(){var e=this;return!!e.state.searchStatus&&(e._removeSearchRowHighlight(),e.state.searchStatus.filterName&&e._hasFilterNamed(e.state.searchStatus.filterName)&&e.deleteFilter(e.state.searchStatus.filterName),e.state.searchStatus=null,e._refreshBoard(!0),e._triggerGridEvent("searchEnd"),!0)},kt.prototype.searchInfo=function(){var e=this;return e.state.searchStatus?{keyword:e.state.searchStatus.keyword,matchCount:e.state.searchStatus.matchCount,highlightPointer:e._getSearchHighlightPointer(),highlightAtMatchDataList:e.state.searchStatus.highlightAtMatchDataList,highlightAtMatchMappingList:e.state.searchStatus.highlightAtMatchMappingList,matchDataList:e.state.searchStatus.matchDataList,matchMappingList:e.state.searchStatus.matchMappingList,highlightedData:e._getSearchFocusedData(),highlightedMappingList:e._getSearchFocusedMappingList(),byColumn:e.state.searchStatus.byColumn,useFilter:e.state.searchStatus.useFilter,useRegex:e.state.searchStatus.useRegex,caseSensitive:e.state.searchStatus.caseSensitive,ignoreWhiteSpace:e.state.searchStatus.ignoreWhiteSpace,timeStamp:(new Date).getTime()}:null},kt.prototype._highlightAtSearchFocus=function(e,t,a){var n=this;if(!n.state.searchStatus)return!1;if(!e)return!1;var r=n._dataGetByIndex(e._index);if(Qe(n,r._index.row,t[0].columnIndex),n._removeSearchRowHighlight(),n.rowElementGet(e,Ht.cache).addClass(n.state.searchStatus.highlightRowClassName),t&&t.length)for(var o=0,l=t.length;o<l;o++){var i=t[o],d=n._cellElementGet(r,i);d&&kt.renderUtil.addClass(d,n.state.searchStatus.highlightColumnClassName)}},kt.prototype._getSearchHighlightClassName=function(e,t){var a=this;if(!a.state.searchStatus||!e||!t)return"";var n=[],r=a._getSearchFocusedData(),o=a._getSearchFocusedMappingList();if(e&&r&&e._index.id===r._index.id){n.push(a.state.searchStatus.highlightRowClassName);for(var l=0,i=o.length;l<i;l++)if(o[l]&&t.id===o[l].id){n.push(a.state.searchStatus.highlightColumnClassName);break}}if(e&&a.state.searchStatus.matchDataIdMap&&a.state.searchStatus.matchDataIdMap[e._index.id]){n.push(a.state.searchStatus.matchRowClassName);var d=null;a.state.searchStatus.matchMappingIdMapByDataId&&(d=a.state.searchStatus.matchMappingIdMapByDataId[e._index.id])&&d[t.id]&&n.push(a.state.searchStatus.matchColumnClassName)}return n.join(" ")},kt.prototype._removeSearchRowHighlight=function(){var e=this;if(!e.state.searchStatus)return!1;if(It)e.$wrapper.find("."+e.state.searchStatus.highlightRowClassName+",."+e.state.searchStatus.highlightColumnClassName).removeClass(e.state.searchStatus.highlightRowClassName);else{for(var t=e.$wrapper[0].getElementsByClassName(e.state.searchStatus.highlightRowClassName);t.length;)kt.renderUtil.removeClass(t[0],e.state.searchStatus.highlightRowClassName);for(t=e.$wrapper[0].getElementsByClassName(e.state.searchStatus.highlightColumnClassName);t.length;)kt.renderUtil.removeClass(t[0],e.state.searchStatus.highlightColumnClassName)}},kt.prototype._getSearchFocusedData=function(){var e=this;return e.state.searchStatus?e.state.searchStatus.matchDataList[e.state.searchStatus.highlightAtMatchDataList]||null:null;
},kt.prototype._getSearchFocusedMappingList=function(){var e=this;if(!e.state.searchStatus)return null;var t=e._getMatchMappingListOfSearchFocusedData();if(null==e.state.searchStatus.highlightAtMatchMappingList)return t;var a=null;return t&&t.length&&(a=t[e.state.searchStatus.highlightAtMatchMappingList]),a?[a]:null},kt.prototype._getFocusableSearchMatchCount=function(){var e=this;if(!e.state.searchStatus)return 0;if(e.state.searchStatus.byColumn){for(var t=0,a=0,n=e.state.searchStatus.matchDataList.length;a<n;a++){var r=(e.state.searchStatus.matchDataList[a],e.state.searchStatus.matchMappingList[a]);t+=r.length}return t}return e.state.searchStatus.matchDataList.length},kt.prototype._getSearchHighlightPointer=function(){var e=this;if(!e.state.searchStatus)return null;if(e.state.searchStatus.byColumn){if(!e.state.searchStatus.accumulatedMappingCountList){e.state.searchStatus.accumulatedMappingCountList=[];for(var t=0,a=0,n=e.state.searchStatus.matchDataList.length;a<n;a++){e.state.searchStatus.accumulatedMappingCountList[a]=t;var r=e.state.searchStatus.matchMappingList[a];r&&r.length&&(t+=r.length)}}var o=e.state.searchStatus.accumulatedMappingCountList[e.state.searchStatus.highlightAtMatchDataList]||0;return o+=e.state.searchStatus.highlightAtMatchMappingList||0}return e.state.searchStatus.highlightAtMatchDataList},kt.prototype._getMatchMappingListOfSearchFocusedData=function(){var e=this;return e.state.searchStatus?null==e.state.searchStatus.highlightAtMatchDataList?null:e.state.searchStatus.matchMappingList[e.state.searchStatus.highlightAtMatchDataList]||null:null},kt.prototype._highlightCurrentSearchFocus=function(){var e=this;if(!e.state.searchStatus)return!1;var t=e._getSearchFocusedData();t&&e._highlightAtSearchFocus(t,e._getSearchFocusedMappingList(),e.state.searchStatus.byColumn)},kt.prototype._setSearchHighlightAtStart=function(){var e=this;return!!e.state.searchStatus&&void(e.state.searchStatus.highlightAtMatchDataList=0)},kt.prototype._setSearchHighlightAtMappingStart=function(){var e=this;return!!e.state.searchStatus&&void(e.state.searchStatus.highlightAtMatchMappingList=0)},kt.prototype._setSearchHighlightAtEnd=function(){var e=this;return!!e.state.searchStatus&&void(e.state.searchStatus.highlightAtMatchDataList=e.state.searchStatus.matchDataList.length-1)},kt.prototype._setSearchHighlightAtMappingEnd=function(){var e=this;if(!e.state.searchStatus)return!1;var t=e.state.searchStatus.matchMappingList[e.state.searchStatus.highlightAtMatchDataList];e.state.searchStatus.highlightAtMatchMappingList=t.length-1},kt.prototype._increaseSearchHighlightAt=function(){var e=this;if(!e.state.searchStatus)return!1;e.state.searchStatus.highlightAtMatchDataList;return e.state.searchStatus.highlightAtMatchDataList++,e.state.searchStatus.highlightAtMatchDataList>=e.state.searchStatus.matchDataList.length&&e._setSearchHighlightAtStart(),!0},kt.prototype._getCurrentSearchHighlightData=function(){var e=this;return e.state.searchStatus?e.state.searchStatus.matchDataList[e.state.searchStatus.highlightAtMatchDataList]||null:null},kt.prototype._increaseSearchHighlightAtMapping=function(){var e=this;if(!e.state.searchStatus)return!1;var t=e.state.searchStatus.matchMappingList[e.state.searchStatus.highlightAtMatchDataList];e.state.searchStatus.highlightAtMatchMappingList++,e.state.searchStatus.highlightAtMatchMappingList>=t.length&&(e._increaseSearchHighlightAt(),e._setSearchHighlightAtMappingStart())},kt.prototype._decreseSearchHighlightAt=function(){var e=this;if(!e.state.searchStatus)return!1;e.state.searchStatus.highlightAtMatchDataList;return e.state.searchStatus.highlightAtMatchDataList--,e.state.searchStatus.highlightAtMatchDataList<0&&e._setSearchHighlightAtEnd(),!0},kt.prototype._decreseSearchHighlightAtMapping=function(){var e=this;return!!e.state.searchStatus&&(e.state.searchStatus.highlightAtMatchMappingList--,void(e.state.searchStatus.highlightAtMatchMappingList<0&&(e._decreseSearchHighlightAt(),e._setSearchHighlightAtMappingEnd())))},kt.prototype.searchNext=function(){var e=this;if(!e.state.searchStatus)return!1;var t=e.state.searchStatus.byColumn;null==e.state.searchStatus.highlightAtMatchDataList?(e._setSearchHighlightAtStart(),t&&e._setSearchHighlightAtMappingStart()):t?e._increaseSearchHighlightAtMapping():e._increaseSearchHighlightAt(),e._highlightCurrentSearchFocus();var a=e.searchInfo();return e._triggerGridEvent("searchNext",a),e._triggerGridEvent("searchHighlighted",a),a},kt.prototype.searchPrevious=function(){var e=this;if(!e.state.searchStatus)return!1;var t=e.state.searchStatus.byColumn;null==e.state.searchStatus.highlightAtMatchDataList?(e._setSearchHighlightAtEnd(),t&&e._setSearchHighlightAtMappingEnd()):t?e._decreseSearchHighlightAtMapping():e._decreseSearchHighlightAt(),e._highlightCurrentSearchFocus();var a=e.searchInfo();return e._triggerGridEvent("searchPrevious",a),e._triggerGridEvent("searchHighlighted",a),a},kt.prototype._hasHiddenColumnBetween=function(t,a,n){for(var r=this,o=0,l=r.option.columnMapping.length;o<l;o++){var i=r.option.columnMapping[o],d=i.columnIndex;if(!(n&&n.length>0&&e.inArray(d,n)>=0)&&!i.columnFoldingColumn&&i.hidden&&"number"==typeof d&&t<=d&&d<=a)return!0}return!1},kt.prototype._hideAllColumnBetween=function(t,a,n,r){for(var o=this,l=0,i=o.option.columnMapping.length;l<i;l++){var d=o.option.columnMapping[l],s=d.columnIndex;n&&n.length>0&&e.inArray(s,n)>=0||d.columnFoldingColumn||"number"==typeof s&&t<=s&&s<=a&&(d.hidden=r)}},kt.prototype._showAllColumnBetween=function(t,a,n){for(var r=this,o=0,l=r.option.columnMapping.length;o<l;o++){var i=r.option.columnMapping[o],d=i.columnIndex;n&&n.length>0&&e.inArray(d,n)>=0||i.columnFoldingColumn||"number"==typeof d&&t<=d&&d<=a&&(i.hidden=!1)}},kt.prototype._toggleColumnFold=function(e,t,a,n,r,o){var l=this,i=a&&"object"==typeof a?a:l.state.columnIndexToMapping[a],d=l._hasHiddenColumnBetween(e,t,n);i&&(i.columnFolded=!d),d?l._showAllColumnBetween(e,t,n):l._hideAllColumnBetween(e,t,n,r),o!==!0&&(l.updateOption(),ke(l),l.redraw())},kt.prototype._generateDataIndex=function(e){var t=this,a=e||t.state.data;delete t.state.dataIdToIndexMap,t.state.dataIdToIndexMap={};for(var n=0,r=a.length;n<r;n++){var o=a[n];o._index.data=n,t.state.dataIdToIndexMap[o._index.id]=n}},kt.prototype._getDataFromEvent=function(t){var a=e(t.target).closest(".bodycell");return a.length?this._getRenderedDataFromRenderedIndex(parseInt(a.attr("data-alopexgrid-rowindex"))):null},kt.prototype._getCellFromEvent=function(t){return e(t.target).closest(".cell")},kt.prototype._getRenderedDataFromRenderedIndex=function(e){var t=this;return t.state.renderTargetDataList[e]||null},kt.prototype.headerGroupInfo=function(e){var t=this;return t.state.headerGroupByKey[e]||t.state.headerGroupById[e]||null},kt.prototype.headerGroupGet=function(){var t=this,a=t.state.headerGroupArr;if(!arguments.length||!arguments[0])return[].concat(t.state.headerGroupArr);for(var n=e.makeArray(arguments),r=[],o=0;o<a.length;o++){var l=a[o],i=!1;e.each(n,function(e,t){if(d(t)){var a=!0;for(var n in t)t[n]!==l[n]&&(a=!1);a&&(i=!0)}}),i&&r.push(l)}return r},kt.prototype.columnInfo=function(e){var t=this,a=t.state.columnIndexToMapping[e]||t._getColumnByKey(e);return!a&&t.state.multiColumnList.length&&"string"==typeof e&&e.indexOf("m")>=0&&(a=t._columnIndexKeyToMappingList(e)[0]),a||null},kt.prototype.columnGet=function(){for(var t=this,a=t.option.columnMapping,n=e.makeArray(arguments),r=[],o=0;o<a.length;o++){var l=a[o],i=Number(l.columnIndex),s=!1;e.each(n,function(e,t){if(d(t)){var n=!0;for(var r in t)"columnIndex"===r?i!==t[r]&&(n=!1):"hidden"===r?ye(a,i)!==t[r]&&(n=!1):t[r]!==l[r]&&(n=!1);n&&(s=!0)}}),s&&r.push(l)}return r},kt.prototype.isColumnHidden=function(e){var t=this,a=t.option,n=a.columnMapping;return ye(n,e)},kt.prototype.hideCol=function(e,t,a){var n=this;return null==t&&(t=!0),n.showCol(e,t,a)},kt.prototype.showCol=function(t,a,n){var r=this;r.state.showColCalled=!0;var o=r.option,l=o.columnMapping;if(t===!0){for(var i=0;i<l.length;i++){var d=l[i];a?r.hideCol(d.key,a,!0):r.showCol(d.key,a,!0)}return r.updateOption(),ke(r),void(r.state.showColCalled=!1)}"string"==typeof t?t=t.split(","):e.isArray(t)||(t=[t]);for(var s=!1,i=0;i<l.length;i++){var d=l[i];if(u(d.columnIndex)&&(e.inArray(d.columnIndex,t)>=0||e.inArray(d.key,t)>=0)&&(d.hidden=a||!1,a&&"conceal"!==a&&r.state.sortingInfo&&r.state.sortingInfo.length))for(var p=r.state.sortingInfo.length-1;p>=0;p--)if(r.state.sortingInfo[p].mappingId===d.id){s=!0;break}}n!==!0&&(s&&r.sortClear(),r.updateOption(),ke(r),r.state.showColCalled=!1)},kt.prototype._filterValueByValueFilter=function(e,t){if(e&&"function"==typeof this.option.valueFilter){var a=this.option.valueFilter.call(this,t,e);if(void 0!==a)return a}return t},kt.prototype._filterDataByValueFilter=function(e){if(e&&"function"==typeof this.option.valueFilter)for(var t in e)e.hasOwnProperty(t)&&0!==t.indexOf("_")&&(e[t]=this._filterValueByValueFilter(e,e[t]))},kt.prototype.dataAdd=function(t,a){var n=this;if(t){n.state.data||(n.state.data=[]);var r=e.isArray(t)?t:[t];if(r.length){if(n._triggerGridEvent("dataAdd",{datalist:r})===!1)return!1;delete n.state.cellSelection,n._rowSelectAllUncheck();var o=(n.state.data.length,!e.isEmptyObject(n.option.defaultState.dataAdd)&&n.option.defaultState.dataAdd),l=n.option.defaultState.dataAdd,d=!!n.state.hasRowAllowEdit,s=n.state.hasMappingAllowEdit&&n.state.hasMappingAllowEdit.length,p=a&&a._state,u=a&&a._index,c=!!(n.option.tree&&n.option.tree.useTree&&n.state.treeInfo),g=n.option.tree&&n.option.tree.useTree&&a&&a.parentQuery,f=null,h=null,m=null,v="number"===n.option.tree.depthValueType?0:"";g&&(f=n._dataGet(a.parentQuery)[0],f&&(h=f[n.option.tree.idKey])),c&&(m=n.state.treeOption.expandedValue[n.state.treeOption.initialExpandedValue?0:1]);for(var x=Ce(n),y=(r.length+1,0),C=r.length;y<C;y++){var I=r[y],_=I._state;if(I._state={edited:!1,editing:!1,selected:!1,added:!0,deleted:!1},o&&("boolean"==typeof l.edited?I._state.edited=l.edited:0,"boolean"==typeof l.editing?I._state.editing=l.editing:0,"boolean"==typeof l.selected?I._state.selected=l.selected:0,"boolean"==typeof l.added?I._state.added=l.added:0,"boolean"==typeof l.deleted?I._state.deleted=l.deleted:0),n.option.extendStateOnAdd&&_&&("boolean"==typeof _.edited?I._state.edited=_.edited:0,"boolean"==typeof _.editing?I._state.editing=_.editing:0,"boolean"==typeof _.selected?I._state.selected=_.selected:0,"boolean"==typeof _.added?I._state.added=_.added:0,"boolean"==typeof _.deleted?I._state.deleted=_.deleted:0),p&&a._state.added===!1&&(I._state.added=!1),I._index=I._index||{},n._giveDataId(I),d&&n.option.rowOption.allowEdit.call(n,I)===!1&&(I._state.editing=!1),I._state.editing===!0){if(I._state.editing=n.state.getEditingAllState(I),s){for(var w=0;w<s;w++)n._isCellEditable(I,n.state.hasMappingAllowEdit[w])===!1&&delete I._state.editing[n.state.hasMappingAllowEdit[w].columnIndex];e.isEmptyObject(I._state.editing)&&(I._state.editing=!1)}I._state.editing&&n.option.parseValueOnStartEdit&&n._startupUpdateEditingData(I)}if(c){if(null!=f?I[n.option.tree.parentIdKey]=h:null==I[n.option.tree.parentIdKey]&&(I[n.option.tree.parentIdKey]=n.option.tree.rootNodeParentIdValue),n.option.tree.depthKey){var b=n.state.treeInfo.depthByIdValueMap[I[n.option.tree.parentIdKey]];I[n.option.tree.depthKey]=n.state.treeOption.depthStartValue+(null!=b?b+1:0)+v}n.option.tree.leafKey&&(I[n.option.tree.leafKey]=n.state.treeOption.leafValue[0]),n.option.tree.expandedKey&&void 0==I[n.option.tree.expandedKey]&&(I[n.option.tree.expandedKey]=m),(null==I[n.option.tree.idKey]||n.state.treeInfo.idValueToDataIdMap[I[n.option.tree.idKey]])&&(I[n.option.tree.idKey]=n._getUniqueIdValueForTreeNode(I))}x(kt,n,I)}var M=n.state.data.length;if(u)if(null!=a._index.data)M=parseInt(a._index.data);else if(null!=a._index.row){var S=n.state.renderTargetDataList[a._index.row];S&&null!=S._index.data&&(M=S._index.data)}M=Math.max(0,Math.min(n.state.data.length,M)),(null==M||isNaN(M))&&(M=n.state.data.length),M===n.state.data.length?Array.prototype.push.apply(n.state.data,r):(r.unshift(M,0),n.state.data.splice.apply(n.state.data,r),r.shift(),r.shift()),n.state.dynamicBinding?null:n.sortClear(),n.state.scrollyEnd=!1,n.state.renderingSuppressed?(n._sortInternalData(),n._generateRenderTargetData()):(i(),n.calcAndRedraw()),setTimeout(function(){n._triggerGridEvent("dataAddEnd",{datalist:r}),n._triggerGridEvent("dataChanged",{type:"add",datalist:r})},0)}}},kt.prototype._scrollerReset=function(){var e=this;e.state.renderFromRenderedIndex=0,e.state.renderFromColumnIndex=0,e.state.translateY=0,e.state.translateX=0,e.state.scrollxEnd=!1,e.state.scrollyEnd=!1,e.state.refreshbodycell&&(e.state.refreshbodycell.scrollEndYOffset=0,e.state.refreshbodycell.scrollEndXOffset=0),e.state.scrollbarLastRow=0,e.state.scrollbarLastColumn=0},kt.prototype._giveDataId=function(e){e._index.id=o(),e._index.grid=this.key,this.state.dataMapById[e._index.id]=e},kt.prototype._clearData=function(){var e=this;Ve(e),e.clearFilter(!0),e._rowSelectAllUncheck(),e.option.disableSortClearOnReset||e.sortClear({noEventTriggering:!0}),delete e.state.cellSelection,delete e.state.rowHeightMapByDataId,delete e.state.pinnedDataIdList,delete e.state.pinnedDataIdMap,delete e.state.treeHeaderExpandAllState,delete e.state.data,delete e.state.dataMapById,delete e.state.deletedData,delete e.state.headerGroupFoldingIconCollapsed,delete e.state.groupFooterDataMapById,delete e.state.groupHeaderDataMapById,e.state.lastInvalidEditingCell=[],e.state.searchStatus=null,e.state.rowHeightMapByDataId={},e.state.data=[],e.state.dataMapById={},e.state.deletedData=[],e._clearCellCache(),e.option.paging&&(e.option.paging.current=1,delete e.option.paging.customPaging),e.state.pagingInfo&&e.state.pagingInfo.customPaging&&delete e.state.pagingInfo.customPaging},kt.prototype.dataSet=function(t,a){if(t){var n=this;if(e.isArray(t)||(t=[t]),!t.length)return void n.dataEmpty();if(n._triggerGridEvent("dataSet",{datalist:t})===!1)return!1;if(n._clearData(),n.option.dataLengthLimit&&n.state.data.length+items.length>n.option.dataLengthLimit){var r=n.option.message.dataLengthLimit||"Exceed Limit.";return s(r)&&(r=r(n.state.data.length+items.length)),void(null!=r&&alert(r))}for(var o=!e.isEmptyObject(n.option.defaultState.dataSet)&&n.option.defaultState.dataSet,l=n.option.defaultState.dataSet,i=!!n.state.hasRowAllowEdit,p=n.state.hasMappingAllowEdit&&n.state.hasMappingAllowEdit.length,c=Ce(n),g=0,f=t.length;g<f;g++){var h=t[g],m=h._state;if(h._state={edited:!1,editing:!1,selected:!1,added:!1,deleted:!1},o&&("boolean"==typeof l.edited?h._state.edited=l.edited:0,"boolean"==typeof l.editing?h._state.editing=l.editing:0,"boolean"==typeof l.selected?h._state.selected=l.selected:0,"boolean"==typeof l.added?h._state.added=l.added:0,"boolean"==typeof l.deleted?h._state.deleted=l.deleted:0),n.option.extendStateOnSet&&m&&("boolean"==typeof m.edited?h._state.edited=m.edited:0,"boolean"==typeof m.editing?h._state.editing=m.editing:0,"boolean"==typeof m.selected?h._state.selected=m.selected:0,"boolean"==typeof m.added?h._state.added=m.added:0,"boolean"==typeof m.deleted?h._state.deleted=m.deleted:0),h._index=h._index||{},n._giveDataId(h),h._index.data=g,c(kt,n,h),i&&n.option.rowOption.allowEdit.call(n,h)===!1&&(h._state.editing=!1),h._state.editing===!0){if(h._state.editing=n.state.getEditingAllState(h),p){for(var v=0;v<p;v++)n._isCellEditable(h,n.state.hasMappingAllowEdit[v])===!1&&delete h._state.editing[n.state.hasMappingAllowEdit[v].columnIndex];e.isEmptyObject(h._state.editing)&&(h._state.editing=!1)}h._state.editing&&n.option.parseValueOnStartEdit&&n._startupUpdateEditingData(h)}n.state.data.push(h)}if(d(a)){var x=e.extend({},a);if(u(x.dataLength)&&u(x.current)){var y={};y.current=Number(x.current),y.dataLength=Number(x.dataLength),y.perPage=Number(x.perPage||n.state.data.length),y.total=Number(y.dataLength&&y.perPage?(y.dataLength/y.perPage|0)+(y.dataLength%y.perPage?1:0):x.total),n.option.paging.customPaging=y}var C=x.sorting||x.sortingKey||x.sortingColumn;null!=C&&n._setSortingInfo(C,x.sortingDirection),n.state.dynamicBinding=!0}else n.option.paging&&n.option.paging.customPaging&&delete n.option.paging.customPaging,n._processDefaultSorting(),n.state.dynamicBinding=!1;n._scrollerReset(),n.state.renderingSuppressed||a===!0?(n._sortInternalData(),n._generateRenderTargetData()):n.calcAndRedraw(),n._triggerGridEvent("dataSetEnd",{datalist:t}),n._triggerGridEvent("dataChanged",{type:"set",datalist:t})}},kt.prototype.clear=function(e){this.dataFlush(e),this.dataEmpty()},kt.prototype.dataEmpty=function(e){var t=this;return t._triggerGridEvent("dataEmpty")!==!1&&(t._clearData(),t._scrollerReset(),t.calcAndRedraw(),t._triggerGridEvent("dataEmptyEnd",{}),void t._triggerGridEvent("dataChanged",{type:"empty"}))},kt.prototype.cellEdit=function(e,t,a){for(var n=this,r=n._dataGet(t),o=n._columnIndexKeyToMappingList(a),l=d(e),i=o.length-1;i>=0;i--){var s=o[i];s.hasOwnProperty("columnIndex")&&(!l||e.hasOwnProperty(s.key))&&s.key&&null!=s.key||o.splice(i,1)}for(var p=[],u=!1,c=!1,g=!1,f=!1,h=!n.option.forceRefreshAllOnCellEdit,i=0,m=r.length;i<m;i++){for(var v=r[i],x=0,y=o.length;x<y;x++){var s=o[x],C=e;l&&e.hasOwnProperty(s.key)&&(C=e[s.key]);var I=v[s.key];if(n._cellEdit(v,s,C)===!1){u=!0;break}h&&I!==C&&(n._refreshCell(v,s),n._refreshByFromChangedCell(v,s,I,C),n.state.sortingInfoKeyMap[s.key]&&(c=!0),n.state.treeInfo&&s.key===n.option.tree.idKey&&(f=!0),null!=n.state.groupingKeyMap[s.key]&&(g=!0))}if(u)break;p.push(v._index.data)}p.length&&(n.option.sortClearOnEdit&&c&&n.sortClear(),n.option.forceRefreshAllOnCellEdit?n.calcAndRedraw():g||f?n.calcAndRedraw():!n.option.sortClearOnEdit&&c&&n.calcAndRedraw())},kt.prototype.rowEdit=function(t,a){var n=e.makeArray(arguments).slice(0,2);this.cellEdit.apply(this,n)},kt.prototype.dataEdit=function(e,t){var a=this;if(e){var n=a._dataGet(t);if(n&&n.length){if(a._triggerGridEvent("dataEdit",{data:e,datalist:n})===!1)return!1;a._dataEdit(n,e);var r=!1,o=!1,l=!1;if(a.option.sortClearOnEdit||a.state.groupingLookupTable||a.state.treeInfo)for(var i in e)e.hasOwnProperty(i)&&(a.option.sortClearOnEdit&&!l&&a.state.sortingInfoKeyMap[i]&&(a.sortClear(),l=!0),a.state.groupingKeyMap&&null!=a.state.groupingKeyMap[i]&&(r=!0),a.state.treeInfo&&a.option.tree.idKey===i&&(o=!0));if(r||o||a.option.forceRefreshAllOnDataEdit)a.calcAndRedraw();else for(var d=0,s=n.length;d<s;d++)a.refreshCell(n[d]);a._triggerGridEvent("dataEditEnd",{datalist:n}),a._triggerGridEvent("dataChanged",{type:"edit",datalist:n})}}},kt.prototype._isCellEditValid=function(t,a,n,r){var o=this,l=t[a.key];if(o._triggerGridEvent("cellEdit",{data:t,mapping:a,value:n,prevValue:l},r)===!1)return!1;if(a.hasOwnProperty("valid")){if(e.isArray(a.valid)&&e.inArray(n,a.valid)<0)return!1;if("function"==typeof a.valid){var i=a.valid.call(o,n,t,a,r[0]);if(i===!1)return!1}}return!0},kt.prototype._cellEdit=function(t,a,n){var r=this;if(!a.readonly||_e(r,t,a)!==!0){var o=r._getMultiParentMapping(a),l=r.cellElementGet(t,o.columnIndex),i=l.length?null:e(r._createCell(t,o)).appendTo(r.$wrapper),d=i?i:l,s=t[a.key],p=s!==n;if(r._isCellEditValid(t,a,n,d)===!1)return r.state.lastInvalidEditingCell=[t,a],r._triggerGridEvent("cellEditInvalid",{data:t,mapping:a,value:n},d),i?i.remove():null,!1;var u={};return u[a.key]=n,r._dataEdit(t,u),r._triggerGridEvent("cellEditEnd",{data:t,mapping:a,value:n,prevValue:s},d),p&&r._triggerGridEvent("cellValueChanged",{data:t,mapping:a,value:n,prevValue:s},d),i?i.remove():null,!0}},kt.prototype._dataEdit=function(t,a){for(var n=this,r=e.isArray(t)?t:[t],o=0,l=r.length;o<l;o++){var t=r[o];if(t._original||(t._original=kt.trimObject(t)),n.state.testRowAllowSelect&&t._state.selected&&n.option.rowOption.allowSelect(t)===!1&&(t._state.selected=!1),n.state.treeInfo&&a.hasOwnProperty(n.option.tree.idKey)&&a[n.option.tree.idKey]!==t[n.option.tree.idKey])for(var i=a[n.option.tree.idKey],d=n.state.treeInfo.childCountByIdValueMap[t[n.option.tree.idKey]],s=0,p=d?d.length:-1;s<p;s++){var u=n.state.treeInfo.idValueToDataIdMap[d[s]],c=n._dataGetByIndex({id:u});if(c){var g={};g[n.option.tree.parentIdKey]=i,n._dataEdit(c,g)}}for(var f in a)if(a.hasOwnProperty(f)){var h=a[f],m=t[f]!==h;if(m&&!n.option.fullCompareForEditedState&&(t._state.edited=!0),"function"==typeof n.option.valueFilter&&(h=n._filterValueByValueFilter(t,h)),"_"===f.charAt(0)&&h&&"object"==typeof h&&t[f]&&"object"==typeof t[f])for(var v in h)t[f][v]=h[v];else t[f]=h;if(t._state.editing){if(n.state.keyMappedToMultipleColumn){var x=n._columnIndexKeyToMappingList(f);if(x&&x.length)for(var y=0,C=x.length;y<C;y++)t._state.editing.hasOwnProperty(x[y].columnIndex)&&(t._state.editing[x[y].columnIndex]=h)}else{var I=n.state.columnKeyToIndexMap[f];null!=I&&t._state.editing.hasOwnProperty(I)&&(t._state.editing[I]=h)}if(n.state.multiColumnList.length)for(var _=0,w=n.state.multiColumnList.length;_<w;_++)n._iterateMultiMapping(t,n.state.multiColumnList[_],function(e,a){a.key===f&&t._state.editing.hasOwnProperty(a.columnIndex)&&(t._state.editing[a.columnIndex]=h)})}}if(n.option.fullCompareForEditedState){var b={},M=!1;for(var f in t._original)if(t._original.hasOwnProperty(f)&&!b[f]&&!M&&0!==f.indexOf("_")&&(b[f]=!0,t._original[f]!==t[f])){M=!0;break}for(var f in t)if(t.hasOwnProperty(f)&&!b[f]&&!M&&0!==f.indexOf("_")&&(b[f]=!0,t._original[f]!==t[f])){M=!0;break}t._state.edited=M}n.state.dataCompositor?n.state.dataCompositor(n,t):null,n.state.cellCacheEnabled&&n._clearCellCacheByDataId(t._index.id)}return r},kt.prototype.startCellEdit=function(e,t){for(var a=this,n=a._dataGet(e),r=a._columnIndexKeyToMappingList(t),o=!1,l=[],i=0,d=n.length;i<d;i++){var s=n[i];s._state.editing===!0&&(s._state.editing=a.state.getEditingAllState(s));for(var p=0,u={},c=0,g=r.length;c<g;c++){var f=a._getMultiParentMapping(r[c]);if(!u[f.id]){if(u[f.id]=!0,f.multi){var h=!1;if(a._iterateMultiMapping(s,f,function(e,t){if(t.editable)return h=!0,!1}),!h)continue}else if(!f.editable)continue;if(a._startCellEdit(s,f)===!1,a.state.groupRowspanned&&a.option.rowspanGroupEdit&&f.rowspan){var m=a._getGroupingRangeByMapping(s._index.data,f);if(m)for(var v=m.from;v<=m.to;v++)v!==s._index.data&&a._startCellEdit(a.state.data[v],f)}p++}}if(p&&l.push(s._index.data),o)break}l.length&&a._refreshBoard(!0)},kt.prototype.endCellEdit=function(e,t,a){for(var n=this,r=n._dataGet(e),o=n._columnIndexKeyToMappingList(t),l=!1,i=[],d=!1,s=!1,p=0,u=r.length;p<u;p++){var c=r[p];if(c._state.editing){for(var g=0,f={},h=0,m=o.length;h<m;h++){var v=n._getMultiParentMapping(o[h]);if(!f[v.id]){f[v.id]=!0;var x=!1;if(v.multi){if(n._iterateMultiMapping(c,v,function(e,t){if(t.editable)return c._state.editing.hasOwnProperty(t.columnIndex)?(x=!0,!1):void 0}),!x)continue}else{if(!v.editable)continue;if(!c._state.editing.hasOwnProperty(v.columnIndex))continue}var y=c[v.key];if(n._endCellEdit(c,v,a)===!1){l=!0;break}if(n.state.sortingInfoKeyMap[v.key]&&y!==c[v.key]&&(d=!0),n.state.groupRowspanned&&n.option.rowspanGroupEdit&&v.rowspan){var C=n._getGroupingRangeByMapping(c._index.data,v);if(C){y!==c[v.key]&&(s=!0);for(var I=C.from;I<=C.to;I++)I!==c._index.data&&n._endCellEdit(n.state.data[I],v,a)}}g++}}if(g&&i.push(c),l)break}}if(i.length){if(d&&!n.option.sortClearOnEdit||s)n.calcAndRedraw();else{for(var _=0,w=i.length;_<w;_++)n.refreshRow(i[_]);n._hasFooter()&&n._refreshFooterCells(!0)}n._triggerGridEvent("dataChanged",{type:"edit",datalist:i})}if(l===!0)return!1},kt.prototype.saveCellEdit=function(e,t){return this.endCellEdit(e,t,!0)},kt.prototype.cancelCellEdit=function(e,t,a){for(var n=this,r=n._dataGet(e),o=n._columnIndexKeyToMappingList(t),l=!1,i=[],d=0,s=r.length;d<s;d++){for(var p=r[d],u=0,c={},g=0,f=o.length;g<f;g++){var h=n._getMultiParentMapping(o[g]);if(!c[h.id]){if(c[h.id]=!0,n._cancelCellEdit(p,h,a)===!1){l=!0;break}if(n.state.groupRowspanned&&n.option.rowspanGroupEdit&&h.rowspan){var m=n._getGroupingRangeByMapping(p._index.data,h);if(m)for(var v=m.from;v<=m.to;v++)v!==p._index.data&&n._cancelCellEdit(n.state.data[v],h,a)}u++}}if(u&&i.push(p._index.data),l)break}i.length&&n._refreshBoard(!0)},kt.prototype._expandEditListByGroup=function(e){if(this.state.groupRowspanned&&this.option.rowspanGroupEdit&&e.length!==this.state.data.length){for(var t=this.option.grouping.by[0],a={},n=[],r=0,o=e.length;r<o;r++)a[e[r]._index.id]=!0,n.push(e[r]);for(var r=0,o=n.length;r<o;r++){var l=n[r],i=l._index.data,d=this._getGroupingRange(i,t);if(d)for(var s=d.from;s<=d.to;s++){var p=this.state.data[s];p&&!a[p._index.id]&&n.push(p)}}return n}return e},kt.prototype.startEdit=function(e){var t=this._dataGet(e);if(t&&t.length)return this.startCellEdit(this._expandEditListByGroup(t))},kt.prototype.endEdit=function(e){var t=this._dataGet(e);if(t&&t.length){var a=this.endCellEdit(this._expandEditListByGroup(t));return a!==!1&&void 0}},kt.prototype.saveEdit=function(e){var t=this._dataGet(e);if(t&&t.length)return this.saveCellEdit(this._expandEditListByGroup(t))},kt.prototype.cancelEdit=function(e){var t=this._dataGet(e);if(t&&t.length)return this.cancelCellEdit(this._expandEditListByGroup(t))},kt.prototype.startRowInlineEdit=function(e){var t=this;if(t.option.rowInlineEdit&&t.state.__rowInlineStartEdit){var a=t._dataGet(e)[0];a&&t.state.__rowInlineStartEdit(this,a)}},kt.prototype.endRowInlineEdit=function(){var e=this;e.option.rowInlineEdit&&e.state.__rowInlineEndEdit&&e.state.__rowInlineEndEdit(this)},kt.prototype.startCellInlineEdit=function(e,t){var a=this;if(a.option.cellInlineEdit&&a.state.__cellInlineStartEdit){var n=a._dataGet(e)[0],r=a._columnIndexKeyToMappingList(t)[0];n&&r&&a.state.__cellInlineStartEdit(n,a._getMultiParentMapping(r))}},kt.prototype.endCellInlineEdit=function(){var e=this;e.option.cellInlineEdit&&e.state.__cellInlineEndEdit&&e.state.__cellInlineEndEdit()},kt.prototype._isSpecialPurposeColumn=function(e){return!!(e.selectorColumn||e.numberingColumn||e.rowindexColumn||e.dragdropColumn)},kt.prototype._isCellEditable=function(e,t){var a=this;if(t.multi){var n=!1;if(a._iterateMultiMapping(e,t,function(t,r){var o=a._isCellEditable(e,r);if(o===!0)return n=!0,!1}),n===!0)return!0}if(!t.editable)return!1;if(!t.key)return!1;if(e&&e._state&&e._state.deleted)return!1;if(a._isSpecialPurposeColumn(t))return!1;if(t.hasOwnProperty("allowEdit")){var r=t.allowEdit;if("function"==typeof r&&(r=r.call(this,e[t.key],e,t)),r===!1)return!1}return(!a.option.rowOption||"function"!=typeof a.option.rowOption.allowEdit||a.option.rowOption.allowEdit.call(a,e)!==!1)&&(!t.readonly||_e(this,e,t)!==!0)},kt.prototype._startCellEdit=function(e,t){var a=this;if(!t||void 0!==t.columnIndex&&null!==t.columnIndex){var n=t.key,r=t.columnIndex;e._state.editing&&e._state.editing.hasOwnProperty(r)||a._isCellEditable(e,t)&&(e._state.editing=e._state.editing||{},t.editable&&n&&(e._state.editing[r]=e.hasOwnProperty(n)?e[n]:""),t.multi&&a._iterateMultiMapping(e,t,function(t,a){a.editable&&a.key&&(e._state.editing[a.columnIndex]=e.hasOwnProperty(a.key)?e[a.key]:"")}),a.option.parseValueOnStartEdit&&a._updateEditingCellWithoutElement(e,t),a.state.cellCacheEnabled&&a._clearCellCacheByDataId(e._index.id))}},kt.prototype._endCellEdit=function(t,a,n){var r=this;if(!a||void 0!==a.columnIndex&&null!==a.columnIndex){if(a.multi){var o=r._iterateMultiMapping(t,a,function(e,a){if(r._endCellEdit(t,a,n)===!1)return!1});if(o===!1)return!1}var l=a.columnIndex,i=t._state.editing&&t._state.editing.hasOwnProperty(l),d=!1;if(i){var s=t[a.key],p=t._state.editing[l];if(r._cellEdit(t,a,p)===!1)return!1;n!==!0&&delete t._state.editing[l],s!==p&&(d=!0)}n!==!0&&e.isEmptyObject(t._state.editing)&&(t._state.editing=!1),d&&r.option.sortClearOnEdit&&r.state.sortingInfoKeyMap[a.key]&&r.sortClear(),r.state.cellCacheEnabled&&r._clearCellCacheByDataId(t._index.id)}},kt.prototype._saveCellEdit=function(e,t){return this._endCellEdit(e,t,!0)},kt.prototype._cancelCellEdit=function(t,a,n){(!a||void 0!==a.columnIndex&&null!==a.columnIndex)&&(t._state.editing&&t._state.editing.hasOwnProperty(a.columnIndex)&&(n===!0?t._state.editing[a.columnIndex]=t[a.key]:delete t._state.editing[a.columnIndex]),t._state.editing&&!e.isEmptyObject(t._state.editing)||(t._state.editing=!1))},kt.prototype.dataGet=function(t){var a=this,n=a._dataGet.apply(a,arguments);return a.option.deepCopyOnDataGet&&e.isArray(n)&&(n=e.extend(!0,[],n)),n},kt.prototype.dataGetByIndex=function(t){var a=this,n=a._dataGetByIndex.apply(a,arguments);return a.option.deepCopyOnDataGet&&d(n)&&(reslut=e.extend(!0,{},n)),n},kt.prototype.dataGetRef=function(e){return this._dataGet.apply(this,arguments)},kt.prototype.dataGetByIndexRef=function(e){return this._dataGetByIndex.apply(this,arguments)},kt.prototype._dataGetByIndex=function(e){return e&&this.state.data?e.id?this.state.dataMapById[e.id]||null:null!=e.data?this.state.data[e.data]||null:null!=e.row?this.state.renderTargetDataList[e.row]||null:null:null},kt.prototype._dataGet=function(t){var a=this,n=[];if(0===arguments.length||1===arguments.length&&e.isEmptyObject(t)&&e.isPlainObject(t))return!a.option.enableDataGetAllByEmptyArray&&e.isArray(t)?n:n.concat(a.state.data);var r=e.makeArray(e.isArray(t)?t:arguments);e.isArray(t)&&arguments[1]===!0&&r.push(!0);var o=arguments[arguments.length-1]===!0;if(o)for(;e.inArray(!0,r)>-1;)r.splice(e.inArray(!0,r),1);if(!a.option.leaveDeleted&&r.length){for(var l=[],i=0,d=r.length;i<d;i++)r[i]&&r[i]._state&&r[i]._state.deleted&&l.push(r[i]);if(l.length)for(var s=a.state.deletedData||[],i=0,d=s.length;i<d;i++){for(var p=s[i],u=!1,c=0,g=l.length;c<g;c++)Ie(a,s,i,l[c])&&(u=!0);u&&n.push(p)}}if(!r.length)return n.concat(a.state.data);for(var f={},h=!1,i=r.length-1;i>=0;i--)if(r[i]&&r[i]._index&&(r[i]._index.hasOwnProperty("row")||r[i]._index.hasOwnProperty("data")||r[i]._index.id)){var m=a._dataGetByIndex(r[i]._index);m&&(n.unshift(m),f[m._index.id]=!0,h=!0,r.splice(i,1))}if(r.length)if(h){for(var i=0,d=a.state.data.length;i<d;i++)if(!f[a.state.data[i]._index.id])for(var c=0,g=r.length;c<g;c++)if(Ie(a,a.state.data,i,r[c],o)){n.push(a.state.data[i]);break}}else for(var i=0,d=a.state.data.length;i<d;i++)for(var c=0,g=r.length;c<g;c++)if(Ie(a,a.state.data,i,r[c],o)){n.push(a.state.data[i]);break}return n},kt.prototype._makeGroupSummaryAsData=function(t){var a=this;if(!t||!t._state.groupHeader&&!t._state.groupFooter)return t;for(var n=a.state.visibleColumnMappingList,r=0,o=n.length;r<o;r++){var l=n[r];if(l.key){var i=a._renderGroupSummaryValue(t,l);i&&i.nodeType&&(i=e(i).text()),t[l.key]=null==i?"":i}}return t},kt.prototype._targetDataGet=function(t){var a=this,n=e.isArray(t)?t:e.makeArray(arguments),r=[];if(!n.length||!t){r=[].concat(a.state.targetDataList);for(var o=0,l=r.length;o<l;o++)r[o]=a._makeGroupSummaryAsData(r[o]);return r}for(var o=n.length-1;o>=0;o--)if(n[o]&&n[o]._index&&(n[o]._index.hasOwnProperty("row")||n[o]._index.hasOwnProperty("data")||n[o]._index.id)){var i=a._dataGetByIndex(n[o]._index);i&&null!=i._index.row&&(r.unshift(a._makeGroupSummaryAsData(i)),getByIndexId[i._index.id]=!0,hasGetByIndexId=!0,n.splice(o,1))}for(var o=0,l=a.state.targetDataList.length;o<l;o++)for(var i=a.state.targetDataList[o],d=0,s=n.length;d<s;d++)Ie(a,a.state.targetDataList,o,n[d])&&r.push(a._makeGroupSummaryAsData(i));return r},kt.prototype.dataFlush=function(e,t){var a=this;this.option;"object"==typeof e&&(t=e),t=t||{};var n=[],r=!1;if(s(a.option.flushCallback)){n.push(a.option.flushCallback);var o=f(a.option.flushCallback);o&&3===o.length&&(r=!0)}if(s(e)){n.push(e);var o=f(e);o&&3===o.length&&(r=!0)}if(n.length){var l=this._dataGet({_state:{edited:!0,deleted:!1}},{_state:{added:!0,deleted:!1}}),i=this._dataGet({_state:{deleted:!0}});if(r)var d=a._dataGet({_state:{added:!0,deleted:!1}}),p=a._dataGet({_state:{added:!1,edited:!0,deleted:!1}});for(var u=0,c=n.length;u<c;u++){var o=f(n[u]);o&&3===o.length?n[u].call(a,d,p,i):n[u].call(a,l,i)}}if(t.noCommit!==!0){for(var u=0,c=a.state.data.length;u<c;u++){var g=a.state.data[u],h=!1;g._state&&(g._state.edited||g._state.added)&&!t.leaveEdited&&(g._state.added=!1,g._state.edited=!1,
h=!0),h&&(a.state.dataCompositor?a.state.dataCompositor(a,g):0,g._original=kt.trimData(g))}if(!t.leaveDeleted){if(a.option.leaveDeleted&&a.dataDelete({_state:{deleted:!0}},!0),this.state.deletedData.length)for(var u=0,c=a.state.deletedData.length;u<c;u++)delete a.state.dataMapById[a.state.deletedData[u]._index.id],a._clearCellCacheByDataId(a.state.deletedData[u]._index.id);this.state.deletedData=[]}t.leaveEdited||t.noredraw||a.calcAndRedraw()}},kt.prototype.dataRestore=function(t){var a=this,n=a._dataGet(t);if(n&&n.length){for(var r=ue(t),o=0,l=0;l<n.length;l++){var i=n[l],d=a.state.data[i._index.data];d._original&&e.extend(d,d._original),d._state.edited&&o++,d._state.edited=!1,r||a.refreshRow(i)}r&&o&&a.calcAndRedraw()}},kt.prototype.dataDelete=function(e,t,a){var n=this,r=n._dataGet(e);if(r&&r.length){if(n.option.tree&&n.option.tree.useTree&&(r=n._addTreeChildToList(r)),a!==!0&&n._triggerGridEvent("dataDelete",{datalist:r})===!1)return!1;n.state.deletedData=n.state.deletedData||[],r.sort(function(e,t){return e._index.data-t._index.data});for(var o=0,l=0,i=r.length;l<i;l++){var d=r[l];d._state.deleted=!0,t===!0?(delete n.state.dataMapById[d._index.id],delete n.state.rowHeightMapByDataId[d._index.id],n._clearCellCacheByDataId(d._index.id),n.state.data.splice(d._index.data-o++,1)):n.option.leaveDeleted?d._state.added&&(delete n.state.dataMapById[d._index.id],delete n.state.rowHeightMapByDataId[d._index.id],n.state.data.splice(d._index.data-o++,1),n._clearCellCacheByDataId(d._index.id)):(delete n.state.rowHeightMapByDataId[d._index.id],n.state.deletedData.push(d),n.state.data.splice(d._index.data-o++,1)),n.state.dataCompositor?n.state.dataCompositor(n,d):0}a!==!0&&(r&&r.length&&n.calcAndRedraw(),n._triggerGridEvent("dataDeleteEnd",{datalist:r}),n._triggerGridEvent("dataChanged",{type:"delete",datalist:r}))}},kt.prototype.dataUndelete=function(e){var t=this;if(t.state.deletedData=t.state.deletedData||[],t.option.leaveDeleted){var a=t._dataGet(e);if(!a||!a.length)return;if(!1===t._triggerGridEvent("dataUndelete",{datalist:a}))return!1;for(var n=0,r=a.length;n<r;n++)a[n]._state.deleted=!1,t.state.dataCompositor?t.state.dataCompositor(t,a[n]):0;a.length&&(t.calcAndRedraw(),t._triggerGridEvent("dataUndeleteEnd",{datalist:a}),t._triggerGridEvent("dataChanged",{type:"undelete",datalist:a}))}else{for(var o=0,l=[],i=[],d=[],n=0;n<t.state.deletedData.length;n++)e&&!Ie(t,t.state.deletedData,n,e)||(i.push(t.state.deletedData[n]),d.push(n));if(!1===t._triggerGridEvent("dataUndelete",{datalist:i}))return!1;for(var n=0,r=i.length;n<r;n++){var s=i[n];s._state.deleted=!1,l.push(s),t.state.data.splice(s._index.data,0,s),t.state.dataCompositor?t.state.dataCompositor(t,s):0,o++}for(var n=d.length-1;n>=0;n--)t.state.deletedData.splice(d[n],1);o&&(t.calcAndRedraw(),t._triggerGridEvent("dataUndeleteEnd",{datalist:l}),t._triggerGridEvent("dataChanged",{type:"undelete",datalist:l}))}},kt.prototype.dataCopy=function(t,a){var n=this;if(a||(a={}),t&&!e.isEmptyObject(t)){var r=n._dataGet(t);if(r&&r.length){var o=a.count||1,l=a.cloneColumn;void 0===l&&(l="all");var i=n.option.grouping&&n.option.grouping.by&&n.option.grouping.useGrouping&&!!a.cloneGroup,s=a._index||a.position,p={};if(a.recursive){for(var u=0,c=r.length;u<c;u++)p[r[u]._index.id]=!0;r=n._addTreeChildToList(r,!1,!1)}if(n._triggerGridEvent("dataCopy",{datalist:r,copyoption:a})===!1)return!1;var g=null,f=null;a.parentQuery?(g=n._dataGet(a.parentQuery)[0],g&&(f=g[n.option.tree.idKey])):null===a.parentQuery&&(g=!0,f=n.option.tree.rootNodeParentIdValue);var h=[],m={},v=!1;if(e.isArray(l)){v=!0;for(var u=0,c=l.length;u<c;u++)m[l[u]]=!0}else if(l===!0){v=!0;for(var u=0,c=n.option.columnMapping.length;u<c;u++){var x=n.option.columnMapping[u];x.key&&(m[x.key]=!0)}}for(var y={},C=0,I=o;C<I;C++)for(var u=0,c=r.length;u<c;u++){var _=r[u],w={_index:{},_state:{edited:!1,editing:!1,selected:!1,added:!0,deleted:!1}};if(i)for(var b=0,M=n.option.grouping.by.length;b<M;b++){var S=n.option.grouping.by[b];"string"==typeof S&&(w[S]=_[S])}else l&&e.each(_,function(e,t){0!==e.indexOf("_")&&("all"!==l&&v&&!m[e]||(w[e]=t))});if(n._giveDataId(w),n.state.treeInfo){var E=w[n.option.tree.idKey],T=n._getUniqueIdValueForTreeNode(w);y[E]=T,w[n.option.tree.idKey]=T,n.state.treeInfo.idValueToDataIdMap[w[n.option.tree.idKey]]=w._index.id,g&&p[_._index.id]&&(w[n.option.tree.parentIdKey]=f)}h.push(w)}if(h.length){if(!e.isEmptyObject(y))for(var D=!0;D;){D=!1;for(var u=0,c=h.length;u<c;u++){var w=h[u];y[w[n.option.tree.parentIdKey]]&&(w[n.option.tree.parentIdKey]=y[w[n.option.tree.parentIdKey]],D=!0)}}var R=null;if(void 0===s)R=r[r.length-1]._index.data+1;else if(d(s)){var F=n._dataGetByIndex(s);F&&(R=F._index.data)}else"end"===s?R=n.state.data.length:"number"==typeof s&&(R=n.state.renderTargetDataList[s-1]._index.data+1);null===R&&(R=n.state.data.length),h.unshift(R,0),Array.prototype.splice.apply(n.state.data,h),n.sortClear(),n.calcAndRedraw(),h.shift(),h.shift(),n._triggerGridEvent("dataCopyEnd",{datalist:h}),n._triggerGridEvent("dataChanged",{type:"copy",datalist:h})}}}},kt.prototype._hasPinnedData=function(t){var a=this;return"string"===e.type(t)?e.inArray(t,a.state.pinnedDataIdList)>=0:e.isArray(a.state.pinnedDataIdList)&&a.state.pinnedDataIdList.length},kt.prototype.rowFix=function(e,t){var a=this;a.option.rowFixCount=e,"number"==typeof t&&(a.option.rowFixShowFrom=Math.min(e,t)),a._refreshBoard(!0)},kt.prototype.rowUnfix=function(){var e=this;e.option.rowFixCount=0,e.option.rowFixShowFrom=null,e._refreshBoard(!0)},kt.prototype.columnFix=function(e,t){if(void 0!==e){var a=this._columnIndexKeyToMappingList(e);if(a&&a.length){var n={};n.columnFixUpto=a[0].columnIndex,null!=t&&(n.columnFixShowFrom=t),this.updateOption(n)}}},kt.prototype.columnUnfix=function(){this.updateOption({columnFixUpto:"unfix",columnFixShowFrom:null})},kt.prototype.addPin=function(t){var a=this;a.state.pinnedDataIdList=a.state.pinnedDataIdList||[],a.state.pinnedDataIdMap=a.state.pinnedDataIdMap||{};var n=!1;if(t&&!e.isEmptyObject(t)){var r=a._dataGet(t);if(r.length)for(var o=0,l=r.length;o<l;o++){var i=r[o];i&&i._index.id&&!a.state.pinnedDataIdMap[i._index.id]&&(a.state.pinnedDataIdList.push(i._index.id),a.state.pinnedDataIdMap[i._index.id]=!0,n=!0)}}n&&a.calcAndRedraw()},kt.prototype.dataPin=function(e){var t=this;return t.state.pinnedDataIdList=null,t.state.pinnedDataIdMap=null,t.addPin(e)},kt.prototype.dataUnpin=function(t){var a=this,n=!1;if(!t||e.isEmptyObject(t))a.state.pinnedDataIdList&&a.state.pinnedDataIdList.length&&(a.state.pinnedDataIdList=null,a.state.pinnedDataIdMap=null,n=!0);else{var r=a._dataGet(t);if(r&&r.length&&a.state.pinnedDataIdList&&a.state.pinnedDataIdList.length)for(var o=0,l=r.length;o<l;o++){var i=r[o];if(i&&a.state.pinnedDataIdMap[i._index.id]){var d=e.inArray(i._index.id,a.state.pinnedDataIdList);d>=0&&(a.state.pinnedDataIdList.splice(d,1),delete a.state.pinnedDataIdMap[i._index.id],n=!0)}}}n&&a.calcAndRedraw()},kt.prototype._rowUnfocusAll=function(){var t=this;t.state.focusedDataId&&e.each(t.state.focusedDataId,function(e,a){var n=t._dataGetByIndex({id:a});n&&(n._state.focused=!1,t.rowElementGet({_index:{id:a}},Ht.cache).removeClass("focused"))})},kt.prototype._rowFocus=function(e){var t=this;t.state.focusedDataId=t.state.focusedDataId||[];var a=null;if(e&&e.nodeType&&e.className.indexOf("bodycell")>=0?a=t._dataGetByIndex({id:e.getAttribute("data-alopexgrid-dataid")}):e&&e.index?a=t._dataGetByIndex(e.index):e&&(a=t._dataGet(e)[0]),a&&!a._state.focused){t._rowUnfocusAll(),t.state.focusedDataId=[];var n=[a];if(t.state.groupRowspanned&&(t.option.rowspanGroupFocus===!0||"number"==typeof t.option.rowspanGroupFocus||"string"==typeof t.option.rowspanGroupFocus)){var r=t.option.grouping.by[0];"number"==typeof t.option.rowspanGroupFocus?r=t.option.grouping.by[t.option.rowspanGroupFocus]:"string"==typeof t.option.rowspanGroupFocus?r=t.option.rowspanGroupFocus:t.option.rowspanGroupFocus===!0&&(r=t.state.topmostGroupRowspanKey);var o=t._getGroupingRange(a._index.data,r);if(o){var l=o.from,i=o.to;n=[];for(var d=l;d<=i;d++)n.push(t.state.data[d])}}for(var s=0,p=n.length;s<p;s++)n[s]._state.focused=!0,t.state.focusedDataId.push(n[s]._index.id),t.rowElementGet({_index:{id:n[s]._index.id}},Ht.cache).addClass("focused")}},kt.prototype._rowSelectAllUncheck=function(){var e=this;e.state.selectAll=!1;for(var t=e.$wrapper[0].querySelectorAll(".headercell.selector-column"),a=0,n=t.length;a<n;a++){var r=t[a],o=r.getElementsByTagName("input")[0];if(o&&kt.renderUtil.hasClass(o,"selector-column-input")){o.checked=!1;var l=o.parentElement;l&&"LABEL"===String(l.tagName).toUpperCase()&&kt.renderUtil.hasClass(l,"alopexgrid-input-checkbox-wrapper")&&kt.renderUtil.removeClass(l,"checked")}}},kt.prototype._rowSelectAllCheck=function(){var e=this;e.state.selectAll=!0;for(var t=e.$wrapper[0].querySelectorAll(".headercell.selector-column"),a=0,n=t.length;a<n;a++){var r=t[a],o=r.getElementsByTagName("input")[0];if(o&&kt.renderUtil.hasClass(o,"selector-column-input")){o.checked=!0;var l=o.parentElement;l&&"LABEL"===String(l.tagName).toUpperCase()&&kt.renderUtil.hasClass(l,"alopexgrid-input-checkbox-wrapper")&&kt.renderUtil.addClass(l,"checked")}}},kt.prototype._rowSelectAll=function(t,a){var n=this;if(n.state.data&&n.state.data.length&&n.state.renderTargetDataList&&n.state.renderTargetDataList.length&&!n.state.rowSingleSelect){if(t){if(t=e.event.fix(t),!e(a||t.currentTarget).hasClass("selector-column"))return;if("INPUT"!==t.target.tagName)return}var r=e(a||t.target),o=a||t.currentTarget?e(a||t.currentTarget):r.closest(".cell"),l=o.find("input"),i=l.prop("checked"),d=[];if(n._triggerGridEvent("dataSelect",{datalist:n.state.renderTargetDataList,select:i})===!1)return!1;for(var s=0,p=n.state.renderTargetDataList.length;s<p;s++){var u=n.state.renderTargetDataList[s];u._state.groupFooter||u._state.groupHeader||(n.state.testRowAllowSelect&&n.option.rowOption.allowSelect(u)===!1?u._state.selected=!1:u._state.selected=i,d.push(u))}n.state.selectAll=i,n.state.selectAll||(n.state.ctrlDataIndexMap={}),n.viewUpdate(!0),n._triggerGridEvent("dataSelectEnd",{datalist:n.state.renderTargetDataList}),n._triggerGridEvent("dataChanged",{type:"select",datalist:n.state.renderTargetDataList})}},kt.prototype.rowSelect=function(t,a){var n=this;n.option;if(!n._noData()&&(!t||!t.nodeType||e.isNumeric(t.getAttribute("data-alopexgrid-dataindex")))){var r=t.nodeType?[].concat(n.state.data[t.getAttribute("data-alopexgrid-dataindex")]||[]):n._dataGet(t);if(r&&r.length){var o=null,l={};if(1==!!n.option.disableRowSelectByKey&&(n.state.ctrlDataIndexMap={},l={}),!n.state.rowSingleSelect||0!=!!t.rowSingleCtrlKey&&1!=!!n.option.disableRowSelectByKey||(r=[r[0]],r[0]&&(o=r[0]._index.data)),t.rowSingleShiftKey&&n.state.lastSelectedDataId&&0==!!n.option.disableRowSelectByKey){r=[r[0]],r[0]&&(o=r[0]._index.data);var i=n._dataGet({_index:{id:n.state.lastSelectedDataId}})[0],d=i._index.data;r=d>o?n.state.data.slice(o,d+1):n.state.data.slice(d,o+1)}var s=[];if(n._triggerGridEvent("dataSelect",{datalist:r,select:a})===!1)return!1;for(var p=0,u=r.length;p<u;p++)if(r[p]){var c=r[p]._index.data,g=n.state.data[c];if(null!=c&&g&&(c=Number(c),!g._state.groupFooter&&!g._state.groupHeader)){var f=!!g._state.selected,h="toggle"==a?!g._state.selected:!!a;if(0!=!!n.option.disableRowSelectByKey||n.option.rowSingleSelectAllowUnselect&&n.state.rowSingleSelect&&0==!!t.rowSingleShiftKey&&0==!!t.rowSingleCtrlKey||(h=!!(!!t.rowSingleShiftKey==!0&&n.state.rowSingleSelect===!1||(1==!!t.rowSingleShiftKey||0==!!t.rowSingleCtrlKey)&&n.state.rowSingleSelect)||h),1!=!!t.rowSingleShiftKey&&0!=!!t.rowSingleCtrlKey||0!=!!n.option.disableRowSelectByKey||(l[c]=!0),f!==h&&s.push(c),n.state.testRowAllowSelect&&n.option.rowOption.allowSelect(g)===!1&&(h=!1),n.state.columnRowspanned&&n.option.rowspanGroupSelect)for(var m=ge(n.state.columnRowspanIndex,c),v=m.from,x=m.to,y=v;y<x;y++)n.state.data[y]._state.selected=h,h===!1&&(n.state.selectAll=!1),s.push(y);else if(n.state.groupRowspanned&&(n.option.rowspanGroupSelect||"number"==typeof n.option.rowspanGroupSelect)&&0==n.state.rowSingleSelect){var C="string"==typeof n.option.rowspanGroupSelect?n.option.rowspanGroupSelect:n.option.grouping.by[0];"number"==typeof n.option.rowspanGroupSelect?C=n.option.grouping.by[n.option.rowspanGroupSelect]:n.option.rowspanGroupSelect===!0&&(C=n.state.topmostGroupRowspanKey);var I=n._getGroupingRange(c,C);if(I)for(var v=I.from,x=I.to,y=v;y<=x;y++)n.state.data[y]._state.selected=h,h===!1&&(n.state.selectAll=!1),s.push(y)}else g._state.selected=h,h===!1&&(n.state.selectAll=!1),s.push(c);if(n.state.groupRowspanned){var C=n.state.topmostGroupRowspanKey,I=n._getGroupingRange(c,C);if(I)for(var v=I.from,x=I.to,y=v;y<=x;y++)s.push(y)}n.state.dataCompositor?n.state.dataCompositor(n,g):0}}if(n.state.selectAll?n._rowSelectAllCheck():n._rowSelectAllUncheck(),!n.state.rowSingleSelect&&1==!!t.rowSingleShiftKey)for(var _=n.state.ctrlDataIndexMap,p=0;p<n.state.data.length;p++){var w=n.state.data[p];0==!!_[p]&&0==!!l[p]&&0==!!n.option.disableRowSelectByKey&&(s.push(Number(p)),w._state.selected=!1,n.state.dataCompositor?n.state.dataCompositor(n,w):0)}if(n.state.rowSingleSelect&&(0==!!t.rowSingleCtrlKey||1==!!n.option.disableRowSelectByKey)){for(var p=0;p<n.state.data.length;p++){var w=n.state.data[p];!!w._state.selected==!1||p===o||0!=!!t.rowSingleShiftKey&&1!=!!n.option.disableRowSelectByKey?1==!!t.rowSingleShiftKey&&0==!!l[p]&&0==!!n.option.disableRowSelectByKey&&(s.push(Number(p)),w._state.selected=!1,n.state.dataCompositor?n.state.dataCompositor(n,w):0):(s.push(Number(p)),w._state.selected=!1,n.state.dataCompositor?n.state.dataCompositor(n,w):0)}if(n.state.groupRowspanned)if(It)n.$wrapper.find(".cell-rowspan-contain-selected").removeClass("selected cell-rowspan-contain-selected");else for(var b=n.$wrapper[0].getElementsByClassName("cell-rowspan-contain-selected");b.length;)kt.renderUtil.removeClass(b[0],"selected"),kt.renderUtil.removeClass(b[0],"cell-rowspan-contain-selected")}if(n.option.cellRefreshOnRowSelect)n._refreshBoard({dataIndexList:s});else{for(var M=[],S={},E={},T=[],D={},R={},F={},p=0,u=s.length;p<u;p++){var c=s[p],k=n.state.data[c];if(!F[k._index.id]){F[k._index.id]=!0;var L=n._dataGetByIndex({row:k._index.row-1}),A=n._dataGetByIndex({row:k._index.row+1});k._state.selected?(M.push(k),L&&(S[L._index.id]=L),A&&(E[A._index.id]=A)):(T.push(k),L&&(D[L._index.id]=L),A&&(R[A._index.id]=A))}}for(var O in D)for(var k=D[O],P=n.rowElementGet({_index:{id:O}},Ht.cache),y=0,B=P.length;y<B;y++)kt.renderUtil.removeClass(P[y],"nextrow-selected");for(var O in R)for(var k=R[O],P=n.rowElementGet({_index:{id:O}},Ht.cache),y=0,B=P.length;y<B;y++)kt.renderUtil.removeClass(P[y],"prevrow-selected");for(var O in S)for(var k=S[O],P=n.rowElementGet({_index:{id:O}},Ht.cache),y=0,B=P.length;y<B;y++)kt.renderUtil.addClass(P[y],"nextrow-selected");for(var O in E)for(var k=E[O],P=n.rowElementGet({_index:{id:O}},Ht.cache),y=0,B=P.length;y<B;y++)kt.renderUtil.addClass(P[y],"prevrow-selected");for(var p=0,u=T.length;p<u;p++){var k=T[p];delete n.state.ctrlDataIndexMap[k._index.data];for(var P=n.rowElementGet({_index:{id:k._index.id}},Ht.cache),y=0,B=P.length;y<B;y++)if(kt.renderUtil.removeClass(P[y],"selected"),n.state.groupRowspanned&&kt.renderUtil.removeClass(P[y],"cell-rowspan-contain-selected"),kt.renderUtil.hasClass(P[y],"selector-column")){var G=P[y].getElementsByTagName("input")[0];G&&(G.checked=!1,G.alopexgridChecked=!1,G.removeAttribute("checked"));var H=P[y].getElementsByTagName("label")[0];H&&kt.renderUtil.removeClass(H,"checked")}}for(var p=0,u=M.length;p<u;p++)for(var k=M[p],P=n.rowElementGet({_index:{id:k._index.id}},Ht.cache),y=0,B=P.length;y<B;y++)if(kt.renderUtil.addClass(P[y],"selected"),n.state.groupRowspanned&&kt.renderUtil.hasClass(P[y],"cell-rowspan-column")&&kt.renderUtil.addClass(P[y],"cell-rowspan-contain-selected"),kt.renderUtil.hasClass(P[y],"selector-column")){var G=P[y].getElementsByTagName("input")[0];G&&(G.checked=!0,G.alopexgridChecked=!0,G.setAttribute("checked","checked"));var H=P[y].getElementsByTagName("label")[0];H&&kt.renderUtil.addClass(H,"checked")}}var k=t.nodeType?[n.state.data[t.getAttribute("data-alopexgrid-dataindex")]][0]:n._dataGet(t)[0];if(t.rowSingleShiftKey===!1&&0==!!n.option.disableRowSelectByKey&&k&&(n.state.lastSelectedDataId=k._index.id),!n.state.rowSingleSelect&&t.rowSingleShiftKey===!1)for(var N=n.dataGet({_state:{selected:!0}}),p=0;p<N.length;p++){var w=N[p]._index.data;0==!!n.state.ctrlDataIndexMap[w]&&(n.state.ctrlDataIndexMap[Number(w)]=!0)}n.state.customCtrlKey=!1,n.state.customShiftKey=!1,n._triggerGridEvent("dataSelectEnd",{datalist:r}),n._triggerGridEvent("dataChanged",{type:"select",datalist:r})}}},kt.prototype._getRecentData=function(e){var t=this,a=null;if("string"==typeof e){for(var n=0,r=t.state.data.length;n<r;n++)if(t.state.data[n]._index&&t.state.data[n]._index.id===e){a=t.state.data[n];break}}else"number"==typeof e&&(a=t.state.data[e]);return a?kt.currentData(a):null},kt.prototype._cellIdFromData=function(e,t){return[this.key,"number"==typeof e?e:e._index.row,t].join("-")},kt.prototype._cellIdFromRowIndex=function(e,t){return[this.key,e,t].join("-")},kt.prototype._isEditingCell=function(e,t){var a=this,n="object"==typeof e&&e?e:a.state.renderTargetDataList[e],r=t&&"object"==typeof t?t:Q(this,t);if(r&&r.multi){var o=!1;if(a._iterateMultiMapping(n,r,function(e,t){if(we(n,t))return o=!0,!1}),o===!0)return!0}return we(n,r)},kt.prototype._isPopupEditingColumn=function(t){if(e.isArray(this.option.cellPopupEdit))for(var a=0,n=this.option.cellPopupEdit.length;a<n;a++){var r=this.option.cellPopupEdit[a];if("number"==typeof r&&t.columnIndex===r)return!0;if("string"==typeof r&&(t.key===r||t.id===r))return!0}return!1};var $t=["cell-selected","cell-selected-topline","cell-selected-bottomline","cell-selected-leftline","cell-selected-rightline","cell-selected-focus"].join(" ");kt.prototype._getRowspanInfoForCell=function(e,t){var a=this,n=Q(a,t);if(!n)return null;if(a.option.grouping&&a.option.grouping.useGroupRowspan!==!0)return null;var r=null;n.rowspan===!0?r=n.key:n.rowspan&&"string"==typeof n.rowspan.by&&(r=n.rowspan.by);var o=a.state.groupingLookupTable;if(null===o||void 0===o)return null;var l=o[r];if(null===l||void 0===l||0===l.length)return null;var i=a.state.renderTargetDataList[e];if(a.option.grouping.groupRowspanMode){for(var d=i,s=i,p=a.option.grouping.groupRowspanMode;d;){var u=a.state.renderTargetDataList[d._index.row-1];if(!u||!a._allowGroupMerge(u,d,n,p))break;d=u}for(;s;){var c=a.state.renderTargetDataList[s._index.row+1];if(!c||!a._allowGroupMerge(s,c,n,p))break;s=c}return{from:d._index.row,to:s._index.row}}var g=l[i._index.data];if(!g)return null;for(var f=g.from,h=g.to,m=void 0,v=void 0,x=f;x<=h;x++){var y=a.state.data[x],C=y?y._index.row:null;null!=C&&(m=void 0===m?C:Math.min(C,m),v=void 0===v?C:Math.max(C,v))}return void 0!==m&&void 0!==v?{from:m,to:v}:null},kt.prototype._getColspanInfoForCell=function(e,t){var a=this,n=a.state.renderTargetDataList[e];if(n)for(var r=t;r>=0;r--){var o=Q(a,r);if(o&&xe(o)){var l=a._getColspanUpto(n,o);if(l>r&&t<=l)return{from:r,to:l}}}return null},kt.prototype._getColspanUpto=function(e,t){var a=this,n="number"==typeof t?a.state.columnIndexToMapping[t]:t;if(n.colspan){var r=We(a,e,n);if(r){var o=a.state.visibleIndexMapByColumnIndex[n.columnIndex],l=Math.min(a.state.visibleColumnCount-1,o+r-1);return a.state.visibleColumnMappingList[l]?a.state.visibleColumnMappingList[l].columnIndex:null}}else if(n.colspanTo){if("string"==typeof n.colspanTo){var o=a.state.visibleIndexMapByColumnIndex[n.columnIndex],l=a.state.visibleIndexMapByKey[n.colspanTo];return a.state.visibleColumnMappingList[l]?a.state.visibleColumnMappingList[l].columnIndex:null}if(!e)return null;var i=s(n.colspanTo)?n.colspanTo(e[n.key],e,n,a._getGroupingRangeByData(e,n)):n.colspanTo,d=i;if("string"==typeof d){var l=a.state.visibleIndexMapByKey[d];if(!a.state.visibleColumnMappingList[l])return null;d=a.state.visibleColumnMappingList[l].columnIndex}return Math.min(a.state.maxColumnIndex,d)}return null};var Wt="__AlopexGridCopiedMarkup"+o()+"__",Kt="__AlopexGridCopiedMarkupText"+o()+"__",Ut=window.top;try{Ut[Wt]=null,Ut[Kt]=null}catch(e){Ut=window}kt.prototype._startCellSelectEngine=function(t){function a(t){var a="",n=e(t).find("tr"),r=[];return n.each(function(t,n){var o=[],l=e(n).find("td");l.each(function(t,a){if(o.push(e(a).text()),a.colSpan&&parseInt(a.colSpan,10)>1)for(var n=1;n<parseInt(a.colSpan,10);n++)o.push("")});for(var i=0,d=r.length;i<d;i++)r[i]>0&&(o.splice(i,0,""),r[i]--);var s=[];l.each(function(e,t){if(t.rowSpan&&parseInt(t.rowSpan,10)>1){for(var a=0,n=0,o=0,l=r.length;o<l;o++)if(r[o]>0)a++;else if(n++,n>e)break;s[e+a]=parseInt(t.rowSpan,10)-1}});for(var p=0,u=s.length;p<u;p++)s[p]&&(r[p]=s[p]);a+=o.join("\t"),a+="\r\n"}),a}function n(t){var a="\n";return t.indexOf("\r\n")>=0&&(a="\r\n"),t.slice(-a.length)===a&&(t=t.slice(0,-a.length)),"<table><tbody>"+e.map(t.split(a),function(e){var t=e.split("\t");return"<tr><td>"+t.join("</td><td>")+"</td></tr>"}).join("")+"</tbody></table>"}function r(e){for(var t=e.split("\n"),a=0,n=t.length-2;a<n;a++)if(null!=t[a]&&null!=t[a+1]&&t[a].split("\t").length!==t[a+1].split("\t").length)return!1;return!0}var o=this,l=".alopexgridCellSelectEngine",d=".alopexgridCellSelectEngineMouseenter";if(o.$root.off(l),o.$wrapper.off(l),o.$wrapper.off(d),o.$focusfixture.off(l),xt.off(l+o.key),xt.off(d+o.key),t){var s=null;this.$focusfixture.on("keydown"+l,{self:this,keytimer:{id:null}},function(e){var t=e.data.self;if(!s){var a=t.$focusfixture[0],n=e.shiftKey,r=(e.altKey,e.metaKey),o=e.ctrlKey,l=e.keyCode,d=String.fromCharCode(96<=e.keyCode&&e.keyCode<=105?e.keyCode-48:e.keyCode),p=a.renderedIndex,u=a.columnIndex;if(null!=p&&!isNaN(p)&&null!=u&&!isNaN(u)){var c=t.state.renderTargetDataList[p],g=t.state.columnIndexToMapping[u],f=t._isEditingCell(p,u),h=!(!t.option.cellSelectableOption||!t.option.cellSelectableOption.ignoreVerticalScrollMoveTempo),m=null,v=!1;if(13===l)qe(t,n?-1:1,0);else if(9===l)qe(t,0,n?-1:1),e.preventDefault();else if(113===l||32===l)if(!f&&t._isCellEditable(c,g)){var x=t._getRowspanInfoForCell(p,u);x&&(p=x.from);var y=null;t.option.cellInlineEdit?y=t.state.__cellInlineEndEdit():t.option.rowInlineEdit&&(y=t.state.__rowInlineEndEdit(t));var C=t.option.cellInlineEditOption.allowStartEditWithInvalid;if(y!==!1||C===!0){t.option.cellInlineEdit?t.state.__cellInlineStartEdit(c,g):t.option.rowInlineEdit&&t.state.__rowInlineStartEdit(t,c);var I=Ye(t,p,u).find("input,select,textarea").eq(0);if(I.focus(),"text"===I.prop("type")){var _=I.val();I.val("").val(_)}32===l&&"text"===I.prop("type")&&e.preventDefault()}}else{var w=Ye(t,p,u),I=w.find("input,select,textarea"),b=(I.prop("type"),t._extractRenderObject(c,g)),M=b?b.type:null;if(w.hasClass("selector-column")){var S=c._state.selected;if(t.rowSelect({_index:{row:p}},"toggle"),t.state.hasSelectorColumn&&c._state.selected!==S){var E={data:c,mapping:g,value:c._state.selected,prevValue:S};t._triggerGridEvent("cellValueEditing",E,w),t._triggerGridEvent("cellValueChanged",E,w)}}else if(32===l&&t.option.renderMapping[M]&&"function"==typeof t.option.renderMapping[M].toggle){var T=t.option.renderMapping[M].toggle;T.call(t,w[0],c,b,g,t),t._updateEditingCell(w)}else I.eq(0).focus()}else if(39===l)if(n)Ze(t,!1,!0,!1,!1);else{m="right";for(var D=ot(t,u,1),c=t._getRenderedDataFromRenderedIndex(p),R=u;R>=0;R--){var g=Q(t,R);if(g&&xe(g)){var F=t._getColspanUpto(c,g);if(F>R&&u<=F){D=ot(t,F,1);break}}}null==D&&(D=u),je(t,p,D,m),Je(t,"cellSelectionStart")}else if(37===l)if(n)Ze(t,!0,!1,!1,!1);else{m="left";for(var D=rt(t,u,1),c=t._getRenderedDataFromRenderedIndex(p),R=u;R>=0;R--){var g=Q(t,R);if(g&&xe(g)){var F=t._getColspanUpto(c,g);if(u<=F){D=rt(t,g.columnIndex,1);break}}}null==D&&(D=u),je(t,p,D,m),Je(t,"cellSelectionStart")}else if(38===l||33===l){var x=t._getRowspanInfoForCell(p,u);x&&(p=x.from);var k=33===l?t._getProcessedPageUpLength(h):1;if(n)Ze(t,!1,!1,k,!1);else{m="up";var L=Math.max(p-k,0);t.option.cellSelectableOption&&t.option.cellSelectableOption.useMinPageUpDownScroll||33!==l||(t.state.scrollyEnd,t._scrollUpEvent(k)),je(t,L,u,m),Je(t,"cellSelectionStart")}e.preventDefault()}else if(40===l||34===l){var x=t._getRowspanInfoForCell(p,u);x&&(p=x.to);var k=1;if(34===l&&(k=t._getProcessedPageDownLength(h),t.state.refreshbodycell&&t.state.refreshbodycell.renderedPinnedDataList))for(var A=0,O=t.state.refreshbodycell.renderedPinnedDataList.length;A<O;A++){var P=t.state.refreshbodycell.renderedPinnedDataList[A];if(P&&P._index.row===p){k+=O-A;break}}if(n)Ze(t,!1,!1,!1,k);else{m="down";var L=p+k;t.option.cellSelectableOption&&t.option.cellSelectableOption.useMinPageUpDownScroll||34!==l||t._scrollDownEvent(k),je(t,L,u,m),Je(t,"cellSelectionStart")}e.preventDefault()}else if((o||r)&&"V"===d.toUpperCase())return void(e.data.keytimer.id&&clearTimeout(e.data.keytimer.id));if(Je(t),t.state.cellSelection){33!==l&&34!==l&&38!==l&&40!==l||e.preventDefault();var B=t.state.cellSelection.focusRenderedIndex,G=t.state.cellSelection.focusColumnIndex,w=Ye(t,B,G);e.data.keytimer.id&&clearTimeout(e.data.keytimer.id),e.data.keytimer.id=setTimeout(function(){var e=v?"":kt.trimString(a.innerText||a.textContent);a.innerHTML="";var n=Q(t,G);if(e&&n&&n.editable&&t.option.cellInlineEdit){if(!t._isEditingCell(B,G)){var r=t.state.__cellInlineEndEdit(),o=t.option.cellInlineEditOption.allowStartEditWithInvalid;r===!1&&o!==!0||t.state.__cellInlineStartEdit(c,n)}if(w=t.cellElementGet({_index:{row:B}},G),i(),w&&w.length){var l=w.find("input,textarea");if(l.length){var d=l.prop("type");if("radio"===d)l.filter(":checked").focus();else if("checkbox"===d)l.focus();else{l[0].focus(),l.val("");var p=e.charCodeAt(0);p<256&&l.val(e)}t._updateEditingCell(w)}else w.find("select").focus();s=null}}else setTimeout(function(){s=null},1)},50)}}}}),this.$focusfixture.on("copy"+l,{self:this},function(t){var n=t.data.self,r=et(n);u(r)||(r=""),r=String(r);var o="",l=!1,i=!(!n.option.cellSelectableOption||!n.option.cellSelectableOption.copyTextformOnly);if(r.indexOf("<table")>=0?(l=!0,o=a(r)):o=r,Ut[Wt]=r,Ut[Kt]=o,(t.originalEvent||t).clipboardData){t.preventDefault();var d=(t.originalEvent||t).clipboardData;"string"==typeof r&&(l&&!i&&d.setData("text/html",r),d.setData("text/plain",o))}else window.clipboardData&&window.clipboardData.setData&&(l?(window.clipboardData.setData("Text",o),i||(n.$focusfixture.empty().append(e(r)),q(n.$focusfixture.get(0),!0),setTimeout(function(){Xe(n)},0))):window.clipboardData.setData("Text",o))}),this.$focusfixture.on("paste"+l,{self:this},function(e){var t=e.data.self,a="",o=!(!t.option.cellSelectableOption||!t.option.cellSelectableOption.copyTextformOnly);if((e.originalEvent||e).clipboardData){if(a=(e.originalEvent||e).clipboardData.getData("text/html"),!nt(t,a)){if(a=(e.originalEvent||e).clipboardData.getData("text/plain"),a&&a.length||(a=""),o&&a===Ut[Kt]&&nt(t,n(a)))return t.$focusfixture.empty(),void e.preventDefault();if(t.option.cellSelectableOption&&t.option.cellSelectableOption.detectTSV&&r(a)&&nt(t,n(a)))return t.$focusfixture.empty(),void e.preventDefault();var l=t.state.cellSelection.focusRenderedIndex,i=t.state.cellSelection.focusColumnIndex;return at(t,l,i,a)!==!1&&t.cellEdit(a,{_index:{row:l}},i),void e.preventDefault()}t.$focusfixture.empty(),e.preventDefault()}else setTimeout(function(){a=t.$focusfixture.html();var e=t.$focusfixture.text();if(t.$focusfixture.empty(),!nt(t,a)){if(e&&e.length||(e=""),o&&(window.clipboardData&&window.clipboardData.getData&&(e=window.clipboardData.getData("Text")||e),e===Ut[Kt]?a=n(e):a===Ut[Kt]&&(a=n(a)),nt(t,a)))return;if(t.option.cellSelectableOption&&t.option.cellSelectableOption.detectTSV){var l=window.clipboardData.getData("Text")||e;if(r(l)&&nt(t,n(l)))return}var i=t.state.cellSelection.focusRenderedIndex,d=t.state.cellSelection.focusColumnIndex;return void(at(t,i,d,e)!==!1&&t.cellEdit(e,{_index:{row:i}},d))}},5)});var p={id:null};this.$root.on("mousedown"+l,".bodycell",{self:this},function(t){function a(e,t,a){return parseInt(Math.max(Math.min(500,Math.abs(e-t)/(5*(a||1))),1))}var n=t.data.self,r=e(this);if(!kt.renderUtil.isGridPointerActionProhibited(t.target)){if(kt.renderUtil.hasClass(this,"emptycell")){var o=!!n.state.cellSelection;return Ee(n),void(o&&Fe(n))}var l=parseInt(r.attr("data-alopexgrid-rowindex")),s=parseInt(r.attr("data-alopexgrid-columnindex"));if(/(INPUT)|(SELECT)|(TEXTAREA)/.test(t.target.tagName))return void(n.option.disableCellFocusAtInput||je(n,l,s,null,!0));if(!r.hasClass("cell-unselectable")){H(function(){setTimeout(function(){N(),xt.trigger("__alopexgridcellselectdragend")},0)}),n.state.customShiftKey=t.shiftKey,je(n,l,s);var u=n.$wrapper.width(),c=n.$wrapper.height(),g=n.$wrapper.offset(),f={x:t.pageX,y:t.pageY,moved:!1};p.id&&(clearInterval(p.id),p.id=null),Je(n,"cellSelectionStart"),Je(n),n.$wrapper.off(d),xt.off(d+n.key),xt.on("mouseup"+d+n.key+n.eventns+" touchend"+d+n.key+n.eventns+" __alopexgridcellselectdragend"+d+n.key+n.eventns,{self:n,timer:p,pointer:f},function(e){var t=e.data.self;e.data.timer.id&&(clearInterval(e.data.timer.id),e.data.timer.id=null),e.data.self.$wrapper.off(d),xt.off(d+e.data.self.key),Je(t,"cellSelectionEnd");var a=e.target.tagName;setTimeout(function(){if("INPUT"!==a&&"SELECT"!==a&&"TEXTAREA"!==a){var e=document.activeElement?document.activeElement.tagName:null;"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e&&Xe(t,null,null)}},0)}),xt.on("mousemove"+d+n.key+n.eventns,{self:n,height:c,width:u,offset:g,timer:p,pointer:f},function(e){var t=e.data.self,n=e.data.width,r=e.data.height,o=e.data.offset,i=o.left,d=o.top,p=e.pageX,u=e.pageY,c=null,g=e.data.timer,f=25,h=t.state.headerHeight||0,m=t.option.rowFixCount;t.state.fixedColumnMapping;p===e.data.pointer.x&&u===e.data.pointer.y||(e.data.pointer.moved=!0);var v=0,x=t.state.fixedColumnWidth||0;if(m)for(var y=0;y<m;y++){var C=t.state.renderTargetDataList[y];C&&(v+=t.state.rowHeightMapByDataId[C._index.id]||t.state.rowHeight)}else{var I=t.state.pinnedDataIdList;if(I&&I.length)for(var y=0,_=I.length;y<_;y++){var w=I[y],b=t.state.dataIdToIndexMap[w];if(b>=0){var C=t.state.data[b];v+=t.state.rowHeightMapByDataId[w]||t.state.rowHeight}}}var M=d+h,S=M+v,E=i+x,T=80,D=Oe(t),R=Ae(t),F=(Ge(t,l),He(t,s),Pe(t),Be(t),B(t),G(t),!1),k=!1;g.id&&(clearInterval(g.id),g.id=null),D&&u<S&&(F=!0),R&&p<E&&(k=!0),t.state.hasVerticalScrollbar||(F=!0),t.state.hasHorizontalScrollbar||(k=!0),p<o.left+x+f&&!k?(c=function(){var e=a(p,o.left+x+f,8);t._scrollLeftEvent(1*e)},T=160):p>o.left+n-f&&!k?(c=function(){var e=a(p,o.left+n-f,8);t._scrollRightEvent(1*e)},T=160):u<o.top+f+h+v&&!F?c=function(){var e=a(u,o.top+f+h+v,1.5);t._scrollUpEvent(1*e)}:u>o.top+r-f&&!F&&(c=function(){var e=a(u,o.top+r-f,1.5);t._scrollDownEvent(1*e)}),c||(c=function(){g.id&&(clearInterval(g.id),g.id=null)}),e.preventDefault(),c(),g.id=setInterval(c,T)}),n.$wrapper.on("mouseenter"+d,".bodycell",{self:n,pointer:f},function(t){if(!kt.renderUtil.hasClass(this,"emptycell")&&t.data.pointer.moved){var a=t.data.self,n=a.state.cellSelection.focusColumnIndex,r=a.state.cellSelection.focusRenderedIndex,o=e(this),l=parseInt(o.attr("data-alopexgrid-rowindex")),d=parseInt(o.attr("data-alopexgrid-columnindex")),s=(a._getRowspanInfoForCell(l,d),Oe(a)),p=Ae(a),u=Ge(a,l),c=He(a,d),g=Pe(a),f=Be(a),h=B(a),m=G(a),v=!1;i(),!s||u||f||(l=a.option.rowFixCount,a._scrollTopEvent(!0),v=!0),!p||c||g||(a._scrollLeftEvent(void 0,!0),d=a.state.visibleColumnMappingList[a.state.visibleIndexMapByColumnIndex[a.state.fixupto]+1].columnIndex||a.state.maxColumnIndex,v=!0),s||!u||f||h||(l=a.state.refreshbodycell.renderedDataList[a.option.rowFixCount]._index.row),p||!c||g||m||(d=a.state.refreshbodycell.renderedColumnMappingList[a.state.refreshbodycell.renderedFixedColumnMappingList.length].columnIndex),v&&a._refreshBoard(),Ne(a,r,n,l,d)}})}}})}else Ee(this)},kt.prototype._enableHeaderSelect=function(t){function a(e,t){return{from:Math.min(e.from,t.from,e.to,t.to),to:Math.max(e.from,t.from,e.to,t.to)
}}function n(e){var t=e.getAttribute("data-alopexgrid-columnindex"),a=e.getAttribute("data-alopexgrid-tocolumnindex")||t;return{from:parseInt(t,10),to:parseInt(a,10)}}var r=this,o=".alopexgridHeaderSelectEngine",l=o+r.key+r.key,d=o+r.key;r.$wrapper.off(o).off(d),xt.off(d).off(l);var s={self:r,info:null,offset:0,width:0};t===!0&&(r.state.headerSelection=r.state.headerSelection||{timer:{id:null}},s.info=r.state.headerSelection,r.$wrapper.on("mousedown"+o,".headercell",s,function(e){var t=e.data.self;t.$wrapper.off(d),xt.off(d),1===e.which&&(kt.renderUtil.isGridPointerActionProhibited(e.target)||(lt(t),e.data.startRange=n(this),e.data.info.from=e.data.startRange.from,t.$wrapper.on("mouseenter"+d,".headercell",s,function(e){var t=e.data.self;e.data.endRange=n(this);var r=a(e.data.startRange,e.data.endRange),o=e.data.info.from=r.from,l=e.data.info.to=r.to;t.$wrapper.find(".headercell").removeClass("header-selected").filter(function(){if(kt.renderUtil.hasClass(this,"filtercell"))return!1;var e=this.getAttribute("data-alopexgrid-columnindex"),t=this.getAttribute("data-alopexgrid-tocolumnindex")||e;return e&&o<=e&&t<=l}).addClass("header-selected"),i(),e.data.preventSelectStartSet||(xt.on("selectstart"+d+t.eventns,function(e){e.preventDefault()}),e.data.preventSelectStartSet=!0)}),e.data.offset=t.$wrapper.offset(),e.data.width=t.$wrapper.outerWidth(),xt.on("keydown"+d+t.eventns,s,function(e){var t=e.data.self,a=e.keyCode;switch(a){case 27:t.$wrapper.off(d),xt.off(d);var n=t.state.headerSelection.timer;n.id&&(clearInterval(n.id),n.id=null),lt(e.data.self)}}),xt.on("mousemove"+d+t.eventns,s,function(e){var t=e.data.self,a=e.data.offset,n=e.data.width,r=t.state.headerSelection.timer;e.preventDefault(),r.id&&(clearInterval(r.id),r.id=null),e.pageX-a.left<50?r.id=setInterval(function(){t._scrollLeftEvent(1)},80):a.left+n-e.pageX<50&&(r.id=setInterval(function(){t._scrollRightEvent(1)},80))}),xt.on("mouseup"+d+t.eventns,s,function(e){var t=e.data.self;t.$wrapper.off(d),xt.off(d);var a=t.state.headerSelection.timer;a.id&&(clearInterval(a.id),a.id=null);var n=Math.min(t.state.headerSelection.from,t.state.headerSelection.to),r=Math.max(t.state.headerSelection.from,t.state.headerSelection.to);return isNaN(n)||isNaN(r)||n===r?void lt(e.data.self):(t.state.headerSelection.from=n,void(t.state.headerSelection.to=r))})))}),xt.on("mousedown"+l+r.eventns,s,function(t){var a=e(t.target);a.closest("."+pt.split(" ").join(".")).attr("data-alopexgrid")!==t.data.self.key?lt(t.data.self):(a.closest(".bodycell").length||a.closest(".columnhiddenarea").length)&&lt(t.data.self)}))},kt.prototype.sortingInfo=function(){var e=this,t=[];if(t.sorted=e.state.sortingInfo&&e.state.sortingInfo.length,t.sorted){var a=e.state.columnMappingMapById[e.state.sortingInfo[0].mappingId];t.sortingKey=a.key,t.sortingColumn=a.columnIndex,t.sortingDirection=e.state.sortingInfo[0].sortingDirection;for(var n=0,r=e.state.sortingInfo.length;n<r;n++){var o={},a=e.state.columnMappingMapById[e.state.sortingInfo[n].mappingId];o.sortingKey=a.key,o.sortingColumn=a.columnIndex,o.sortingDirection=e.state.sortingInfo[n].sortingDirection,o.mapping=a,o.order=e.state.sortingInfo[n].sortedOrder,t.push(o)}}return t},kt.prototype._usePager=function(){var e=this.option.pager;return"function"==typeof e&&(e=e.call(this,this.pageInfo())),e===!0},kt.prototype.pageInfo=function(){return this.state.pagingInfo},kt.prototype.pageSet=function(e){var t=this,a=t.pageInfo(),n=a.current;return"first"===e?e=1:"prev"===e?e=Math.max(n-1,1):"next"===e?e=Math.min(n+1,a.total):"last"===e&&(e=a.total),e=Math.min(Math.max(1,Number(e)),a.total),e||(e=1),t._triggerGridEvent("pageSet",{page:e,pageinfo:a})!==!1&&(t.option.paging.current=e,t._rowSelectAllUncheck(),t._scrollerReset(),Ee(t),t.calcAndRedraw(),void t._triggerGridEvent("pageSetEnd",{page:e,pageinfo:t.pageInfo()}))},kt.prototype._setProgressPosition=function(){var e=this;if(e.state.$progress&&e.option.absoluteProgressPosition){var t=e.option.absoluteProgressPosition,a={},n=e.$root.outerWidth()/2,r=e.$root.outerHeight()/2,o=e.state.$progress.filter(".progress"),l=o.outerWidth()/2,i=o.outerHeight()/2;if("centerOnly"===t);else if(s(t)){var d=t.call(o,e.$root,o);d&&null!=d.left&&(n=d.left),d&&null!=d.top&&(r=d.top)}else n-=l,r-=i;a.left=n+"px",a.top=r+"px",o.css(a)}},kt.prototype._displayProgress=function(t){var a=this;if(t===!0){var n=null==a.option.progressText?kt.i18n("progress")||a.option.defaultProgressText:a.option.progressText;if(s(n)&&(n=n.call(a)),a.state.$progress)return void("string"!=typeof n&&"number"!=typeof n||a.state.$progress.filter(".progress").html(n));var r=e("<div></div>").addClass("progress alopexgrid-progress").addClass(a.option.progressStyleclass||"").css(a.option.progressCss||{}),o=e("<div></div>").addClass("modal alopexgrid-progress-modal").css(a.option.modalCss||{});"string"!=typeof n&&"number"!=typeof n||r.html(n),a.$root.append(o,r),a.state.$progress=o.add(r),a._setProgressPosition()}else t===!1&&a.state.$progress&&(a.state.$progress.remove(),a.state.$progress=null)},kt.prototype._refreshProgressOptionFromArguments=function(t){var a=this,n=e.makeArray(t),r=e.grep(n,function(e){return d(e)})[0];r&&(r.hasOwnProperty("progressText")&&(a.option.progressText=r.progressText),r.hasOwnProperty("progressStyleclass")&&(a.option.progressStyleclass=r.progressStyleclass))},kt.prototype.refreshProgress=function(){var e=this;e._refreshProgressOptionFromArguments(arguments),e.state.$progress&&e._displayProgress(!0)},kt.prototype.showProgress=function(e){var t=this;t._displayProgress(!0),t.state.progressStackCount=t.state.progressStackCount||0,t.state.progressStackCount+=1,t._refreshProgressOptionFromArguments(arguments),s(e)&&setTimeout(function(){e.call(t),t.hideProgress()},t.option.progressDelay||10)},kt.prototype.hideProgress=function(e){var t=this;t.state.progressStackCount=t.state.progressStackCount||0,t.state.progressStackCount-=1,t._refreshProgressOptionFromArguments(arguments),(e===!0||t.state.progressStackCount<=0)&&(t._displayProgress(!1),t.state.progressStackCount=0)},kt.prototype._showProgress=function(e,t,a){var n=this,r=null;"function"==typeof e&&(r=a?function(){e.call(n,function(){n.hideProgress()})}:function(){e.call(n),n.hideProgress()}),t?n.showProgress(r):(n.showProgress(),r?r():n.hideProgress())},kt.prototype.enlargeStart=function(){var t=this;if(t.state.isZoomed)return void alert(kt.i18n("enlargeMsg"));var a,n=e(document.body),r=vt.scrollTop(),o=t.$root.parent(),l=o.children().index(t.$root);e("#blocker_"+t.key).length>0?(a=e("#blocker_"+t.key),a.show()):(a=e('<div id="blocker_'+t.key+'" class="'+pt+' alopexgrid-enlarge-blocker"></div>'),a.addClass("alopexgrid-refer-"+t.key),n.append(a));var i,d;if(e("#content_"+t.key).length>0)i=e("#content_"+t.key),d=i.find(".alopexgrid-enlarge-closebutton"),i.show();else{i=e('<div id="content_'+t.key+'" class="'+pt+' alopexgrid-enlarge-content"></div>'),i.addClass("alopexgrid-refer-"+t.key),d=e('<a id="closebutton_'+t.key+'" class="'+pt+' alopexgrid-enlarge-closebutton"></a>'),d.html(t.option.enlargeOption.closeButtonMarkup);var s=".alopexgridEnlargeCloseButton";d.off(s).on("click"+s+" touchstart"+s,function(){t.enlargeExit()}),i.append(d),n.append(i)}var p=t.option.height;i.append(t.$root),n.css("overflow","hidden"),vt.scrollTop(0),t.suppressRender(!0),t.updateOption({height:vt.height()-t.$root.offset().top}),t.suppressRender(!1),t.redraw(),t.state.isZoomed=!0,t.state.beforeZoomHeight=p,t.state.beforeZoomScrollTop=r,t.state.beforeZoomParent=o,t.state.beforeZoomSiblingIndex=l},kt.prototype.enlargeExit=function(){var t=this;if(t.state.isZoomed){var a=e(document.body),n=t.state.beforeZoomParent,r=e("#blocker_"+t.key),o=e("#content_"+t.key);o.find(".alopexgrid-enlarge-closebutton");a.css("overflow",""),r.hide(),o.hide();var l=n.children(),i=l.eq(t.state.beforeZoomSiblingIndex),d=l.eq(Math.max(0,t.state.beforeZoomSiblingIndex-1));i.length?i.before(t.$root):d.length?d.after(t.$root):l.length?n.append(t.$root):n.append(t.$root),t.suppressRender(!0),t.updateOption({height:t.state.beforeZoomHeight}),t.suppressRender(!1),t.redraw(),t.state._vspLastLeft=-1,vt.scrollTop(t.state.beforeZoomScrollTop),t.state.isZoomed=!1,delete t.state.beforeZoomHeight,delete t.state.beforeZoomScrollTop,delete t.state.beforeZoomParent,delete t.state.beforeZoomSiblingIndex}},kt.prototype.suppressRender=function(t){var a=this;"boolean"===e.type(t)?a.state.renderingSuppressed=t:s(t)&&(a.state.renderingSuppressed=!0,t(),a.state.renderingSuppressed=!1)},kt.prototype._isInstanceValid=function(){return!!(this&&this.key&&this.option&&this.state)},e.fn.__alopexgrid=function(){return it(this)};var Yt=function(){var t=e(this);return t.attr("data-alopexgrid")||(t=t.find("."+pt.split(" ").join("."))),t.each(function(){var t=it(this);if(t){var a=t.key;t.removeFilterDropdown(),t._viewEventRemove(),t._clearData(),vt.off(t.eventns),xt.off(t.eventns),e(document.body).off(t.eventns),e(".alopexgrid-refer-"+a).remove();for(var n in t.state)t.state.hasOwnProperty(n)&&delete t.state[n];for(var n in t.option)t.option.hasOwnProperty(n)&&delete t.option[n];for(var n in t)t.hasOwnProperty(n)&&delete t[n];e(this).removeData(kt.KEY_NAME).empty().removeAttr("data-alopexgrid").css("height","").css("width",""),delete kt.instances[a]}}),this},Vt=/<(?:script|style|link)/i,Xt=function(a){if(!this.length)return this;if("string"==typeof a){if(!w(t))return;if(!kt.prototype[a])throw new Error("[AlopexGrid] AlopexGrid has no method ["+a+"]");var n=void 0,r=void 0,o=e.makeArray(arguments).slice(1);return r=this.each(function(e,t){if(!Vt.test(this.tagName)){var r=it(this);return r||(r=new kt(this)),n=r[a].apply(r,o),void 0===n&&void 0}}),void 0!==n?n:r}return this.each(function(e,t){var n=it(this);n?n.updateOption(a):n=new kt(this,a)})};if(e.fn[gt]){var zt=e.fn[gt];e.fn[gt]=function(){this.each(function(){var t=it(this);return t&&t.version===st?Yt.apply(e(this),arguments):zt.apply(e(this),arguments)})}}else e.fn[gt]=Yt;if(e.fn[ct]){var jt=e.fn[ct];e.fn[ct]=function(){var e=it(this);return!e&&d(arguments[0])?arguments[0].version===st?Xt.apply(this,arguments):jt.apply(this,arguments):e&&e.version===st?Xt.apply(this,arguments):jt.apply(this,arguments)}}else e.fn[ct]=Xt;if(e[ct]){var qt=e[ct];e[ct]=function(){return window[ut].version===st?kt.setup.apply(this,arguments):qt.apply(this,arguments)}}else e[ct]=kt.setup;e.alopex&&(e.alopex[ct]=kt.setup,s(e.alopex.registerSetup)&&e.alopex.registerSetup(ht,kt.setup)),window[ut]=kt}(jQuery);
//# sourceMappingURL=alopex-grid.min.js.map
